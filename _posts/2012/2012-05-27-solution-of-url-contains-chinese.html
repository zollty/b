---
layout: ue
title: URL传递中文解决方案
category: Web服务器端开发技术
tags: URL编码
keywords: "URL编码,URL传递中文"
---

<p><br/></p><p>首先，弄清楚为什么url传递中文会转码或者乱码，以及http头</p><p>contentType=&quot;text/html; charset=GBK&quot;</p><p>的作用。</p><p><strong>html代码会经过web服务器，浏览器处理</strong>，所以<strong>造成转码或者乱码的原因</strong>，可能涉及到：<strong>页面本身的设置、web服务器的设置、浏览器的设置</strong>。</p><p>&nbsp;</p><p>在动态页面，比如<strong>jsp、php</strong>中，可以设置</p><p><strong>contentType=&quot;text/html; charset=GBK&quot;</strong></p><p>在服务器，比如apache中可以在<strong>web.xml</strong>中设置</p><p>&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;connectionTimeout=&quot;20000&quot;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;redirectPort=&quot;8443&quot; <strong>URIEncoding=&quot;utf-8&quot;</strong>/&gt;</p><p>在Spring、Struts等插件中还可以<strong>配置页面过滤器</strong>。</p><p>在IE等<strong>浏览器中可以设置</strong><span style="color: rgb(192, 0, 0); "><strong>强制</strong></span><strong>的url编码规则</strong>。</p><p>&nbsp;</p><p>但是按照网络标准RFC-1738规定，<strong>一般的浏览器都是以utf-8或者gbk等方式来编码url的</strong>。</p><p>&nbsp;</p><p>解决乱码要从根源入手，根源是什么？刚才我说了，处理html的顺序是：页面本身的设置、web服务器的设置、浏览器的设置。那么<strong>最有效的方式就是照顾到浏览器</strong>。</p><p>&nbsp;</p><p><strong>在web.xml或者Spring、Struts等中我们都不用管，因为他们是间接的方式，不一定其作用</strong>。</p><p>&nbsp;</p><p>怎么照顾到浏览器？就是<strong>将url的编码规则自己指定。接收的时候自己解码</strong>。</p><p>&nbsp;</p><p>制定url编码规则很简单，就是<strong>将url先用utf-8编码</strong>，编码结果是英文、数字、百分号等符合网络标准RFC-1738的格式。</p><p>&nbsp;</p><p>编码的方法可以在服务器端的程序中进行，但那样效率太低。<strong>Javascript</strong>已经做好了这方面的工作，只需要<strong>调用encodeURI()或者encodeURIComponent()函数</strong>即可。</p><p>&nbsp;</p><p>要在<strong>href、src等处调用javascript的函数</strong>，方法如下：</p><p>一、在HTML里可以通过&quot;javascript:&quot;方式调用JavaScript的函数或方法，如下所示：</p><p>&lt;html&gt;</p><p>&nbsp;&lt;head&gt;</p><p>&nbsp; &lt;title&gt;使用“javascript:”&lt;/title&gt;</p><p>&nbsp;&lt;/head&gt;</p><p>&nbsp;&lt;body&gt;</p><p>&nbsp; &lt;a href=&quot;javascript:alert(&#39;您点击了这个超链接&#39;)&quot;&gt;请点我&lt;/a&gt; &nbsp;</p><p>&nbsp;&lt;/body&gt;</p><p>&lt;/html&gt;</p><p>二、 &nbsp;&quot;javascript:&quot;不但可以调用JavaScript的方法，也可以调用用户自定义的函数，如下代码所示：</p><p>&lt;html&gt;</p><p>&nbsp;&lt;head&gt;</p><p>&nbsp; &lt;title&gt;使用“javascript:”&lt;/title&gt;</p><p>&nbsp; &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</p><p>&nbsp; &nbsp;&lt;!--</p><p>&nbsp; &nbsp; function OnclickLink()</p><p>&nbsp; &nbsp; {</p><p>&nbsp; &nbsp; &nbsp;alert(&quot;您点击了这个按钮&quot;);</p><p>&nbsp; &nbsp; }</p><p>&nbsp; &nbsp;--&gt;</p><p>&nbsp; &lt;/script&gt;</p><p>&nbsp;&lt;/head&gt;</p><p>&nbsp;&lt;body&gt;</p><p>&nbsp; &lt;a href=&quot;javascript:OnclickLink()&quot;&gt;请点我&lt;/a&gt;</p><p>&nbsp;&lt;/body&gt;</p><p>&lt;/html&gt;</p><p><br/></p><p>三、与事件结合</p><p style="line-height: normal; ">&lt;html&gt;</p><p style="line-height: normal; ">&nbsp;&lt;head&gt;</p><p style="line-height: normal; ">&nbsp; &lt;title&gt;与事件相结合&lt;/title&gt;</p><p style="line-height: normal; ">&nbsp; &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;</p><p style="line-height: normal; ">&nbsp; &nbsp;&lt;!--</p><p style="line-height: normal; ">&nbsp; &nbsp; function OnMouseOverLink()</p><p style="line-height: normal; ">&nbsp; &nbsp; {</p><p style="line-height: normal; ">&nbsp; &nbsp; &nbsp;alert(&quot;您的鼠标从第一个超链接上划过&quot;);</p><p style="line-height: normal; ">&nbsp; &nbsp; }</p><p style="line-height: normal; ">&nbsp; &nbsp;--&gt;</p><p style="line-height: normal; ">&nbsp; &lt;/script&gt;</p><p style="line-height: normal; ">&nbsp;&lt;/head&gt;</p><p style="line-height: normal; ">&nbsp;&lt;body&gt;</p><p style="line-height: normal; ">&nbsp; &lt;a href=&quot;#&quot; onmouseover=&quot;OnMouseOverLink()&quot;&gt;请将鼠标放在上面&lt;/a&gt;&lt;br&gt;</p><p style="line-height: normal; ">&nbsp; &lt;a href=&quot;#&quot; onclick=&quot;javascript:alert(&#39;您点击了第二个超链接&#39;)&quot;&gt;请点我&lt;/a&gt; &nbsp;</p><p style="line-height: normal; ">&nbsp;&lt;/body&gt;</p><p style="line-height: normal; ">&lt;/html&gt;</p><p>&nbsp;</p><p><strong>传递中文URL的解决方案如下</strong>：</p><p>&lt;a href=&quot;javascript:location=encodeURI(&#39;/zollty/search.jsp?form_project=金海湾&#39;);&quot;&gt;金海湾&lt;/a&gt;</p><p>点击超链接时实际上要激发javascript函数才其作用，我们不能写成如下形式：</p><p>&lt;a href=&#39;encodeURI(&quot;/zollty/search.jsp?form_project=金海湾&quot;)&#39;&gt;金海湾&lt;/a&gt;</p><p>因为上面的写法在未点击超链接时，href的值就是包含javascript代码的原原本本的字符串，点击后才执行encodeURI()函数，而超链接会以url为“encodeURI(&quot;/zollty/search.jsp?form_project=金海湾”来跳转，显然是找不到这个页面的。</p><p>&nbsp;</p><p>最好是写成如下形式：</p><p>&lt;a href=&quot;javascript:void(0)&quot; onclick=&quot;location.href=encodeURI(&#39;/zollty/search.jsp?form_project=金海湾&#39;);&quot;&gt;金海湾&lt;/a&gt;</p><p>其含义更加明了。</p><p>&nbsp;</p><p>另外就是<strong>表单中提交中文的问题，通过设置页面的</strong></p><p><strong>contentType=&quot;text/html; charset=GBK&quot;</strong></p><p><strong>就可以解决。</strong></p><p><br/></p>