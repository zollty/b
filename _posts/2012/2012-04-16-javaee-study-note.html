---
layout: ue
title: JavaEE学习手册
category: JavaEE服务器端开发
tags: Java
keywords: "JavaEE"
---

<p style="text-align:center;line-height:150%"><span style="font-size:16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family: 宋体">学习手册</span></p><p style="text-align:center;line-height:150%"><span style="font-size:16px;line-height:150%;font-family:宋体">作者：</span><span style="font-size:16px;line-height:150%">zollty</span></p><p><span style="font-size:16px">&nbsp;</span></p><p style="line-height:150%"><span style="font-size:16px;line-height:150%;font-family:宋体">一、几个术语</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">ASF</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%">Apache Software Foundation</span><span style="font-size:16px;line-height: 150%;font-family:宋体">，即</span><span style="font-size:16px;line-height:150%">Apache</span><span style="font-size:16px;line-height:150%;font-family:宋体">自由软件基金会。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">Jakarta</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%">ASF</span><span style="font-size:16px;line-height:150%;font-family:宋体">这个组织包含了很多软件项目，</span><span style="font-size:16px;line-height:150%">Jakarta</span><span style="font-size:16px;line-height:150%;font-family: 宋体">是</span><span style="font-size:16px;line-height:150%">ASF</span><span style="font-size:16px;line-height:150%;font-family:宋体">旗下的一套</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">解决方案的开源项目的名称，它包括了很多子项目，比如</span><span style="font-size:16px;line-height:150%">Tomcat</span><span style="font-size:16px;line-height:150%;font-family: 宋体">、</span><span style="font-size:16px;line-height:150%">Ant</span><span style="font-size:16px;line-height:150%;font-family:宋体">、</span><span style="font-size:16px;line-height:150%">Struts</span><span style="font-size:16px;line-height:150%;font-family: 宋体">等。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">JVM</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">即</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">虚拟机，包括一套字节码指令集、一组寄存器、一个栈、一个垃圾回收堆和一个存储方法域。它屏蔽了与具体操作系统平台相关的信息，使</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">程序只需生成在</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">虚拟机上运行的目标代码（字节码），就可以在多种平台上不加修改地运行。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">JSP</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">即</span><span style="font-size:16px;line-height:150%">Java Server Page</span><span style="font-size:16px;line-height:150%;font-family:宋体">，是同</span><span style="font-size:16px;line-height:150%">HTML</span><span style="font-size: 16px;line-height:150%;font-family:宋体">结合在一起的动态网页。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">Servlet</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">是</span><span style="font-size:16px;line-height:150%">Java Servlet</span><span style="font-size:16px;line-height:150%;font-family:宋体">的简称，由</span><span style="font-size:16px;line-height:150%">Serve+Applet</span><span style="font-size:16px;line-height:150%;font-family:宋体">演变而来，字面意思即“服务端小程序”，和</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">属于同一个层面。它是服务器端的</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">应用程序，由</span><span style="font-size:16px;line-height:150%">Web</span><span style="font-size:16px;line-height:150%;font-family:宋体">服务器进行加载。</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">的主要功能在于交互式地浏览和修改数据，生成动态</span><span style="font-size:16px;line-height:150%">Web</span><span style="font-size:16px;line-height:150%;font-family:宋体">内容。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">CGI</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">即</span><span style="font-size:16px;line-height:150%">Common Gateway Interface</span><span style="font-size:16px;line-height: 150%;font-family:宋体">（通用网关接口），它是一段程序，运行在服务器上，提供同客户端</span><span style="font-size:16px;line-height:150%">HTML</span><span style="font-size:16px;line-height:150%;font-family:宋体">页面的接口，通俗的讲</span><span style="font-size:16px;line-height:150%">CGI</span><span style="font-size:16px;line-height:150%;font-family:宋体">就像是一座桥，把网页和</span><span style="font-size:16px;line-height:150%">WEB</span><span style="font-size:16px;line-height:150%;font-family:宋体">服务器中的执行程序连接起来，它把</span><span style="font-size:16px;line-height:150%">HTML</span><span style="font-size:16px;line-height:150%;font-family:宋体">接收的指令传递给服务器，再把服务器执行的结果返还给</span><span style="font-size:16px;line-height:150%">HTML</span><span style="font-size:16px;line-height:150%;font-family:宋体">页；用</span><span style="font-size:16px;line-height:150%">CGI</span><span style="font-size:16px;line-height:150%;font-family:宋体">可以实现处理表格，数据库查询，发送电子邮件等许多操作，最常见的</span><span style="font-size:16px;line-height:150%">CGI</span><span style="font-size:16px;line-height:150%;font-family:宋体">程序就是计数器。</span><span style="font-size:16px;line-height:150%">CGI</span><span style="font-size:16px;line-height:150%;font-family:宋体">使网页变得不是静态的，而是交互式的。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">PS</span><span style="font-size:16px;line-height:150%;font-family:宋体">：</span><strong><span style="font-size:16px;line-height:150%">Java Servlet</span></strong><strong><span style="font-size:16px;line-height: 150%;font-family:宋体">和</span></strong><strong><span style="font-size:16px;line-height:150%">CGI</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">的比较</span></strong></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;line-height:150%;font-family:宋体">服务器上需要一些程序，常常是根据用户输入访问数据库的程序。这些通常是使用公共网关接口（</span><span style="font-size:16px;line-height:150%">CGI(Common Gateway Interface)</span><span style="font-size:16px;line-height:150%;font-family:宋体">）应用程序完成的。然而，在服务器上运行</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">，这种程序可使用</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">编程语言实现。在通信量大的服务器上，</span><span style="font-size:16px;line-height:150%">Java Servlet</span><span style="font-size:16px;line-height:150%;font-family:宋体">的优点在于它们的执行速度更快于</span><span style="font-size: 16px;line-height:150%">CGI</span><span style="font-size:16px;line-height:150%;font-family:宋体">程序。各个用户请求被激活成单个程序中的一个线程，而无需创建单独的进程，这意味着服务器端处理请求的系统开销将明显降低。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">PS</span><span style="font-size:16px;line-height:150%;font-family:宋体">：</span><strong><span style="font-size:16px;line-height:150%">Java Servlet</span></strong><strong><span style="font-size:16px;line-height: 150%;font-family:宋体">和</span></strong><strong><span style="font-size:16px;line-height:150%">JSP</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">的比较</span></strong></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;&nbsp;&nbsp; Servlet</span><span style="font-size:16px;line-height:150%;font-family:宋体">和</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">在底层运行的原理上是完全一样的。运行时，</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">必须被</span><span style="font-size:16px;line-height:150%">Web</span><span style="font-size:16px;line-height:150%;font-family:宋体">服务器编译成</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">，真正提供</span><span style="font-size:16px;line-height:150%">HTTP</span><span style="font-size:16px;line-height:150%;font-family:宋体">服务的也是</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">，因此广义的</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">包含</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">和</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">。目前的</span><span style="font-size:16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family: 宋体">应用中已经很少单纯的使用</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">充当表示层，更多的是作为控制层组件来使用。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">Tomcat</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">是一个免费开源的</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">容器，是</span><span style="font-size:16px;line-height:150%">Jakarta</span><span style="font-size:16px;line-height:150%;font-family: 宋体">项目中的一个核心项目，最初是由</span><span style="font-size:16px;line-height:150%">Sun</span><span style="font-size:16px;line-height:150%;font-family:宋体">的软件构架师</span><span style="font-size:16px;line-height:150%">James Duncan Davidson</span><span style="font-size:16px;line-height:150%;font-family:宋体">开发的，后来他帮助将其变为开源项目，并由</span><span style="font-size:16px;line-height:150%">Sun</span><span style="font-size:16px;line-height:150%;font-family:宋体">贡献给</span><span style="font-size:16px;line-height:150%">Apache</span><span style="font-size:16px;line-height:150%;font-family: 宋体">软件基金会。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">MVC</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">即</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架（</span><span style="font-size:16px;line-height:150%">Model-View-Controller Framework</span><span style="font-size:16px;line-height:150%;font-family:宋体">），它包括</span><span style="font-size:16px;line-height:150%">3</span><span style="font-size:16px;line-height:150%;font-family:宋体">类对象：</span><span style="font-size:16px;line-height:150%">Model</span><span style="font-size:16px;line-height:150%;font-family: 宋体">是应用对象，也就是功能逻辑，</span><span style="font-size:16px;line-height:150%">View</span><span style="font-size:16px;line-height:150%;font-family:宋体">是指在屏幕上的表示，也就是</span><span style="font-size:16px;line-height:150%">UI</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">User Interface</span><span style="font-size:16px;line-height:150%;font-family:宋体">用户界面）；</span><span style="font-size:16px;line-height:150%">Controller</span><span style="font-size:16px;line-height:150%;font-family:宋体">定义用户界面对于用于输入的响应方式，即对请求和应答事件进行处理。通常把</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">按软件层次分成</span><span style="font-size:16px;line-height:150%">3</span><span style="font-size:16px;line-height:150%;font-family:宋体">层：视图（</span><span style="font-size:16px;line-height:150%">View</span><span style="font-size:16px;line-height:150%;font-family:宋体">）层，模型（</span><span style="font-size:16px;line-height:150%">Model</span><span style="font-size:16px;line-height:150%;font-family: 宋体">）层，控制（</span><span style="font-size:16px;line-height:150%">Controller</span><span style="font-size:16px;line-height:150%;font-family: 宋体">）层。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">Struts</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%">Struts</span><span style="font-size:16px;line-height:150%;font-family: 宋体">也是</span><span style="font-size:16px;line-height:150%">Jakarta</span><span style="font-size:16px;line-height:150%;font-family: 宋体">的一个核心子项目，它提供了一种方法，可以在一个</span><span style="font-size:16px;line-height:150%">Web</span><span style="font-size:16px;line-height:150%;font-family:宋体">应用程序中一起使用</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">和</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">。其目的是要解决完全由</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">或</span><span style="font-size:16px;line-height:150%">Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">实现的传统应用程序中固有的问题，例如，用</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">很难将</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">代码同</span><span style="font-size:16px;line-height:150%">HTML</span><span style="font-size:16px;line-height:150%;font-family:宋体">分开，结果将导致代码易懂性不高，后期维护较难。</span><span style="font-size:16px;line-height:150%">Struts</span><span style="font-size:16px;line-height:150%;font-family: 宋体">其实也是一个</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架，但</span><span style="font-size:16px;line-height:150%">Struts</span><span style="font-size:16px;line-height:150%;font-family: 宋体">的重点在于</span><span style="font-size:16px;line-height:150%">C</span><span style="font-size:16px;line-height:150%;font-family:宋体">端（控制端），同时也为</span><span style="font-size:16px;line-height:150%">V</span><span style="font-size:16px;line-height:150%;font-family:宋体">端提供了一系列定制的标签，但是几乎没有涉及到</span><span style="font-size:16px;line-height:150%">M</span><span style="font-size:16px;line-height:150%;font-family:宋体">端。所以在流行的轻量级</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架组合</span><span style="font-size:16px;line-height:150%">SSH</span><span style="font-size:16px;line-height:150%;font-family:宋体">中，</span><span style="font-size:16px;line-height:150%">Struts</span><span style="font-size:16px;line-height:150%;font-family: 宋体">只是扮演了</span><span style="font-size:16px;line-height:150%">Controller</span><span style="font-size:16px;line-height:150%;font-family: 宋体">端的角色。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">JavaBean</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">是一种</span><span style="font-size:16px;line-height:150%">JAVA</span><span style="font-size:16px;line-height:150%;font-family:宋体">语言写成的可重用组件，是公共的</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">类。在</span><span style="font-size:16px;line-height:150%">IDE</span><span style="font-size:16px;line-height:150%;font-family:宋体">中，</span><span style="font-size:16px;line-height:150%">JavaBean</span><span style="font-size:16px;line-height:150%;font-family: 宋体">的功能允许应用开发者浏览其中的方法，即</span><span style="font-size:16px;line-height:150%">JavaBean</span><span style="font-size:16px;line-height:150%;font-family: 宋体">是被编译的，无法利用原始的源文件。此外，还发展出了企业</span><span style="font-size:16px;line-height:150%">Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Enterprise JavaBeans</span><span style="font-size:16px;line-height:150%;font-family:宋体">），即</span><strong><span style="font-size:16px;line-height:150%">EJB</span></strong><span style="font-size:16px;line-height:150%;font-family: 宋体">，它包括会话</span><span style="font-size:16px;line-height:150%">Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Session Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">），实体</span><span style="font-size:16px;line-height:150%">Bean</span><span style="font-size: 16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Entity Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">）和消息驱动</span><span style="font-size:16px;line-height:150%">Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">MessageDriven Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">）。由于</span><span style="font-size:16px;line-height:150%">EJB2.0</span><span style="font-size:16px;line-height:150%;font-family:宋体">过于复杂，在</span><span style="font-size:16px;line-height:150%">Spring</span><span style="font-size:16px;line-height:150%;font-family: 宋体">和</span><span style="font-size:16px;line-height:150%">Hibernate</span><span style="font-size:16px;line-height:150%;font-family: 宋体">等轻量级框架出现后，大量的用户放弃了</span><span style="font-size:16px;line-height:150%">EJB</span><span style="font-size:16px;line-height:150%;font-family:宋体">。但目前轻量级的</span><span style="font-size:16px;line-height:150%">EJB3.0</span><span style="font-size:16px;line-height:150%;font-family: 宋体">、</span><span style="font-size:16px;line-height:150%">EJB3.1</span><span style="font-size:16px;line-height:150%;font-family: 宋体">已经放出，并得到了认可。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">PS</span><span style="font-size:16px;line-height:150%;font-family:宋体">：</span><strong><span style="font-size:16px;line-height:150%">JavaBean</span></strong><strong><span style="font-size:16px;line-height: 150%;font-family:宋体">和</span></strong><strong><span style="font-size:16px;line-height:150%">EJB</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">的区别</span></strong></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;&nbsp;&nbsp; JavaBean</span><span style="font-size:16px;line-height:150%;font-family:宋体">是使用</span><span style="font-size:16px;line-height:150%">java.beans</span><span style="font-size:16px;line-height:150%;font-family:宋体">包开发的，它是</span><span style="font-size:16px;line-height:150%">Java 2</span><span style="font-size:16px;line-height:150%;font-family: 宋体">标准版的一部分。</span><span style="font-size:16px;line-height:150%">JavaBean</span><span style="font-size:16px;line-height:150%;font-family: 宋体">是一台机器上同一个地址空间中运行的组件，是进程内组件。</span><span style="font-size:16px;line-height:150%">Enterprise Bean</span><span style="font-size:16px;line-height:150%;font-family:宋体">是使用</span><span style="font-size:16px;line-height:150%">javax.ejb</span><span style="font-size:16px;line-height:150%;font-family:宋体">包开发的，它是标准</span><span style="font-size:16px;line-height:150%">JDK</span><span style="font-size:16px;line-height:150%;font-family:宋体">的扩展，是</span><span style="font-size:16px;line-height:150%">J2EE</span><span style="font-size:16px;line-height:150%;font-family:宋体">的一部分。</span><span style="font-size:16px;line-height:150%">EJB</span><span style="font-size:16px;line-height:150%;font-family:宋体">是在多台机器上跨几个地址空间运行的组件，是进程间组件。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family:宋体">中的两个</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">模型</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">MVC Model 1</span></strong></p><p style="line-height:150%"><span style="font-size:16px;line-height:150%;font-family:宋体">即传统的</span><span style="font-size:16px;line-height:150%">JSP+JavaBean</span><span style="font-size:16px;line-height:150%;font-family:宋体">，目前已经很少用了，但是初学者学习</span><span style="font-size:16px;line-height:150%">Struts</span><span style="font-size:16px;line-height:150%;font-family: 宋体">前有必要了解。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">MVC Model 2</span></strong></p><p style="line-height:150%"><span style="font-size:16px;line-height:150%;font-family:宋体">该模型的标准是：</span><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family:宋体">（视图</span><span style="font-size:16px;line-height:150%">View</span><span style="font-size:16px;line-height:150%;font-family:宋体">，用户界面）</span><span style="font-size:16px;line-height:150%">+Servlet</span><span style="font-size:16px;line-height:150%;font-family: 宋体">（控制器</span><span style="font-size:16px;line-height:150%">Controller</span><span style="font-size:16px;line-height:150%;font-family: 宋体">，输入处理）</span><span style="font-size:16px;line-height:150%">+JavaBean</span><span style="font-size:16px;line-height:150%;font-family: 宋体">（模型</span><span style="font-size:16px;line-height:150%">Model</span><span style="font-size:16px;line-height:150%;font-family: 宋体">，功能逻辑）。由于</span><span style="font-size:16px;line-height:150%">Java EE</span><span style="font-size:16px;line-height:150%;font-family: 宋体">中的</span><span style="font-size:16px;line-height:150%">JavaBean </span><span style="font-size:16px;line-height:150%;font-family: 宋体">（</span><span style="font-size:16px;line-height:150%">EJB2.0</span><span style="font-size:16px;line-height:150%;font-family: 宋体">）太复杂了，所以该模型最流行的一个版本是</span><span style="font-size:16px;line-height:150%">SSH</span><span style="font-size:16px;line-height:150%;font-family:宋体">，即</span><span style="font-size:16px;line-height:150%">Struts+Spring+Hibernate</span><span style="font-size:16px;line-height: 150%;font-family:宋体">。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family:宋体">应用分层模型</span></p><p style="line-height:150%"><span style="font-size:16px;line-height:150%;font-family:宋体">大致分为如下五层：</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%;font-family:宋体">（数据持久层</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">——</span><span style="font-size:16px;line-height:150%">&gt;</span><strong><span style="font-size: 16px;line-height:150%;font-family:宋体">数据访问层）</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">——</span><span style="font-size:16px;line-height:150%">&gt;</span><strong><span style="font-size: 16px;line-height:150%;font-family:宋体">业务逻辑层</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">——</span><span style="font-size:16px;line-height:150%">&gt;</span><strong><span style="font-size: 16px;line-height:150%;font-family:宋体">控制层</span></strong><span style="font-size: 16px;line-height:150%;font-family:宋体">——</span><span style="font-size:16px;line-height:150%">&gt;</span><strong><span style="font-size:16px;line-height: 150%;font-family:宋体">表示层</span></strong></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">&nbsp;</span></strong></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%;font-family:宋体">数据持久层：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">该层由一系列负责操纵</span><span style="font-size:16px;line-height:150%">POJO</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Plain Old Java Object</span><span style="font-size:16px;line-height:150%;font-family:宋体">，普通的、传统的</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size: 16px;line-height:150%;font-family:宋体">对象）的类组成，这些类负责把数据进行持久化，一般是<span style="text-decoration:underline;">把数据保存到数据库中</span>。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%;font-family:宋体">数据访问层：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">该层由一系列的</span><span style="font-size:16px;line-height:150%">DAO</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Data Access Object</span><span style="font-size:16px;line-height:150%;font-family:宋体">）组件组成，<span style="text-decoration:underline;">实现对数据的增、删、改、查等细粒度的操作</span>。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%;font-family:宋体">业务逻辑层：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">该层由一系列的业务逻辑对象组成，<span style="text-decoration:underline;">实现系统所需要的业务逻辑方法</span>。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%;font-family:宋体">控制层：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">此层由一系列控制器组成，用于<span style="text-decoration:underline;">拦截用户请求</span>并调用业务逻辑对象的业务方法来处理请求，根据处理结果转发到不同的表示层。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%;font-family:宋体">表示层：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">此层由一系列的视图组件（<span style="text-decoration:underline;">例如</span></span><span style="text-decoration:underline;"><span style="font-size:16px;line-height:150%">JSP</span><span style="font-size:16px;line-height:150%;font-family: 宋体">页面</span></span><span style="font-size:16px;line-height:150%;font-family:宋体">）组成，负责收集用户请求并显示处理结果。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family:宋体">各层组件之间以松散的方式耦合在一起。</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">POJO</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">对象</span></strong><strong><span style="font-size:16px;line-height:150%">1</span></strong><span style="font-size:16px;line-height:150%">&lt;</span><span style="font-size:16px;line-height:150%;font-family:宋体">——</span><strong><span style="font-size:16px;line-height:150%">DAO</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">对象</span></strong><strong><span style="font-size:16px;line-height:150%">1</span></strong></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">POJO</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">对象</span></strong><strong><span style="font-size:16px;line-height:150%">2</span></strong><span style="font-size:16px;line-height:150%">&lt;</span><span style="font-size:16px;line-height:150%;font-family:宋体">——</span><strong><span style="font-size:16px;line-height:150%">DAO</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">对象</span></strong><strong><span style="font-size:16px;line-height:150%">2 </span></strong><span style="font-size:16px;line-height:150%">&lt;</span><span style="font-size:16px;line-height:150%;font-family:宋体">——<strong>业务逻辑对象</strong></span><span style="font-size:16px;line-height:150%">&lt;</span><span style="font-size:16px;line-height:150%;font-family:宋体">——<strong>控制层</strong></span><span style="font-size:16px;line-height:150%">&lt;</span><span style="font-size:16px;line-height:150%;font-family:宋体">——<strong>表示层组件</strong></span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">POJO</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">对象</span></strong><strong><span style="font-size:16px;line-height:150%">3</span></strong><span style="font-size:16px;line-height:150%">&lt;</span><span style="font-size:16px;line-height:150%;font-family:宋体">——</span><strong><span style="font-size:16px;line-height:150%">DAO</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">对象</span></strong><strong><span style="font-size:16px;line-height:150%">3</span></strong></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">Hibernate</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%;font-family:宋体">它是一个开源的、轻量级的</span><span style="font-size:16px;line-height:150%">ORM</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Object Relation Mapping</span><span style="font-size:16px;line-height: 150%;font-family:宋体">）持久化框架，它允许应用程序以面向对象的方式来操作关系型的数据库。通过简单的配置和编码即可替代</span><span style="font-size:16px;line-height:150%">JDBC</span><span style="font-size:16px;line-height:150%;font-family:宋体">繁琐的程序代码。在</span><span style="font-size:16px;line-height:150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">语言中，数据可以存储在实体对象中，同时实体对象之间具有继承、多态和聚合等特点，而在数据库中存储的是二维关系数据，表与表的关系只有主外键关联关系，</span><span style="font-size:16px;line-height:150%">Hibernate</span><span style="font-size:16px;line-height:150%;font-family: 宋体">的引入可以解决上述矛盾。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;</span></p><p style="line-height:150%"><strong><span style="font-size:16px;line-height:150%">Spring</span></strong><strong><span style="font-size:16px;line-height:150%;font-family:宋体">：</span></strong><span style="font-size:16px;line-height:150%">Spring</span><span style="font-size:16px;line-height:150%;font-family: 宋体">框架是</span><span style="font-size:16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family: 宋体">应用的全方位解决方案，它贯穿于表示层、业务层和持久层。</span><span style="font-size:16px;line-height:150%">Spring</span><span style="font-size:16px;line-height:150%;font-family: 宋体">自身还提供了一个</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架：</span><span style="font-size:16px;line-height:150%">Spring MVC</span><span style="font-size:16px;line-height:150%;font-family: 宋体">，使用</span><span style="font-size:16px;line-height:150%">Spring</span><span style="font-size:16px;line-height:150%;font-family: 宋体">可以直接使用该</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架，也可以方便地与其他</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架集成，它像是一个中间容器，向上可以与</span><span style="font-size:16px;line-height:150%">MVC</span><span style="font-size:16px;line-height:150%;font-family:宋体">框架整合，向下可以和各种持久层框架整合（</span><span style="font-size:16px;line-height:150%">Hibernate</span><span style="font-size:16px;line-height:150%;font-family: 宋体">、</span><span style="font-size:16px;line-height:150%">iBATIS</span><span style="font-size:16px;line-height:150%;font-family: 宋体">、</span><span style="font-size:16px;line-height:150%">OJB</span><span style="font-size:16px;line-height:150%;font-family:宋体">、</span><span style="font-size:16px;line-height:150%">JDBC</span><span style="font-size:16px;line-height:150%;font-family:宋体">），将系统中的各个部分组件以松散的方式结合在一起。</span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;&nbsp;&nbsp; Spring</span><span style="font-size:16px;line-height:150%;font-family:宋体">作为一个一站式的</span><span style="font-size:16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family:宋体">解决方案，渗透了</span><span style="font-size:16px;line-height:150%">JavaEE</span><span style="font-size:16px;line-height:150%;font-family: 宋体">技术的方方面面，它主要用来实现依赖注入、面向切面编程（</span><span style="font-size:16px;line-height:150%">AOP</span><span style="font-size:16px;line-height:150%;font-family:宋体">，用于降低耦合）、声明式事务以及对持久层的支持和简化等功能。最新的</span><span style="font-size:16px;line-height:150%">Spring</span><span style="font-size:16px;line-height:150%;font-family: 宋体">框架也集成了</span><span style="font-size:16px;line-height:150%">JPA</span><span style="font-size:16px;line-height:150%;font-family:宋体">（</span><span style="font-size:16px;line-height:150%">Java Persistence API</span><span style="font-size:16px;line-height:150%;font-family:宋体">，</span><span style="font-size:16px;line-height: 150%">Java</span><span style="font-size:16px;line-height:150%;font-family:宋体">持久化</span><span style="font-size:16px;line-height:150%">API</span><span style="font-size:16px;line-height:150%;font-family:宋体">），并实现了</span><span style="font-size:16px;line-height:150%">EJB3.0</span><span style="font-size:16px;line-height:150%;font-family: 宋体">的一些特性。</span><span style="font-size:16px;line-height:150%"> </span></p><p style="line-height:150%"><span style="font-size: 16px;line-height:150%">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">二、搭建环境</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">1.</span><span style="font-size:16px;font-family:宋体">安装</span><span style="font-size:16px">MyEclipse</span></p><p><span style="font-size:16px;font-family:宋体">直接下载安装，我是在电驴上下载的最新破解版</span><span style="font-size:16px">10.0</span><span style="font-size:16px;font-family:宋体">版，</span><span style="font-size:16px">ALL in ONE</span><span style="font-size:16px;font-family:宋体">包（集成了</span><span style="font-size: 16px">jdk</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">tomcat</span><span style="font-size:16px;font-family:宋体">等）。安装文件名是：</span></p><p><span style="font-size:16px;color:red">myeclipse-10.0-offline-installer-windows.exe</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">安装完</span><span style="font-size:16px">MyEclipse</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">ALL in ONE</span><span style="font-size:16px;font-family:宋体">包之后，我又安装了最新版的</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">JDK</span><span style="font-size:16px;font-family:宋体">。方法如下：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">2.</span><span style="font-size:16px;font-family:宋体">安装</span><span style="font-size:16px">Tomcat</span></p><p><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">直接解压，文件名是：</span></p><p><span style="font-size:16px;color:red">apache-tomcat-7.0.23-windows-x86.zip</span></p><p><span style="font-size:16px;font-family:宋体">然后给</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">设置（系统）环境变量：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">变量名：</span><span style="font-size:16px">TOMCAT_HOME</span><span style="font-size:16px;font-family:宋体">，值：</span><span style="font-size:16px">C:\</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">\apache-tomcat-7.0.23</span></p><p><span style="font-size:16px;font-family:宋体">变量名：</span><span style="font-size:16px">CATALINA_HOME</span><span style="font-size: 16px;font-family:宋体">，值：</span><span style="font-size:16px">%TOMCAT_HOME%</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">变量名：</span><span style="font-size:16px">CLASSPATH</span><span style="font-size:16px;font-family:宋体">，值：</span></p><pre class="brush:plain;toolbar:false">.;
%JAVA_HOME%\lib\dt.jar;
%JAVA_HOME%\lib\tools.jar</pre><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">3.</span><span style="font-size:16px;font-family:宋体">安装</span><span style="font-size:16px">JDK</span></p><p><span style="font-size:16px;font-family:宋体">直接双击</span><span style="font-size:16px">EXE</span><span style="font-size:16px;font-family:宋体">文件安装，文件名为：</span></p><p><span style="font-size:16px;color:red">jdk-7u1-windows-i586.exe</span></p><p><span style="font-size:16px;font-family:宋体">然后设置系统环境变量：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">变量名：</span><span style="font-size:16px">JAVA_HOME</span><span style="font-size:16px;font-family:宋体">，值：</span><span style="font-size:16px">C:\</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">\jdk1.7.0_01</span></p><p><span style="font-size:16px;font-family:宋体">变量名：</span><span style="font-size:16px">Path</span><span style="font-size:16px;font-family:宋体">，值（最前面加上）：</span><span style="font-size:16px">%JAVA_HOME%\bin;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">4.</span><span style="font-size:16px;font-family:宋体">整合</span><span style="font-size:16px">MyEclipse</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">JDK</span></p><p><span style="font-size:16px;font-family:宋体">新建工程的时候，在选择</span><span style="font-size:16px">JRE</span><span style="font-size:16px;font-family:宋体">的下面有一个</span><span style="font-size:16px">Configure</span><span style="font-size:16px;font-family:宋体">的链接，点击进去设置就</span><span style="font-size:16px">OK</span><span style="font-size:16px;font-family:宋体">。</span></p><p><img src="http://ires.qiniudn.com/my/img/20150708/clip_image001.png" title="clip_image001.png"/></p><p><span style="font-size:16px;font-family:宋体">也可以在最上面的菜单栏选择</span><span style="font-size:16px">Windows-&gt;Preferences</span><span style="font-size:16px;font-family:宋体">展开</span><span style="font-size:16px">java</span><span style="font-size:16px;font-family:宋体">，找到</span><span style="font-size:16px">InstalJREs</span><span style="font-size:16px;font-family:宋体">，然后设置。（注意在选择“</span><span style="font-size:16px">JRE Home</span><span style="font-size:16px;font-family:宋体">”时要选择</span><span style="font-size: 16px">JDK</span><span style="font-size:16px;font-family:宋体">的目录，例如</span><span style="font-size:16px">D:\Java\jdk1.7.0_01</span><span style="font-size:16px;font-family: 宋体">，而不是选择</span><span style="font-size: 16px">JDK</span><span style="font-size:16px;font-family:宋体">目录下面的</span><span style="font-size:16px">JRE</span><span style="font-size:16px;font-family:宋体">子目录！）</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">5. MyEclipse</span><span style="font-size: 16px;font-family:宋体">整合</span><span style="font-size:16px">Tomcat</span></p><p><span style="font-size:16px;font-family:宋体">最上面的菜单栏选择</span><span style="font-size:16px">Windows-&gt;Preferences</span><span style="font-size:16px;font-family:宋体">展开</span><span style="font-size:16px">MyEclipse-&gt;Servers-&gt;Tomcat</span><span style="font-size:16px;font-family:宋体">，然后设置目录，并将</span><span style="font-size:16px">Enable</span><span style="font-size:16px;font-family:宋体">勾上，然后点击</span><span style="font-size:16px">Apply</span><span style="font-size:16px;font-family:宋体">，最后点击</span><span style="font-size:16px">OK</span><span style="font-size:16px;font-family:宋体">。</span></p><p><span style="font-size:16px;font-family:宋体">配置和打开</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">服务的方法如下，直接在工具栏上找到：</span></p><p><img src="http://ires.qiniudn.com/my/img/20150708/clip_image002.png" title="clip_image002.png"/></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">6.</span><span style="font-size:16px;font-family:宋体">新建</span><span style="font-size:16px">Web Project</span><span style="font-size:16px;font-family:宋体">工程和</span></p><p><span style="font-size:16px;font-family:宋体">直接</span><span style="font-size:16px">new-&gt;Web Project</span><span style="font-size:16px;font-family:宋体">或者</span><span style="font-size:16px">new-&gt;Project</span><span style="font-size:16px;font-family:宋体">然后再选择</span><span style="font-size: 16px">Web Project</span><span style="font-size:16px;font-family:宋体">，选择相应的</span><span style="font-size:16px">J2EE</span><span style="font-size:16px;font-family:宋体">版本，那个</span><span style="font-size:16px">Marven</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">JSTL</span><span style="font-size:16px;font-family:宋体">默认不选。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">文件路径默认是在</span><span style="font-size:16px">MyEclipse</span><span style="font-size:16px;font-family:宋体">的工作空间下的，</span><span style="font-size:16px">WebRoot</span><span style="font-size:16px;font-family:宋体">下存放</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">文件。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">7.</span><span style="font-size:16px;font-family:宋体">新建</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">文件</span></p><p><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">Web Project</span><span style="font-size:16px;font-family:宋体">工程中的</span><span style="font-size:16px">WebRoot</span><span style="font-size:16px;font-family:宋体">目录上右键单击，如果</span><span style="font-size:16px">New</span><span style="font-size:16px;font-family:宋体">里面有就直接新建</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">（</span><span style="font-size:16px">Advanced Templates</span><span style="font-size:16px;font-family:宋体">），如果没有则比较麻烦：</span><span style="font-size:16px">New-&gt;others</span><span style="font-size:16px;font-family:宋体">，展开</span><span style="font-size:16px">Web</span><span style="font-size:16px;font-family:宋体">，找到</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">（</span><span style="font-size:16px">Advanced Templates</span><span style="font-size:16px;font-family:宋体">）。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p style="margin-left:0;text-indent:0"><span style="font-size:16px">8.Myeclipse</span><span style="font-size:16px;font-family:宋体">部署</span><span style="font-size:16px">Web</span><span style="font-size:16px;font-family:宋体">项目</span></p><p><span style="font-size:16px;font-family:宋体">点击图标：</span><span style="font-size:16px"><img src="http://ires.qiniudn.com/my/img/20150708/clip_image003.png" alt="说明: QQ拼音截图未命名" title="clip_image003.png"/></span><span style="font-size:16px;font-family:宋体">左边那个，然后</span><span style="font-size:16px">Add</span><span style="font-size:16px;font-family:宋体">相应的</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">就可以了。</span></p><p><span style="font-size:16px;font-family:宋体">这样操作后，</span><span style="font-size:16px">MyEclipse</span><span style="font-size:16px;font-family:宋体">会在</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">Web</span><span style="font-size:16px;font-family:宋体">目录（默认为</span><span style="font-size:16px">webapps</span><span style="font-size:16px;font-family:宋体">）下生成一个以工程名命名的文件夹，</span><span style="font-size:16px">WebRoot</span><span style="font-size:16px;font-family:宋体">下的</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">文件会同步到该目录中，以便</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">加载。</span></p><p><span style="font-size:16px;font-family:宋体">注意：</span><span style="font-size:16px">MyEclipse</span><span style="font-size:16px;font-family:宋体">自带的</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">webapps</span><span style="font-size:16px;font-family:宋体">路径在：</span></p><p><span style="font-size:16px">\Workspaces\MyEclipse\.metadata\.me_tcat\webapps</span></p><p><span style="font-size:16px;font-family:宋体">而</span><span style="font-size:16px">Tomcat</span><span style="font-size:16px;font-family:宋体">安装目录在：</span></p><p><span style="font-size:16px">\MyEclipse\Common\plugins\com.genuitec.eclipse.easie.tomcat.myeclipse_9.0.0.me201109141806\tomcat</span></p><p><span style="font-size:16px">MyEclipse</span><span style="font-size:16px;font-family:宋体">自带的</span><span style="font-size:16px">JDK</span><span style="font-size:16px;font-family:宋体">安装路径在：</span></p><p><span style="font-size:16px">\MyEclipse\Common\binary\com.sun.java.jdk.win32.x86_1.6.0.013</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">二、</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">基础</span></p><p><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">、语法</span></p><p><span style="font-size:16px;font-family:宋体">变量声明</span><span style="font-size:16px">&lt;%!</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">%&gt;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">注意：在</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">内定义函数时，要放在</span><span style="font-size:16px">&lt;%!</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">%&gt;</span><span style="font-size:16px;font-family:宋体">内，否则可能会出错。</span></p><p><span style="font-size:16px">JSP Scriptlets</span><span style="font-size: 16px;font-family:宋体">语法</span><span style="font-size:16px">&lt;%</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">%&gt;</span></p><p><span style="font-size:16px;font-family:宋体">服务器端注释</span><span style="font-size:16px">&lt;%--</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">--%&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px;color:red">JSP</span><span style="font-size:16px;font-family:宋体;color:red">指令元素</span><span style="font-size:16px">&lt;%@</span><span style="font-size:16px;font-family:宋体">……</span><span style="font-size:16px">%&gt;</span></p><p><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">page</span><span style="font-size:16px;font-family:宋体">指令</span></p><p><span style="font-size:16px;font-family:宋体">常用属性</span><span style="font-size:16px">language,contenType,import,extends,session,info,isErrorPage</span><span style="font-size:16px;font-family:宋体">等。</span></p><p><span style="font-size:16px;font-family:宋体">例如</span><span style="font-size:16px">&lt;%@ page language=&quot;java&quot; contenType=&quot;text/html;charset=gb2312&quot; %&gt;</span></p><p><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">include</span><span style="font-size:16px;font-family:宋体">指令</span></p><p><span style="font-size:16px;font-family:宋体">语法格式为</span><span style="font-size:16px">&lt;%@ include file=&quot;</span><span style="font-size:16px;font-family:宋体">地址</span><span style="font-size:16px">&quot; %&gt;</span><span style="font-size:16px;font-family:宋体">，这种包含属于编译前包含。</span></p><p><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">taglib</span><span style="font-size:16px;font-family:宋体">指令</span></p><p><span style="font-size:16px;font-family:宋体">声明自定义标签，语法格式为</span><span style="font-size:16px">&lt;%@ taglib uri=&quot;URI&quot; prefix=&quot;tagPrefix&quot; %&gt;</span><span style="font-size:16px;font-family:宋体">例如</span></p><p><span style="font-size:16px">&lt;%@ taglib prefix=&quot;c&quot; uri=&quot;http://java.sun.com/jsp/jstl/core&quot; %&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体;color:red">动作元素</span><span style="font-size:16px;font-family:宋体">（单标签或者配对的标签）</span></p><p><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">&lt;jsp:include&gt;</span><span style="font-size:16px;font-family:宋体">动作元素</span></p><p><span style="font-size:16px;font-family:宋体">语法为：</span><span style="font-size:16px">&lt;jsp:include page=&quot;URL&quot; flush=&quot;true|false&quot;&gt;</span></p><p><span style="font-size:16px;font-family:宋体">可以包含</span><span style="font-size:16px">txt</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">html</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">jsp</span><span style="font-size:16px;font-family:宋体">文件，与</span><span style="font-size:16px">include</span><span style="font-size:16px;font-family:宋体">指令元素不同的是，对于静态文件它是编译后在包含，所以</span><span style="font-size:16px">txt</span><span style="font-size:16px;font-family:宋体">文件中的</span><span style="font-size:16px">jsp</span><span style="font-size:16px;font-family:宋体">代码执行不了。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">&lt;jsp:forward&gt;</span></p><p><span style="font-size:16px;font-family:宋体">用法例如：</span><span style="font-size:16px">&lt;jsp:forward page=&quot;text.jsp&quot;&gt;&lt;/jsp:forward&gt;</span><span style="font-size: 16px;font-family:宋体">属于服务器端跳转。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">&lt;jsp:param&gt;</span></p><p><span style="font-size:16px;font-family:宋体">用法为：</span><span style="font-size:16px">&lt;jsp:param name=&quot;&quot; value=&quot;&quot;/&gt;</span><span style="font-size:16px;font-family:宋体">通常配合跳转的</span><span style="font-size: 16px">jsp:forward</span><span style="font-size:16px;font-family:宋体">和包含进文件的</span><span style="font-size:16px">jsp:include</span><span style="font-size:16px;font-family:宋体">一起使用。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">4</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">&lt;jsp:plugin&gt;&lt;jsp:params&gt;&lt;jsp:fallback&gt; </span></p><p><span style="font-size:16px;font-family:宋体">配合使用。</span><span style="font-size:16px">plugin</span><span style="font-size:16px;font-family:宋体">用于向</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">中插入</span><span style="font-size:16px">Java</span><span style="font-size:16px;font-family:宋体">插件，比如</span><span style="font-size:16px">Applet</span><span style="font-size:16px;font-family:宋体">。相当于</span><span style="font-size:16px">HTML4.0</span><span style="font-size:16px;font-family:宋体">版本中的</span><span style="font-size:16px">&lt;object&gt;</span><span style="font-size:16px;font-family:宋体">标签。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;color:red">5.JSP</span><span style="font-size: 16px;font-family:宋体;color:red">内置对象</span></p><p><span style="font-size:16px;font-family:宋体">包括</span><span style="font-size:16px">out, response, pageContext, page, request, session, application, config, exception</span><span style="font-size:16px;font-family:宋体">等。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">）设置与读取属性，属性的范围</span></p><p><span style="font-size:16px;font-family:宋体">范围分为：</span><span style="font-size:16px">page, request, session, application</span><span style="font-size:16px;font-family:宋体">，分别是当前页面有效（任何跳转都无效），本次请求有效（服务器端跳转仍有效），本次登录有效（只要不关闭浏览器断开了连接），服务器端不重启永久有效。</span></p><p><span style="font-size:16px;font-family:宋体">设置属性的方法为</span><span style="font-size:16px">pageContext.setAttribute(&quot;name&quot;,&quot;value&quot;)</span><span style="font-size:16px;font-family:宋体">。</span><span style="font-size:16px">request, session, application</span><span style="font-size:16px;font-family:宋体">类似。</span></p><p><span style="font-size:16px;font-family:宋体">读取属性的方法类似。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">）获取客户端传来的参数（用</span><span style="font-size:16px">request</span><span style="font-size:16px;font-family:宋体">对象）</span></p><p><span style="font-size:16px;font-family:宋体">例如</span></p><p style="line-height: normal;"><span style="font-size:16px">request.getParameter(String name) //</span><span style="font-size:16px;font-family:宋体">获取指定</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">的值</span></p><p style="line-height: normal;"><span style="font-size:16px">request.getParameterNames() //</span><span style="font-size:16px;font-family:宋体">获取所有</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">的名称</span></p><p style="line-height: normal;"><span style="font-size:16px">request.getParameterValues(String name) //</span><span style="font-size:16px;font-family:宋体">获取指定</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">的多个值</span></p><p style="line-height: normal;"><span style="font-size:16px">request.getParameterMap() //</span><span style="font-size:16px;font-family:宋体">获得所有数据，封装在</span><span style="font-size:16px">Map</span><span style="font-size:16px;font-family:宋体">对象中</span></p><p><span style="font-size:16px">Map</span><span style="font-size:16px;font-family:宋体">中存放了成对的</span><span style="font-size:16px">name-values</span><span style="font-size:16px;font-family:宋体">值，例如</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;%</span></p><p style="line-height: normal;"><span style="font-size:16px">Map umap= request.getParameterMap();</span></p><p style="line-height: normal;"><span style="font-size:16px">String[] strUsername= (String[])umap.get(&quot;username&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">%&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px"><br/></span></p><p><span style="font-size:16px;font-family:宋体">此外，还有</span><span style="font-size:16px">getIntHeader(String name), getRequestedSessionId()</span><span style="font-size:16px;font-family:宋体">等等。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">response</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">用于给客户端传送信息。例如添加新的</span><span style="font-size:16px">Cookie</span><span style="font-size:16px;font-family:宋体">或者跳转等。</span></p><p><span style="font-size:16px;font-family:宋体">例如，实现页面跳转：</span><span style="font-size:16px">response.sendRedirect(&quot;DirectPage.jsp&quot;);</span></p><p><span style="font-size:16px;font-family:宋体">实现自动刷新：</span><span style="font-size:16px">response.addIntHeader(&quot;</span><span style="font-size:16px;font-family:宋体">自动刷新</span><span style="font-size:16px">&quot;,10);</span></p><p><span style="font-size:16px;font-family:宋体">实现自动跳转刷新：</span><span style="font-size:16px">response.setHeader(&quot;</span><span style="font-size:16px;font-family:宋体">自动刷新</span><span style="font-size:16px">&quot;,&quot;10;URL=http://www.&quot;);</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">4</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">out</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px">out</span><span style="font-size:16px;font-family:宋体">对象常用的方法有</span><span style="font-size:16px">println(), close(), clear(),getBufferSize(),&nbsp; getRemaining()</span><span style="font-size: 16px;font-family:宋体">等。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">5</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">用于设置与获得</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">信息。例如：</span><span style="font-size:16px">getId(), setMaxInactiveInterval()</span><span style="font-size:16px;font-family:宋体">设置生命周期</span><span style="font-size: 16px">, isNew(), invalidate()</span><span style="font-size:16px;font-family:宋体">清空。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">6</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">application</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">用于获取与设置服务器端</span><span style="font-size:16px">Servlet</span><span style="font-size:16px;font-family:宋体">的相关信息，例如</span><span style="font-size:16px">getSerInfo(), getRealPath()</span><span style="font-size:16px;font-family:宋体">等。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">7</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">pageContext</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">用法很多，</span><span style="font-size:16px">session, request, application</span><span style="font-size:16px;font-family:宋体">的对象它都可以读，例如</span><span style="font-size:16px">getRequest()</span><span style="font-size:16px;font-family:宋体">。</span></p><p><span style="font-size:16px;font-family:宋体">例如，读取</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">范围</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">属性：</span><span style="font-size:16px">pageContext.getAttribute(&quot;name&quot;, pageContext.SESSION_SCOPE);</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">8</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">page</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">通过</span><span style="font-size:16px">page</span><span style="font-size:16px;font-family:宋体">对象可以调用</span><span style="font-size:16px">Servlet</span><span style="font-size:16px;font-family:宋体">类中定义的方法，例如：</span></p><p><span style="font-size:16px">String info=((javax.servlet.jsp.HttpJspPage)page).getServletInfo();</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">9</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">config</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">该对象允许访问</span><span style="font-size:16px">Servlet</span><span style="font-size:16px;font-family:宋体">或</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">引擎的初始化参数。例如</span><span style="font-size:16px">getServletMame()</span><span style="font-size:16px;font-family:宋体">。</span></p><p><br/></p><p><span style="font-size:16px">10</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">exception</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px;font-family:宋体">例如：</span></p><p><span style="font-size:16px">exception.getMessage(),</span></p><p><span style="font-size:16px">exception.printStackTrace(new java.io.PrintWriter(out))</span><span style="font-size:16px;font-family:宋体">等</span></p><p><br/></p><p><br/></p><p><span style="font-size:16px">6</span><span style="font-size:16px;font-family:宋体">、数据库操作</span></p><p><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">）将</span><span style="font-size:16px">mysql-connector-java-5.0.8-bin.jar</span><span style="font-size:16px;font-family:宋体">文件拷贝到</span><span style="font-size:16px">WEB-INF/lib</span><span style="font-size:16px;font-family:宋体">目录下；</span></p><p><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">）使用</span><span style="font-size:16px">Class.forName(&quot;com.mysql.jdbc.Driver&quot;);</span><span style="font-size:16px;font-family:宋体">来加载</span><span style="font-size:16px">MySQL</span><span style="font-size:16px;font-family:宋体">驱动；</span></p><p><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">）使用</span><span style="font-size:16px">Connection conn=DriverManager.getConnection(url,user,passwd);</span><span style="font-size:16px;font-family:宋体">连接数据库，其中一般定义</span><span style="font-size:16px">String url=&quot;jdbc:mysql://localhost:3306/dbname&quot;;</span><span style="font-size:16px;font-family:宋体">也可以直接把</span><span style="font-size:16px">user</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">passwd</span><span style="font-size:16px;font-family:宋体">写在</span><span style="font-size:16px">dbname</span><span style="font-size:16px;font-family:宋体">后：</span><span style="font-size:16px">dbname?user=root&amp;password=admin</span><span style="font-size:16px;font-family:宋体">；</span></p><p><span style="font-size:16px">4</span><span style="font-size:16px;font-family:宋体">）创建语句对象</span><span style="font-size:16px">Statement</span><span style="font-size:16px;font-family:宋体">，以便执行</span><span style="font-size:16px">SQL</span><span style="font-size:16px;font-family:宋体">，例如：</span></p><p><span style="font-size:16px">Statement stmt = conn.createStatement();</span></p><p><span style="font-size:16px">String addUser=&quot;INSERT INTO user(userid,username,passwd) VALUES(null,</span></p><p><span style="font-size:16px">&#39;Zollty&#39;,&#39;1234&#39;)&quot;;</span></p><p><span style="font-size:16px">stmt.executeUpdate(adduser);</span></p><p><span style="font-size:16px;font-family:宋体">以下是连接</span><span style="font-size:16px">mysql</span><span style="font-size:16px;font-family:宋体">数据库的示范</span><span style="font-size:16px">java</span><span style="font-size:16px;font-family:宋体">文件：</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">package</span></strong><span style="font-family: Consolas"> csai.db;</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">import</span></strong><span style="font-family: Consolas"> java.sql.*;</span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">class</span></strong><span style="font-family: Consolas"> DBConn {</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F7F5F">//</span><span style="font-family: &#39;MS Mincho&#39;;color:#3F7F5F">得到数据</span><span style="font-family: 宋体;color:#3F7F5F">库连</span><span style="font-family: &#39;MS Mincho&#39;;color:#3F7F5F">接</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">static</span></strong><span style="font-family: Consolas"> Connection createDBConn(){</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">try</span></strong><span style="font-family: Consolas">{</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Class.<i>forName</i>(</span><span style="font-family:Consolas;color:#2A00FF">&quot;com.mysql.jdbc.Driver&quot;</span><span style="font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Connection conn=DriverManager.<i>getConnection</i>(</span><span style="font-family:Consolas;color:#2A00FF">&quot;jdbc:mysql://localhost:3306/root&quot;</span><span style="font-family: Consolas">,</span><span style="font-family:Consolas;color:#2A00FF">&quot;root&quot;</span><span style="font-family: Consolas">,</span><span style="font-family:Consolas;color:#2A00FF">&quot;admin&quot;</span><span style="font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">return</span></strong><span style="font-family: Consolas"> conn;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span style="font-family:Consolas;color:#7F0055">catch</span></strong><span style="font-family: Consolas">(Exception e){</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">return</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">null</span></strong><span style="font-family: Consolas">;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F7F5F">//</span><span style="font-family: &#39;MS Mincho&#39;;color:#3F7F5F">关</span><span style="font-family: 宋体;color:#3F7F5F">闭</span><span style="font-family: &#39;MS Mincho&#39;;color:#3F7F5F">数据</span><span style="font-family:宋体;color:#3F7F5F">库连</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F7F5F">接</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">void</span></strong><span style="font-family: Consolas"> closeConn(Connection conn){</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">try</span></strong><span style="font-family: Consolas">{</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.close();</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span style="font-family:Consolas;color:#7F0055">catch</span></strong><span style="font-family: Consolas">(Exception e){</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-family: Consolas">}</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">5) </span><span style="font-size:16px;font-family:宋体">更新</span><span style="font-size:16px">executeUpdate</span><span style="font-size:16px;font-family:宋体">，查询</span><span style="font-size:16px">executeQuery</span></p><p><br/></p><p><span style="font-size:16px">6</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">ResultSet</span><span style="font-size:16px;font-family:宋体">结果集，将查询到的结果赋值给</span><span style="font-size:16px">ResultSet</span><span style="font-size:16px;font-family:宋体">，用</span><span style="font-size:16px">getXXX(n)</span><span style="font-size:16px;font-family:宋体">取出具体的字段，例如</span></p><p style="line-height: normal;"><span style="font-size:16px">ResultSet rs = stmt.executeQuery(&quot;SELECT * FROM user&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">while(rs.next()){</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int userid= rs.getInt(1); //</span><span style="font-size:16px;font-family:宋体">取出第一个字段</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String username= rs.getString(2); //</span><span style="font-size:16px;font-family: 宋体">第二个字段</span></p><p style="line-height: normal;"><span style="font-size:16px">}</span></p><p><span style="font-size:16px">SQL</span><span style="font-size:16px;font-family:宋体">技巧：</span><span style="font-size:16px">SELECT userid,username FROM user limit 1,3</span></p><p><br/></p><p><span style="font-size:16px">7</span><span style="font-size:16px;font-family:宋体">）关闭数据库</span></p><p><span style="font-size:16px;font-family:宋体">通常如下：</span></p><p style="line-height: normal;"><span style="font-size:16px">try{</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(rs != null){ rs.close(); rs=null; }//</span><span style="font-size:16px;font-family:宋体">注意顺序</span><span style="font-size:16px">rs</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">stmt</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">conn</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(stmt != null){ stmt.close(); stmt=null; }</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(conn != null){ conn.close(); conn=null; }</span></p><p style="line-height: normal;"><span style="font-size:16px">}catch(Exception e){</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out.println(&quot;</span><span style="font-size:16px;font-family:宋体">数据库关闭异常</span><span style="font-size:16px">&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">}</span></p><p><br/></p><p><span style="font-size:16px">8</span><span style="font-size:16px;font-family:宋体">）预处理语句对象</span><span style="font-size:16px">PreparedStatement</span></p><p><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">Statement</span><span style="font-size:16px;font-family:宋体">差不多，最大的区别在于可以在</span><span style="font-size:16px">SQL</span><span style="font-size:16px;font-family:宋体">语句中用</span><span style="font-size:16px">?</span><span style="font-size:16px;font-family:宋体">代替实际值，在后面才调用对象的</span><span style="font-size:16px">setXXX(n,xx)</span><span style="font-size:16px;font-family:宋体">方法为第</span><span style="font-size: 16px">n</span><span style="font-size:16px;font-family:宋体">个</span><span style="font-size:16px">?</span><span style="font-size:16px;font-family:宋体">赋</span><span style="font-size:16px">XXX</span><span style="font-size:16px;font-family:宋体">类型的值，例如</span></p><p><span style="font-size:16px">String addUser =&quot;INSERT INTO user(userid,username,passwd) VALUES(null,?,?)&quot;;</span></p><p><span style="font-size:16px">PreparedStatement pstmt= conn.prepareStatement(addUser);</span></p><p><span style="font-size:16px">pstmt= conn.setString(1,&quot;Zollty&quot;);</span></p><p><span style="font-size:16px">pstmt= conn.setString(2,&quot;123456&quot;); //</span><span style="font-size:16px;font-family:宋体">设置参数</span></p><p><span style="font-size:16px">pstmt.exetuteUpdate(); //</span><span style="font-size:16px;font-family:宋体">直接执行</span><span style="font-size:16px">Update</span><span style="font-size:16px;font-family:宋体">，此时无需参数。</span></p><p><br/></p><p><br/></p><p><span style="font-size:16px">7</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">中调用</span><span style="font-size:16px;color:red">JavaBean</span></p><p><span style="font-size:16px">&lt;jsp:useBean id=&quot;&quot; scope=&quot;&quot; class=&quot;&quot;&gt;&lt;/jsp:useBean&gt;</span></p><p><span style="font-size:16px;font-family:宋体">例如一个</span><span style="font-size:16px">JavaBean</span><span style="font-size:16px;font-family:宋体">内容如下：</span></p><pre class="brush:java;toolbar:false">package&nbsp;com.zollty.ch07;
public&nbsp;class&nbsp;UserBean&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;private&nbsp;String&nbsp;username;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;String&nbsp;getUsername()&nbsp;{&nbsp;return&nbsp;username;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;void&nbsp;setUsername(String&nbsp;username)&nbsp;{&nbsp;//自定义的get方法
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.username=&nbsp;username;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p><br/></p><p><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">中调用的方法为</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;jsp:useBean id=&quot;user&quot; scope=&quot;page&quot; class=&quot;com.zollty.ch07.UserBean&quot;&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;/jsp:useBean&gt; //user</span><span style="font-size:16px;font-family:宋体">相当于</span><span style="font-size:16px">new</span><span style="font-size:16px;font-family:宋体">的一个</span><span style="font-size:16px">UserBean</span><span style="font-size:16px;font-family:宋体">类实例</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;%</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; user.setUsername(&quot;Zollty&quot;); //</span><span style="font-size:16px;font-family:宋体">用自定义的方法设置参数值</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; out.println(user.getUsername());</span></p><p style="line-height: normal;"><span style="font-size:16px">%&gt;</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">也可以用动作元素标签来设置数据的值，达到和自定义函数</span><span style="font-size: 16px">setUsername(&quot;Zollt</span></p><p><span style="font-size:16px">y&quot;)</span><span style="font-size:16px;font-family:宋体">一样的效果（范围都要受到</span><span style="font-size:16px">&lt;jsp:useBean&gt;</span><span style="font-size:16px;font-family: 宋体">的影响），例如有一个表单，里面有</span><span style="font-size:16px">uname</span><span style="font-size:16px;font-family:宋体">这一项：</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;form action=&quot;Test3.jsp&quot; method=&quot;post&quot;&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;input type=&quot;text&quot; name=&quot;uname&quot;&gt;&lt;br&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;input type=&quot;submit&quot; value=&quot;</span><span style="font-size:16px;font-family:宋体">提交</span><span style="font-size:16px">&quot;&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;/form&gt;</span></p><p><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">Test3.jsp</span><span style="font-size:16px;font-family:宋体">里面通过</span></p><p><span style="font-size:16px">&lt;jsp:setProperty name=&quot;user&quot; property=&quot;*&quot; /&gt;</span></p><p><span style="font-size:16px;font-family:宋体">就可以将</span><span style="font-size:16px">user</span><span style="font-size:16px;font-family:宋体">实例中的所有数据元素值自动匹配</span><span style="font-size:16px">form</span><span style="font-size:16px;font-family:宋体">表单中的属性值。再通过</span><span style="font-size:16px">user.getUsername()</span><span style="font-size:16px;font-family:宋体">或者</span><span style="font-size:16px">&lt;jsp:getProperty name=&quot;user&quot; property=&quot;username&quot; /&gt;</span><span style="font-size:16px;font-family:宋体">就可以获取了。</span></p><p><span style="font-size:16px;font-family:宋体">上面的</span><span style="font-size:16px">property=&quot;*&quot;</span><span style="font-size:16px;font-family:宋体">是特例，一般写作：</span></p><p><span style="font-size:16px">&lt;jsp:setProperty name=&quot;user&quot; property=&quot;username&quot; param=&quot;uname&quot; /&gt;</span></p><p><span style="font-size:16px;font-family:宋体">其中</span><span style="font-size:16px">property</span><span style="font-size:16px;font-family:宋体">对应的是</span><span style="font-size:16px">UserBean</span><span style="font-size:16px;font-family:宋体">类中的数据，而</span><span style="font-size:16px">param</span><span style="font-size:16px;font-family:宋体">指的是</span><span style="font-size:16px">form</span><span style="font-size:16px;font-family:宋体">表单中的参数（此处是</span><span style="font-size:16px">input</span><span style="font-size:16px;font-family:宋体">标签中</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">的值）。相当于把</span><span style="font-size:16px">param</span><span style="font-size:16px;font-family:宋体">的值赋给</span><span style="font-size:16px">property</span><span style="font-size:16px;font-family:宋体">，而且这个赋值只在</span><span style="font-size:16px">page</span><span style="font-size:16px;font-family:宋体">范围内有效，也就是说仅本页内可以取得这个值，任何跳转了页面这个值就不存在了。其实</span><span style="font-size:16px">page</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">request</span><span style="font-size:16px;font-family:宋体">等四个范围的值是独立存在的，要访问也必须指定范围。</span></p><p><span style="font-size:16px">PS</span><span style="font-size:16px;font-family:宋体">：这里</span><span style="font-size:16px">form</span><span style="font-size:16px;font-family:宋体">表单中提交的数据类型要和</span><span style="font-size:16px">Bean</span><span style="font-size:16px;font-family:宋体">中的数据的类型一样。</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">移除</span><span style="font-size:16px">JavaBean</span><span style="font-size:16px;font-family:宋体">，例如要移除</span><span style="font-size:16px">page</span><span style="font-size:16px;font-family:宋体">范围内的</span><span style="font-size:16px">JavaBean</span><span style="font-size:16px;font-family:宋体">，则在</span><span style="font-size:16px">JavaScripts</span><span style="font-size:16px;font-family:宋体">里面写</span></p><p><span style="font-size:16px">&lt;%</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pageContext.removeAttribute(&quot;user&quot;);</span></p><p><span style="font-size:16px">%&gt;</span></p><p><span style="font-size:16px;font-family:宋体">注意到虽然是调用“移除属性”的方法，但是</span><span style="font-size:16px">&quot;user&quot;</span><span style="font-size:16px;font-family:宋体">并不是属性，它与</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">内置对象的</span><span style="font-size:16px">pageContext.setAttribute(&quot;name&quot;,&quot;value&quot;)</span><span style="font-size:16px;font-family:宋体">有些区别：</span><span style="font-size:16px">&quot;user&quot;</span><span style="font-size:16px;font-family:宋体">是自定义的类</span><span style="font-size: 16px">UserBean</span><span style="font-size:16px;font-family:宋体">的实例，而</span><span style="font-size:16px">&quot;name&quot;</span><span style="font-size:16px;font-family:宋体">只是一个普通的名字，是一个字符串。</span></p><p><br/></p><p><span style="font-size:16px">PS</span><span style="font-size:16px;font-family:宋体">：英文</span><span style="font-size:16px">Attribute</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">Property</span><span style="font-size:16px;font-family:宋体">都是属性的意思，但在</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">中</span><span style="font-size:16px">Attribute</span><span style="font-size:16px;font-family:宋体">可以是一个类或普通变量，而</span><span style="font-size:16px">Property</span><span style="font-size:16px;font-family:宋体">是指一个类的数据成员。</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体;color:red">注意：</span><span style="font-size:16px">JSP</span><span style="font-size:16px;font-family:宋体">是放在</span><span style="font-size:16px">Web</span><span style="font-size:16px;font-family:宋体">工程</span><span style="font-size:16px">ch01</span><span style="font-size:16px;font-family:宋体">下的</span><span style="font-size:16px">WebRoot</span><span style="font-size:16px;font-family:宋体">目录下，和</span><span style="font-size:16px">META-INF</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">WEB-INF</span><span style="font-size:16px;font-family:宋体">在同一级目录，而</span><span style="font-size:16px">JavaBean</span><span style="font-size:16px;font-family:宋体">是放在</span><span style="font-size:16px">ch01</span><span style="font-size:16px;font-family:宋体">下的</span><span style="font-size:16px">src</span><span style="font-size:16px;font-family:宋体">文件夹下的</span><span style="font-size:16px">com.zollty</span><span style="font-size:16px;font-family:宋体">包中，在其他地方中引用只需要引入</span><span style="font-size:16px">class=&quot;com.zollty.UserBean&quot;</span><span style="font-size: 16px;font-family:宋体">即可。</span></p><p><br/></p><p><span style="font-size:16px">8</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px;color:red">EL</span><span style="font-size:16px;font-family:宋体;color:red">表达式</span></p><p><span style="font-size:16px">EL</span><span style="font-size:16px;font-family:宋体">运算符：有</span><span style="font-size:16px">()</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">[]</span><span style="font-size:16px;font-family:宋体">、！</span><span style="font-size:16px">(not)</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">*</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">/</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">+</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">-</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&lt;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&lt;=</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">==</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&amp;&amp;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">||</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">${A?B:C}</span><span style="font-size:16px;font-family:宋体">等</span></p><p><br/></p><p><span style="font-size:16px">EL</span><span style="font-size:16px;font-family:宋体">内置对象（</span><span style="font-size:16px">EL</span><span style="font-size:16px;font-family:宋体">存取器（也称为导航）），用于获取某些值。例如</span></p><p><span style="font-size:16px">${pageScope.user.username}</span><span style="font-size:16px;font-family:宋体">，等价于</span><span style="font-size:16px">${pageScope.user[&quot;username&quot;]}</span></p><p><span style="font-size:16px;font-family:宋体">接收用户参数（从表单</span><span style="font-size:16px">post</span><span style="font-size:16px;font-family:宋体">过来的），例如：</span></p><p><span style="font-size:16px">${param.username}</span></p><p><span style="font-size:16px">${paramValues.interest[0]} ${param.interest[1]}</span></p><p><span style="font-size:16px;font-family:宋体">这个</span><span style="font-size:16px">param</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">paramValues</span><span style="font-size:16px;font-family:宋体">相当于前面讲的</span><span style="font-size:16px">request.getParameter()</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">request.getParameterValues()</span><span style="font-size:16px;font-family:宋体">。</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">同理</span><span style="font-size:16px">EL</span><span style="font-size:16px;font-family:宋体">存取器还可以获得</span><span style="font-size:16px">JavaBean</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">Map</span><span style="font-size:16px;font-family:宋体">、数组、对象中的值。复杂对象的写法类似于：</span><span style="font-size:16px">${sessionScope.shoppingCart[0].price}</span><span style="font-size: 16px;font-family:宋体">，例如</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;%</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HashMap userInfo= new HashMap();</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; userInfo.put(&quot;username&quot;,&quot;zollty&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session.setAttribute(&quot;userInfo&quot;,userInfo);</span></p><p style="line-height: normal;"><span style="font-size:16px">%&gt;</span></p><p><span style="font-size:16px;font-family:宋体">然后就可以调用</span><span style="font-size:16px">${userInfo.username}</span></p><p><span style="font-size:16px;font-family:宋体">再例如：</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;%</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style="font-size:16px;font-family:宋体">下面定义一个对象数组</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ArrayList&lt;Person&gt; persons= new ArrayList&lt;Person&gt;();</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style="font-size:16px;font-family:宋体">实例化两个</span><span style="font-size:16px">Person</span><span style="font-size:16px;font-family:宋体">对象</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Person p1=new Person(&quot;Zollty&quot;,23,&quot;</span><span style="font-size:16px;font-family:宋体">男</span><span style="font-size:16px">&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Person p2=new Person(&quot;Duby2&quot;,20,&quot;</span><span style="font-size:16px;font-family:宋体">女</span><span style="font-size:16px">&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style="font-size:16px;font-family:宋体">将</span><span style="font-size:16px">p1</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">p2</span><span style="font-size:16px;font-family:宋体">装入对象数组中</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; persons.add(p1);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; perssons.add(p2);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session.setAttribute(&quot;persons&quot;,persons);</span></p><p style="line-height: normal;"><span style="font-size:16px">%&gt;</span></p><p><span style="font-size:16px;font-family:宋体">然后就可以访问</span><span style="font-size:16px">${sessionScope.persons[0].name}</span></p><p><br/></p><p><span style="font-size:16px">PS:</span><span style="font-size:16px;font-family:宋体">设置</span><span style="font-size:16px">Cookie</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;%</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Cookie c=new Cookie(&quot;username&quot;,&quot;zollty&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; response.addCookie(c);</span></p><p style="line-height: normal;"><span style="font-size:16px">%&gt;</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">其他</span></p><p style="line-height: normal;"><span style="font-size:16px">${cookie.username.value}</span></p><p style="line-height: normal;"><span style="font-size:16px">${header[&quot;host&quot;]}</span><span style="font-size:16px;font-family:宋体">将显示</span><span style="font-size:16px">localhost:8080</span></p><p style="line-height: normal;"><span style="font-size:16px">${initParam.username}</span><span style="font-size:16px;font-family:宋体">，其中</span><span style="font-size:16px">username</span><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">web.xml</span><span style="font-size:16px;font-family:宋体">中设置：</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;context-param&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;param-name&gt;username&lt;/param-name&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;param-value&gt;Zollty&lt;/param-value&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;/contextparam&gt;</span></p><p><span style="font-size:16px;font-family:宋体">利用下面等方法获取</span><span style="font-size:16px">get</span><span style="font-size:16px;font-family:宋体">或</span><span style="font-size:16px">post</span><span style="font-size:16px;font-family:宋体">方式传递的信息：</span></p><p style="line-height: normal;"><span style="font-size:16px">${pageContent.request.queryString}</span></p><p style="line-height: normal;"><span style="font-size:16px">${pageContent.request.requestURL}</span></p><p style="line-height: normal;"><span style="font-size:16px">${pageContent.request.contextPath}</span></p><p><br/></p><p><span style="font-size:16px">9</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px;color:red">JSTL</span></p><p><span style="font-size:16px">1. JSTL</span><span style="font-size:16px;font-family:宋体">核心标签</span></p><p><span style="font-size:16px">&lt;c:set&gt;</span><span style="font-size: 16px;font-family:宋体">设置变量</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:set var=”varName” value=”varValue” [scope=”page|request|session|application”]&gt;<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; default value<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/c:set&gt;</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:remove&gt;</span><span style="font-size: 16px;font-family:宋体">移除变量</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;c:remove var=”varName” [scope=”page|request|session|application”] /&gt;</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:out&gt;</span><span style="font-size: 16px;font-family:宋体">输出</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;c: out value=”object” [escapeXml=”true|false”] &gt;defalut value&lt;/c:out&gt;</span></p><p><span style="font-size:16px">escapeXml</span><span style="font-size:16px;font-family:宋体">默认为</span><span style="font-size:16px">ture</span><span style="font-size:16px;font-family:宋体">，是将</span><span style="font-size:16px">&lt;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&gt;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&#39;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&quot;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&amp;</span><span style="font-size:16px;font-family:宋体">转换成</span><span style="font-size:16px">(&lt;)&amp;lt;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">(&gt;)&amp;gt;</span><span style="font-size:16px;font-family:宋体">、</span></p><p><span style="font-size:16px">(&#39;)&amp;#039;</span><span style="font-size: 16px;font-family:宋体">、</span><span style="font-size:16px">(&quot;)&amp;#034;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">(&amp;)&amp;amp;</span><span style="font-size:16px;font-family:宋体">输出。</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:if&gt;</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;c:if test=”checkCondition” var=”varName” scope=”page|request|session|application”&gt;<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; body content<br/> &lt;/c:if&gt;</span></p><p><span style="font-size:16px;font-family:宋体">当</span><span style="font-size:16px">test</span><span style="font-size:16px;font-family:宋体">的表达式为</span><span style="font-size:16px">ture</span><span style="font-size:16px;font-family:宋体">时会执行</span><span style="font-size:16px">body content</span><span style="font-size:16px;font-family:宋体">。判断结果</span><span style="font-size: 16px">ture</span><span style="font-size:16px;font-family:宋体">或</span><span style="font-size:16px">false</span><span style="font-size:16px;font-family:宋体">存放到</span><span style="font-size:16px">var</span><span style="font-size:16px;font-family:宋体">中。</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:choose&gt;</span><span style="font-size: 16px;font-family:宋体">、</span><span style="font-size:16px">&lt;c:when&gt;</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">&lt;c:otherwise&gt;</span><span style="font-size:16px;font-family: 宋体">相当于</span><span style="font-size:16px">if else</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp; &nbsp; &nbsp; &nbsp;&lt;c:set var=”num” scope=”page” value=”admin”/&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size: 12px; color: red;">c:choose</span><span style="font-size: 12px; color: rgb(51, 153, 102);">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:</span><span style="font-size: 12px; color: red;">when test=”${num==’guest’}”</span><span style="font-size: 12px; color: rgb(51, 153, 102);">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:out value=”guest”/&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/c:when&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:</span><span style="font-size: 12px; color: red;">when test=”${num==’admin’}”</span><span style="font-size: 12px; color: rgb(51, 153, 102);">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:out value=”admin”/&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/c:when&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:</span><span style="font-size: 12px; color: red;">otherwise</span><span style="font-size: 12px; color: rgb(51, 153, 102);">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:out value=”other”/&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/c:otherwise&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span><span style="font-size: 12px; color: red;">/c:choose</span><span style="font-size: 12px; color: rgb(51, 153, 102);">&gt;</span></span></p><p><br/></p><p><span style="font-size:16px">&lt;c:forEach&gt;</span><span style="font-size:16px;font-family:宋体">遍历或循环</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;c:forEach items=”collection” var=”varName” [varstatue=”varStatusName”] [begin=”begin”] [end=”end”] [step=”step”]&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Body content</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;/c:forEach&gt;</span></p><p><span style="font-size:16px">items</span><span style="font-size:16px;font-family:宋体">指被迭代的对象成员，</span><span style="font-size:16px">var</span><span style="font-size:16px;font-family:宋体">指当前指到的成员，</span><span style="font-size:16px">begin/end</span><span style="font-size:16px;font-family:宋体">设定起始和结束的位置，</span><span style="font-size:16px">step</span><span style="font-size:16px;font-family:宋体">为步长，</span><span style="font-size:16px">varstatue</span><span style="font-size:16px;font-family:宋体">存储迭代的状态信息，含</span><span style="font-size:16px">index</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">count</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">first</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">last</span><span style="font-size:16px;font-family:宋体">四个方法，例如</span></p><p><span style="font-size: 12px;">&lt;c:forEach var=”ItemName” items=”${Items}” begin=”3” end=”4” step=”1” varStatus=”s”&gt;</span></p><p><span style="font-size: 12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;&lt;c:out value=”${ItemName}” /&gt;</span><span style="font-size: 12px; font-family: 宋体;">的四种属性</span><span style="font-size: 12px;">:&lt;br&gt;</span></p><p><span style="font-size: 12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;</span><span style="font-size: 12px; font-family: 宋体;">所在位置即索引</span><span style="font-size: 12px;">: &lt;c:out value=”${s.index}” /&gt; &lt;br&gt;</span></p><p><span style="font-size: 12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;</span><span style="font-size: 12px; font-family: 宋体;">总共已迭代的次数</span><span style="font-size: 12px;">: &lt;c:out value=”${s.count}”/&gt;&lt;br&gt;</span></p><p><span style="font-size: 12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;</span><span style="font-size: 12px; font-family: 宋体;">是否为第一个位置</span><span style="font-size: 12px;">: &lt;c:out value=”${s.first}” /&gt;&lt;br&gt;</span></p><p><span style="font-size: 12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;</span><span style="font-size: 12px; font-family: 宋体;">是否为最后一个位置</span><span style="font-size: 12px;">: &lt;c:out value=”${s.last}”/&gt;</span></p><p><span style="font-size: 12px;">&lt;/c:forEach&gt;</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:forTokens&gt;</span><span style="font-size:16px;font-family:宋体">分割字符串</span></p><p><span style="font-size:16px;font-family:宋体">例如：</span></p><p><span style="font-size: 12px;">&lt;c:forTokens var=”token” items=”bleu,rouge|vert,jaune|blanc,rouge” delims=”|,”&gt;</span></p><p><span style="font-size: 12px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;nbsp;&amp;nbsp;&lt;c:out value=”${token}”/&gt;</span></p><p><span style="font-size: 12px;">&lt;/c:forTokens&gt;</span></p><p><span style="font-size:16px">delims</span><span style="font-size:16px;font-family:宋体">属性是自定义的分隔符，</span><span style="font-size:16px">items</span><span style="font-size:16px;font-family:宋体">为要分割的字符串，还有其他熟悉和</span><span style="font-size:16px">forEach</span><span style="font-size:16px;font-family:宋体">差不多。</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:import&gt;</span><span style="font-size: 16px;font-family:宋体">引入静态文件，比</span><span style="font-size:16px">&lt;jsp:import&gt;</span><span style="font-size:16px;font-family: 宋体">功能更强</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;c:import url=”url” [context=”context”] [var=”varName”] [scope=”page|request|session|application”] [varReader=”varReader”] [charEncodion=”charEncoding”]&gt;</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Body content</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;/c:import&gt;</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:redirect&gt;</span><span style="font-size:16px;font-family:宋体">跳转页面，和</span><span style="font-size:16px">&lt;jsp:redirect&gt;</span><span style="font-size:16px;font-family: 宋体">一样</span></p><p><span style="font-size:16px">&lt;c:param&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:redirect url=”url” [context=”context”]&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:param name=”paramName” value=”value”/&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/c:redirect&gt;</span></p><p><br/></p><p><span style="font-size:16px">&lt;c:url&gt;</span><span style="font-size: 16px;font-family:宋体">将</span><span style="font-size:16px">URL</span><span style="font-size:16px;font-family:宋体">赋值给一个变量，便于重复调用</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;c:url value=”value” [context=”context”] [var=”varName”] [scope=”page|request|session|application”] &gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;c:param name=”paramName” value=”value” /&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;/c:url&gt;</span></p><p><br/></p><p><span style="font-size:16px">2.</span><span style="font-size:16px;font-family:宋体">数据库标签</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;sql:setDataSource&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;sql:update&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;sql:query&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;sql:param&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;sql:dateParam&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;sql:transaction&gt;</span></p><p><span style="font-size:16px">3.I18N</span><span style="font-size:16px;font-family:宋体">格式化标签库</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:formatNumber&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:parseNumber&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:formatDate&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:parseDate&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:setTimeZone&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:timeZone&gt;</span></p><p><br/></p><p><span style="font-size:16px">&lt;fmt:setLocale&gt;</span><span style="font-size:16px;font-family:宋体">设置本地化环境（语言</span><span style="font-size:16px">+</span><span style="font-size:16px;font-family:宋体">地区）</span></p><p><span style="font-size: 14px; color: rgb(51, 153, 102);">&lt;fmt:setLocale value=”…locale value…” [variant=”…variant value…”] [scope=”page|request|session|application”] /&gt;</span></p><p><span style="font-size:16px;font-family:宋体">例如</span><span style="font-size:16px">&lt;fmt:setLocal value=&quot;zh_CN&quot;&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:requestEncoding&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:setBundle&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:message&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:param&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;fmt:bundle&gt;</span></p><p><span style="font-size:16px">4.XML</span><span style="font-size:16px;font-family:宋体">标签库</span></p><p><span style="font-size:16px;font-family:宋体">首先导入</span><span style="font-size:16px">xalan.jar</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">serializer.jar</span><span style="font-size:16px;font-family:宋体">到</span><span style="font-size:16px">Web</span><span style="font-size:16px;font-family:宋体">站点中的</span><span style="font-size:16px">WEB-INF/lib</span><span style="font-size:16px;font-family:宋体">目录下，如果在多个站点中都要使用就放到</span><span style="font-size:16px">TOMCAT</span><span style="font-size:16px;font-family:宋体">安装目录下的</span><span style="font-size:16px">lib</span><span style="font-size:16px;font-family:宋体">中。</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;x:parse&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;x:out&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;x:set&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;x:if&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;x:choose&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&lt;x:forEach&gt;</span></p><p><br/></p><p><span style="font-size:16px">10</span><span style="font-size:16px;font-family:宋体">、网页中访问</span><span style="font-size:16px">Servlet</span><span style="font-size:16px;font-family:宋体">（须在</span><span style="font-size:16px">web.xml</span><span style="font-size:16px;font-family:宋体">中配置）</span><span style="font-size:16px"><br/> </span><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">src</span><span style="font-size:16px;font-family:宋体">文件夹下新建一个</span><span style="font-size:16px">com.zollty</span><span style="font-size:16px;font-family:宋体">包，然后新建</span><span style="font-size:16px">ServletDemo0</span><span style="font-size:16px;font-family:宋体">类，在</span><span style="font-size:16px">WEB-INF</span><span style="font-size:16px;font-family:宋体">文件夹下的</span><span style="font-size:16px">web.xml</span><span style="font-size:16px;font-family:宋体">中配置这个类：在</span><span style="font-size:16px">&lt;web-app&gt;</span><span style="font-size:16px;font-family:宋体">标签对之间添加</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;</span><span style="color:#3F7F7F">servlet</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;</span><span style="color:#3F7F7F">servlet-name</span><span style="color:teal">&gt;</span>ServletDemo01<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">servlet-name</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;</span><span style="color:#3F7F7F">servlet-class</span><span style="color:teal">&gt;</span>com.zollty.ServletDemo01<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">servlet-class</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;/</span><span style="color:#3F7F7F">servlet</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;</span><span style="color:#3F7F7F">servlet-mapping</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;</span><span style="color:#3F7F7F">servlet-name</span><span style="color:teal">&gt;</span>ServletDemo01<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">servlet-name</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;</span><span style="color:#3F7F7F">url-pattern</span><span style="color:teal">&gt;</span>/ServletDemo01<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">url-pattern</span><span style="color:teal">&gt;</span></p><p style="line-height: normal;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:teal">&lt;/</span><span style="color:#3F7F7F">servlet-mapping</span><span style="color:teal">&gt;</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">11、Servlet之<span style="color:red">Filter</span>和<span style="color:red">Listener</span></span></p><p><span style="font-size:16px;font-family:宋体">Filter开发分为二个步骤：</span></p><p><span style="font-size:16px;font-family:宋体">1.编写java类实现Filter接口，并实现其doFilter方法。</span></p><p><span style="font-size:16px;font-family:宋体">2.在 web.xml 文件中使用&lt;filter&gt;和&lt;filter-mapping&gt;元素对编写的filter类进行注册，并设置它所能拦截的资源。</span></p><p><span style="font-size:16px;font-family:宋体">Filter链</span></p><p><span style="font-size:16px;font-family:宋体">在一个web应用中，可以开发编写多个Filter，这些Filter组合起来称之为一个Filter链。</span></p><p><span style="font-size:16px;font-family:宋体">web服务器根据Filter在web.xml文件中的注册顺序，决定先调用哪个Filter，当第一个Filter的doFilter方法被调用时，web服务器会创建一个代表Filter链的FilterChain对象传递给该方法。在doFilter方法中，开发人员如果调用了FilterChain对象的doFilter方法，则web服务器会检查FilterChain对象中是否还有filter，如果有，则调用第2个filter，如果没有，则调用目标资源。</span></p><p><span style="font-size:16px;font-family:宋体">Filter链实验（查看filterChain API文档）</span></p><p><span style="font-size:16px;font-family:宋体">Filter的部署-注册Filter</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&lt;filter&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp; &nbsp; &lt;filter-name&gt;testFitler&lt;/filter-name&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp; &nbsp; &lt;filter-class&gt;org.test.TestFiter&lt;/filter-class&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp; &nbsp; &lt;init-param&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp; &nbsp; &nbsp; &nbsp; &lt;param-name&gt;word_file&lt;/param-name&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp; &nbsp; &nbsp; &nbsp; &lt;param-value&gt;/WEB-INF/word.txt&lt;/param-value&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp; &lt;/init-param&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&lt;/filter&gt;</span></p><p><span style="font-size:16px;font-family:宋体">1.&lt;filter-name&gt;用于为过滤器指定一个名字，该元素的内容不能为空。</span></p><p><span style="font-size:16px;font-family:宋体">2.&lt;filter-class&gt;元素用于指定过滤器的完整的限定类名。</span></p><p><span style="font-size:16px;font-family:宋体">3.&lt;init-param&gt;元素用于为过滤器指定初始化参数，它的子元素&lt;param-name&gt;指定参数的名字，&lt;param-value&gt;指定参数的值。在过滤器中，可以使用FilterConfig接口对象来访问初始化参数。</span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">&lt;filter-mapping&gt;元素用于设置一个 Filter 所负责拦截的资源。一个Filter拦截的资源可通过两种方式来指定：Servlet 名称和资源访问的请求路径</span></p><p><span style="font-size:16px;font-family:宋体">&lt;filter-name&gt;子元素用于设置filter的注册名称。该值必须是在&lt;filter&gt;元素中声明过的过滤器的名字</span></p><p><span style="font-size:16px;font-family:宋体">&lt;url-pattern&gt;设置 filter 所拦截的请求路径(过滤器关联的URL样式)</span></p><p><span style="font-size:16px;font-family:宋体">&lt;servlet-name&gt;指定过滤器所拦截的Servlet名称。</span></p><p><span style="font-size:16px;font-family:宋体">&lt;dispatcher&gt;指定过滤器所拦截的资源被 Servlet 容器调用的方式，可以是REQUEST,INCLUDE,FORWARD和ERROR之一，默认REQUEST。用户可以设置多个&lt;dispatcher&gt; 子元素用来指定 Filter 对资源的多种调用方式进行拦截。</span></p><p><span style="font-size:16px;font-family:宋体">&lt;dispatcher&gt; 子元素可以设置的值及其意义：</span></p><p><span style="font-size:16px;font-family:宋体">REQUEST：当用户直接访问页面时，Web容器将会调用过滤器。如果目标资源是通过RequestDispatcher的include()或forward()方法访问时，那么该过滤器就不会被调用。</span></p><p><span style="font-size:16px;font-family:宋体">INCLUDE：如果目标资源是通过RequestDispatcher的include()方法访问时，那么该过滤器将被调用。除此之外，该过滤器不会被调用。</span></p><p><span style="font-size:16px;font-family:宋体">FORWARD：如果目标资源是通过RequestDispatcher的forward()方法访问时，那么该过滤器将被调用，除此之外，该过滤器不会被调用。</span></p><p><span style="font-size:16px;font-family:宋体">ERROR：如果目标资源是通过声明式异常处理机制调用时，那么该过滤器将被调用。除此之外，过滤器不会被调用。</span></p><p><span style="font-size:16px;font-family:宋体">Tip：Filter的部署—映射Filter示例：</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&lt;filter-mapping&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; &lt;filter-name&gt;testFilter&lt;/filter-name&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-pattern&gt;/test.jsp&lt;/url-pattern&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&lt;/filter-mapping&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&lt;filter-mapping&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; &lt;filter-name&gt;testFilter&lt;/filter-name&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; &lt;url-pattern&gt;/index.jsp&lt;/url-pattern&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;&nbsp;&nbsp;&nbsp; &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&lt;/filter-mapping&gt;</span></p><p><span style="font-size:16px;font-family:宋体">FilterConfig接口:</span></p><p><span style="font-size:16px;font-family:宋体">用户在配置filter时，可以使用&lt;init-param&gt;为filter配置一些初始化参数，当web容器实例化Filter对象，调用其init方法时，会把封装了filter初始化参数的filterConfig对象传递进来。因此开发人员在编写filter时，通过filterConfig对象的方法，就可获得：</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">String getFilterName()：得到filter的名称。</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">String getInitParameter(String name)：返回在部署描述中指定名称的初始化参数的值。如果不存在返回null.</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">Enumeration getInitParameterNames()：返回过滤器的所有初始化参数的名字的枚举集合。</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">public ServletContext getServletContext()：返回Servlet上下文对象的引用。</span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">12、<span style="color:red">AJAX基础</span></span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">知识补充：日期和时间</span></p><p><span style="font-size:16px;font-family:宋体">通常要：将自定义的日期和系统时间连接起来，形成一个</span><span style="font-size: 16px">Date</span><span style="font-size:16px;font-family:宋体">字符串。如果还需要格式化时间，则利用</span><span style="font-size:16px">parse</span><span style="font-size:16px;font-family:宋体">函数将标准的</span><span style="font-size:16px">Date</span><span style="font-size:16px;font-family:宋体">字符串转换成</span><span style="font-size:16px">Date</span><span style="font-size:16px;font-family:宋体">对象，然后就可以交给</span><span style="font-size:16px">format</span><span style="font-size:16px;font-family:宋体">来格式化了。方法如下：</span></p><p><span style="font-size: 15px;font-family: Consolas">DateFormat </span><span style="font-size:15px;font-family:Consolas;color:#0000C0">t</span><span style="font-size: 15px;font-family: Consolas">=DateFormat.<i>getTimeInstance</i>();</span></p><p><span style="font-size: 15px;font-family: Consolas">String time=</span> <span style="font-size:15px;font-family:Consolas;color:#0000C0">t</span><i><span style="font-size: 15px;font-family: Consolas">.format(</span></i><span style="font-size:15px;font-family:Consolas;color:#0000C0">new</span><i><span style="font-size: 15px;font-family: Consolas"> java.util.Date());//</span></i><i><span style="font-size: 15px;font-family: 宋体">当前时间</span></i><span style="font-size:15px;font-family:Consolas;color:#2A00FF">HH:mm:ss</span><i><span style="font-size: 15px;font-family: 宋体">样式的，没有毫秒</span></i></p><p><span style="font-size: 15px;font-family: Consolas">String sDate=&quot;</span><i><span style="font-size: 15px;font-family: Consolas">2020-11-11</span></i><span style="font-size: 15px;font-family: Consolas">&quot;+&quot; &quot;+time;//</span><span style="font-size: 15px;font-family: 宋体">完整的日期</span></p><p><span style="font-size: 15px;font-family: Consolas">DateFormat </span><span style="font-size:15px;font-family:Consolas;color:#0000C0">dt</span><span style="font-size: 15px;font-family: Consolas">=DateFormat.<i>getDateTimeInstance</i>();//</span><span style="font-size: 15px;font-family: 宋体">按默认的完整的</span><span style="font-size: 15px;font-family: Consolas">Date</span><span style="font-size: 15px;font-family: 宋体">样式来格式化</span></p><p><span style="font-size: 15px;font-family: Consolas">SimpleDateFormat </span><span style="font-size:15px;font-family:Consolas;color:#0000C0">sdf</span><span style="font-size: 15px;font-family: Consolas">=</span><strong><span style="font-size:15px;font-family:Consolas;color:#7F0055">new</span></strong><span style="font-size: 15px;font-family: Consolas"> SimpleDateFormat(</span><span style="font-size:15px;font-family: Consolas;color:#2A00FF">&quot;yyyy</span><span style="font-size:15px;font-family:宋体;color:#2A00FF">年</span><span style="font-size:15px;font-family:Consolas;color:#2A00FF">MM</span><span style="font-size:15px;font-family:宋体;color:#2A00FF">月</span><span style="font-size:15px;font-family:Consolas;color:#2A00FF">dd</span><span style="font-size:15px;font-family:宋体;color:#2A00FF">日</span> <span style="font-size:15px;font-family: Consolas;color:#2A00FF">HH:mm:ss.S&quot;</span><span style="font-size: 15px;font-family: Consolas">);//</span><span style="font-size:15px;font-family: Consolas;color:#2A00FF">S</span><span style="font-size: 15px;font-family: 宋体">为毫秒</span></p><p><span style="font-size:15px;font-family:Consolas;color:#0000C0">sdf</span><i><span style="font-size: 15px;font-family: Consolas">.format(</span></i><span style="font-size:15px;font-family:Consolas;color:#0000C0">dt</span><i><span style="font-size: 15px;font-family: Consolas">.parse(</span></i><span style="font-size: 15px;font-family: Consolas">sDate</span><i><span style="font-size: 15px;font-family: Consolas">))</span></i><span style="font-size: 15px;font-family: Consolas">;//</span><span style="font-size: 15px;font-family: 宋体">通过</span><span style="font-size:15px;font-family:Consolas;color:#0000C0">df</span><i><span style="font-size: 15px;font-family: Consolas">.parse(</span></i><span style="font-size: 15px;font-family: Consolas">sDate</span><i><span style="font-size: 15px;font-family: Consolas">)</span></i><i><span style="font-size: 15px;font-family: 宋体">将得到一个</span></i><i><span style="font-size: 15px;font-family: Consolas">Date</span></i><i><span style="font-size: 15px;font-family: 宋体">实例</span></i></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">二、设计模式基础</span><span style="font-size:16px">(</span><span style="font-size:16px;font-family:宋体">略</span><span style="font-size:16px">)</span></p><p><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">DAO</span></p><p><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">MVC</span><span style="font-size:16px;font-family:宋体">简介之</span><span style="font-size:16px">Model 1</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">Model 2</span></p><p><br/></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">==========</span><span style="font-size:16px;font-family:宋体">知识补充</span><span style="font-size:16px">============</span></p><p><span style="font-size:16px;font-family:宋体">连接数据库的基本步骤：</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. </span><span style="font-size:16px;font-family:宋体">加载数据库驱动（</span><span style="font-size:16px">Driver Class</span><span style="font-size:16px;font-family:宋体">），例如</span><span style="font-size: 16px">com.mysql.jdbc.Driver</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. </span><span style="font-size:16px;font-family:宋体">连接数据库的</span><span style="font-size:16px">url</span><span style="font-size:16px;font-family:宋体">，例如</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jdbc:mysql://localhost:3306/javaweb</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">把返回的对象赋值给一个</span><span style="font-size:16px">Connection</span><span style="font-size:16px;font-family:宋体">对象（通常命名为</span><span style="font-size: 16px">conn</span><span style="font-size:16px;font-family:宋体">）</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">连接后就可以使用数据库了，使用的基本步骤为</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. </span><span style="font-size:16px;font-family:宋体">创建语句对象（</span><span style="font-size:16px">Statement</span><span style="font-size:16px;font-family:宋体">），例如</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Statement stmt = conn.createStatement();</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">注意右边的</span><span style="font-size:16px">conn</span><span style="font-size:16px;font-family:宋体">就是连接</span><span style="font-size:16px">url</span><span style="font-size:16px;font-family:宋体">时返回的</span><span style="font-size:16px">Connection</span><span style="font-size:16px;font-family:宋体">对象</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. </span><span style="font-size:16px;font-family:宋体">调用语句对象的方法来对数据库进行操作，例如</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; stmt.exeuteUpdate(&quot;SQL</span><span style="font-size:16px;font-family:宋体">语句</span><span style="font-size:16px">&quot;);</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">==============================</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">三、</span><span style="font-size:16px">Struts 2</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">1.</span><span style="font-size:16px;font-family:宋体">上面已经介绍了</span><span style="font-size:16px">Struts</span><span style="font-size:16px;font-family:宋体">，它主要是充当控制器（</span><span style="font-size:16px">Controller</span><span style="font-size:16px;font-family:宋体">）的作用，同时也给</span><span style="font-size:16px">V</span><span style="font-size:16px;font-family:宋体">端提供了许多标签，这些标签能够和</span><span style="font-size:16px">AJAX</span><span style="font-size:16px;font-family:宋体">结合起来。</span></p><p><span style="font-size:16px">2.</span><span style="font-size:16px;font-family:宋体">要使用</span><span style="font-size:16px">Struts 2</span><span style="font-size:16px;font-family:宋体">，需要把相关的</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件拷贝到</span><span style="font-size:16px">WEB-INF/lib</span><span style="font-size:16px;font-family:宋体">目录下，并在</span><span style="font-size:16px">web.xml</span><span style="font-size:16px;font-family:宋体">配置文件中配置</span><span style="font-size:16px">Filter</span><span style="font-size:16px;font-family:宋体">（过滤器）。</span></p><p><span style="font-size:16px">3. Filter</span><span style="font-size:16px;font-family:宋体">配置好后，就可以使用</span><span style="font-size:16px">Struts 2</span><span style="font-size:16px;font-family:宋体">了，为控制层配置</span><span style="font-size: 16px">Action </span><span style="font-size:16px;font-family:宋体">处理结果和视图文件之间的映射，配置文件为</span><span style="font-size:16px">src/struts.xml</span><span style="font-size:16px;font-family:宋体">。示例如下：</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;?</span><span style="font-family:Consolas;color:#3F7F7F">xml</span><span style="font-family:Consolas"> <span style="color:#7F007F">version</span>=<i><span style="color:#2A00FF">&quot;1.0&quot;</span></i> <span style="color:#7F007F">encoding</span>=<i><span style="color:#2A00FF">&quot;UTF-8&quot;</span></i> <span style="color:teal">?&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;!</span><span style="font-family:Consolas;color:#3F7F7F">DOCTYPE</span><span style="font-family:Consolas"> <span style="color:teal">struts</span> <span style="color:gray">PUBLIC</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:teal">&quot;-//Apache Software Foundation//DTD Struts Configuration 2.0//EN&quot;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:#3F7F5F">&quot;http://struts.apache.org/dtds/struts-2.0.dtd&quot;</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- struts</span><span style="font-family:宋体;color:#3F5FBF">为</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">配置文件根元素</span><span style="font-family: Consolas;color:#3F5FBF">--&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">struts</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">constant</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;struts.i18n.encoding&quot;</span></i> <span style="color:#7F007F">value</span>=<i><span style="color:#2A00FF">&quot;gb2312&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">constant</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- Action</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">必</span><span style="font-family:宋体;color:#3F5FBF">须</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">放在指定的包名空</span><span style="font-family:宋体;color:#3F5FBF">间</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">中</span><span style="font-family:Consolas;color:#3F5FBF">--&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">package</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;struts2&quot;</span></i> <span style="color:#7F007F">extends</span>=<i><span style="color:#2A00FF">&quot;struts-default&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">action</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;showAll&quot;</span></i> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;showAllAction&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义处</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">理</span><span style="font-family:宋体;color:#3F5FBF">结</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">果与</span><span style="font-family:宋体;color:#3F5FBF">视图资</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">源之</span><span style="font-family:宋体;color:#3F5FBF">间</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">的关系</span><span style="font-family:Consolas;color:#3F5FBF">--&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">result</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;success&quot;</span></i><span style="color:teal">&gt;</span>/showAll.jsp<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">result</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">action</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">action</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;delete&quot;</span></i> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;deleteAction&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义处</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">理</span><span style="font-family:宋体;color:#3F5FBF">结</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">果与</span><span style="font-family:宋体;color:#3F5FBF">视图资</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">源之</span><span style="font-family:宋体;color:#3F5FBF">间</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">的关系</span><span style="font-family:Consolas;color:#3F5FBF">--&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">result</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;success&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;redirect&quot;</span></i><span style="color:teal">&gt;</span>/showAll.action<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">result</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">action</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">action</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;add&quot;</span></i> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;addAction&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义处</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">理</span><span style="font-family:宋体;color:#3F5FBF">结</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">果与</span><span style="font-family:宋体;color:#3F5FBF">视图资</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">源之</span><span style="font-family:宋体;color:#3F5FBF">间</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">的关系</span><span style="font-family:Consolas;color:#3F5FBF">--&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">result</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;success&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;redirect&quot;</span></i><span style="color:teal">&gt;</span>/showAll.action<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">result</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">result</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;input&quot;</span></i><span style="color:teal">&gt;</span>/add.jsp<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">result</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">result</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;error&quot;</span></i><span style="color:teal">&gt;</span>/add.jsp<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">result</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">action</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">package</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">struts</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px">Struts 2</span><span style="font-size:16px;font-family:宋体">的高级功能</span></p><p><span style="font-size:16px">1.</span><span style="font-size:16px;font-family:宋体">国际化</span></p><p><span style="font-size:16px;font-family:宋体">新建</span><span style="font-size:16px">src\myMessage_zh_CN.properties</span><span style="font-size:16px;font-family:宋体">文件，内容示例如下：</span></p><p><span style="font-family:宋体;color:#3F5FBF">#Generated by ResourceBundle Editor (http://eclipse-rbe.sourceforge.net)</span></p><p><span style="font-family:Consolas;color:#3F7F7F">age.rule</span><span style="font-size:16px;font-family:宋体"> = \u5E74\u9F84\u5FC5\u987B\u5728${min}\u81F3${max}\u4E4B\u95F4</span></p><p><span style="font-family:Consolas;color:#3F7F7F">password.required</span><span style="font-size:16px;font-family:宋体"> = \u5FC5\u987B\u8F93\u5165\u5BC6\u7801</span></p><p><span style="font-size:16px;font-family:宋体">可以用</span><span style="font-size:16px">Eclipse</span><span style="font-size:16px;font-family:宋体">来生成该文件。名字的前面部分</span><span style="font-size:16px">myMessage</span><span style="font-size:16px;font-family:宋体">由自己随便取。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">然后在</span><span style="font-size:16px">src\struts.xml</span><span style="font-size: 16px;font-family:宋体">中添加如下一行即可：</span></p><p><span style="font-family:Consolas;color:#3F7F7F">&lt;constant</span> <span style="font-family:Consolas;color:#7F007F">name</span><span style="font-family: Consolas">=</span><i><span style="font-family:Consolas;color:#2A00FF">&quot;struts.custom.i18n.resources&quot;</span></i> <span style="font-family:Consolas;color:#7F007F">value</span><span style="font-family: Consolas">=</span><i><span style="font-family:Consolas;color:#2A00FF">&quot;myMessage&quot;</span></i><span style="font-family:Consolas;color:#3F7F7F">&gt;&lt;/constant&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">2.</span><span style="font-size:16px;font-family:宋体">服务器端校验</span></p><p><span style="font-size:16px;font-family:宋体">只需要在</span><span style="font-size:16px">ActionName.java</span><span style="font-size: 16px;font-family:宋体">文件目录下，加入</span><span style="font-size:16px">ActionName-validation.xml</span><span style="font-size:16px;font-family:宋体">文件，</span><span style="font-size:16px">xml</span><span style="font-size:16px;font-family:宋体">文件的</span><span style="font-size:16px">ActionName</span><span style="font-size:16px;font-family:宋体">必须和</span><span style="font-size:16px">java</span><span style="font-size:16px;font-family:宋体">文件的</span><span style="font-size:16px">ActionName</span><span style="font-size:16px;font-family:宋体">相同。例如注册页面的校验，有如下几个文件：</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WebRoot\register.jsp</span><span style="font-size:16px;font-family:宋体">，其中的提交表单</span><span style="font-size:16px">action=&quot;register&quot;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; src\struts.xml</span><span style="font-size:16px;font-family:宋体">，在里面把表单的</span><span style="font-size:16px">action=&quot;register&quot;</span><span style="font-size:16px;font-family:宋体">定向到</span><span style="font-size:16px">RegisterAction.java</span><span style="font-size:16px;font-family:宋体">文件</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; src\com\javaweb\RegisterAction.java</span><span style="font-size:16px;font-family:宋体">，里面定义了</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">age</span><span style="font-size:16px;font-family:宋体">等属性及</span><span style="font-size:16px">get/set</span><span style="font-size:16px;font-family:宋体">方法</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; src\com\javaweb\ RegisterAction-validation.xml</span><span style="font-size:16px;font-family: 宋体">校验对应</span><span style="font-size: 16px">java</span><span style="font-size:16px;font-family:宋体">文件中的属性</span></p><p><br/></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">四、</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">及</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">与</span><span style="font-size:16px"> Struts 2 </span><span style="font-size:16px;font-family:宋体">的整合</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">的主要作用是操作数据库的，一方面方便建立数据库的连接，另一方面把关系数据映射成面向对象的数据，通过</span><span style="font-size:16px">HQL</span><span style="font-size:16px;font-family:宋体">来操作数据库的增删查改。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">首先把</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">需要的</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件</span><span style="font-size:16px">hibernate3.jar</span><span style="font-size:16px;font-family:宋体">拷贝到</span><span style="font-size:16px">WEB-INF/lib</span><span style="font-size:16px;font-family:宋体">目录下。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">然后配置</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">，使其能够连接数据库。在没有使用</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">框架时，</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">的配置文件就放在</span><span style="font-size:16px">/src</span><span style="font-size:16px;font-family:宋体">文件夹下，命名为</span><span style="font-size:16px">hibernate.cfg.xml</span><span style="font-size:16px;font-family:宋体">，内容示例如下：</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;!</span><span style="font-family:Consolas;color:#3F7F7F">DOCTYPE</span><span style="font-family:Consolas"> <span style="color:teal">hibernate-configuration</span> <span style="color:gray">PUBLIC</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:teal">&quot;-//Hibernate/Hibernate Configuration DTD 3.0//EN&quot;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:#3F7F5F">&quot;http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd&quot;</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">hibernate-configuration</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">session-factory</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">数据</span><span style="font-family:宋体;color:#3F5FBF">库连</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">接</span><span style="font-family:Consolas;color:#3F5FBF">URL --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;connection.url&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jdbc:mysql://localhost/javaweb</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">数据</span><span style="font-family:宋体;color:#3F5FBF">库连</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">接</span><span style="font-family:宋体;color:#3F5FBF">驱动</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;connection.driver_class&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; com.mysql.jdbc.Driver</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">数据</span><span style="font-family:宋体;color:#3F5FBF">库</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">用</span><span style="font-family:宋体;color:#3F5FBF">户</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">名</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;connection.username&quot;</span></i><span style="color:teal">&gt;</span>root<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">数据</span><span style="font-family:宋体;color:#3F5FBF">库</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">用</span><span style="font-family:宋体;color:#3F5FBF">户</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">密</span><span style="font-family:宋体;color:#3F5FBF">码</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;connection.password&quot;</span></i><span style="color:teal">&gt;</span>admin<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">数据</span><span style="font-family:宋体;color:#3F5FBF">库</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">方言</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;dialect&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.hibernate.dialect.MySQLDialect</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">指定映射文件</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">mapping</span><span style="font-family:Consolas"> <span style="color:#7F007F">resource</span>=<i><span style="color:#2A00FF">&quot;com/javaweb/po/Product.hbm.xml&quot;</span></i><span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">session-factory</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">hibernate-configuration</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">如果使用了</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">框架，则不需要这个文件，直接交由</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">托管，在</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">的配置文件</span><span style="font-size:16px">\WebRoot\WEB-INF\applicationContext.xml</span><span style="font-size:16px;font-family:宋体">中配置类似的内容。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">配置好后，就可以使用了。假如有一个数据文件</span><span style="font-size:16px">User.java</span><span style="font-size:16px;font-family:宋体">，里面定义</span><span style="font-size:16px">id</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">等数据，这时要把这些数据映射成面向对象的，只需要在</span><span style="font-size:16px">User.java</span><span style="font-size:16px;font-family:宋体">的同级目录下建立一个</span><span style="font-size:16px">User.hbm.xml</span><span style="font-size:16px;font-family:宋体">文件，内容示例如下：</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;?</span><span style="font-family:Consolas;color:#3F7F7F">xml</span><span style="font-family:Consolas"> <span style="color:#7F007F">version</span>=<i><span style="color:#2A00FF">&quot;1.0&quot;</span></i><span style="color:teal">?&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;!</span><span style="font-family:Consolas;color:#3F7F7F">DOCTYPE</span><span style="font-family:Consolas"> <span style="color:teal">hibernate-mapping</span> <span style="color:gray">PUBLIC</span> </span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:teal">&quot;-//Hibernate/Hibernate Mapping DTD 3.0//EN&quot;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:#3F7F5F">&quot;http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd&quot;</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">hibernate-mapping</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">每个</span><span style="font-family:Consolas;color:#3F5FBF">class</span><span style="font-family:宋体;color:#3F5FBF">对应</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">一个持久化</span><span style="font-family:宋体;color:#3F5FBF">对</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">象</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">class</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;com.javaweb.po.User&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- id</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">元素用来定</span><span style="font-family:宋体;color:#3F5FBF">义</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">主</span><span style="font-family:宋体;color:#3F5FBF">键标识</span><span style="font-family:Consolas;color:#3F5FBF">,</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">并指定主</span><span style="font-family:宋体;color:#3F5FBF">键</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">自</span><span style="font-family:宋体;color:#3F5FBF">动递</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">增</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">id</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;id&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">generator</span><span style="font-family:Consolas"> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;identity&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">generator</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">id</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">其他属性</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;username&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;password&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;age&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;int&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;birth&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;date&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">property</span><span style="font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;email&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">property</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">class</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">hibernate-mapping</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">此时配置便完成了，在其他</span><span style="font-size:16px">java</span><span style="font-size:16px;font-family:宋体">文件中引入相应的</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">类文件，就可以以面向对象的方式使用数据了。例如，通常引用到的为</span></p><p style="line-height: normal;"><span style="font-size:16px">import org.hibernate.Session;</span></p><p style="line-height: normal;"><span style="font-size:16px">import org.hibernate.SessionFactory;</span></p><p style="line-height: normal;"><span style="font-size:16px">import org.hibernate.cfg.Configuration;</span></p><p style="line-height: normal;"><span style="font-size:16px">import org.hibernate.Query;</span></p><p style="line-height: normal;"><span style="font-size:16px">import org.hibernate.Session;</span></p><p><span style="font-size:16px;font-family:宋体">等等，非常多，而如果每个</span><span style="font-size:16px">java</span><span style="font-size:16px;font-family:宋体">文件都要引用的话就显得非常累赘，所以通常把一些基础数据库操作封装在</span><span style="font-size:16px">HibernateUtil.java</span><span style="font-size:16px;font-family: 宋体">文件中。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">如果使用了</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">框架，则不需要引入这么多文件，在</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">框架中，直接使用</span><span style="font-size:16px">dao</span><span style="font-size:16px;font-family:宋体">文件就可以了，在</span><span style="font-size:16px">dao</span><span style="font-size:16px;font-family:宋体">文件中引入如下</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">hibernate3.suppor.HibernateDaoSupport</span><span style="font-size:16px;font-family:宋体">即可：</span></p><p><span style="font-size:16px">import org.springframework.orm.hibernate3.support.HibernateDaoSupport;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">与</span><span style="font-size:16px"> Struts 2 </span><span style="font-size:16px;font-family:宋体">的整合其实没什么可讲的，就是简单的把两个的功能叠加在一起，类似于</span><span style="font-size:16px">1+1=2</span><span style="font-size:16px;font-family:宋体">。</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">负责</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">操作，</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">通常分为</span><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">个部分，</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">接口，</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">实现类，</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">工厂类，接口就是声明一些方法，例如</span><span style="font-size:16px">delete</span><span style="font-size:16px;font-family:宋体">，实现类利用</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">的方式去实现这个方法，而工厂类就是简单的</span><span style="font-size:16px">new</span><span style="font-size:16px;font-family:宋体">一个实现类再返回，工厂类示例如下：</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">package</span></strong><span style="font-family: Consolas"> com.javaweb.factory;</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">import</span></strong><span style="font-family: Consolas"> com.javaweb.dao.ProductDao;</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">import</span></strong><span style="font-family: Consolas"> com.javaweb.dao.ProductDaoImpl;</span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;</span></p><p style="line-height: normal;"><strong><span style="font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">class</span></strong><span style="font-family: Consolas"> DaoFactory {</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">static</span></strong><span style="font-family: Consolas"> ProductDao getDaoInstance(){</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-family:Consolas;color:#7F0055">return</span></strong> <strong><span style="font-family:Consolas;color:#7F0055">new</span></strong><span style="font-family: Consolas"> ProductDaoImpl();</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-family: Consolas">}</span></p><p><span style="font-size:16px;font-family:宋体">仅在有很多个</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">的实现类时才能体现工厂类的作用，因为工厂类把这些实现类都封装在了一个</span><span style="font-size:16px">DaoFactory</span><span style="font-size:16px;font-family:宋体">类里面，只需要调用不同的方法即可</span><span style="font-size:16px">new</span><span style="font-size:16px;font-family:宋体">一个不同的实现类。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">五、</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">及</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">与</span><span style="font-size:16px"> Struts 2 </span><span style="font-size:16px;font-family:宋体">的整合</span><span style="font-size:16px">(</span><span style="font-size:16px;font-family:宋体">略</span><span style="font-size:16px">)</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">可以用来管理前端的业务控制器，中间的业务逻辑组件，以及底层的</span><span style="font-size:16px">DAO</span><span style="font-size:16px;font-family:宋体">组件，方便集成各组件，而且可以大大的降低各组件之间的耦合度。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">有如下几个流行的应用：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Ioc(Inversion of Control</span><span style="font-size:16px;font-family:宋体">，控制反转</span><span style="font-size:16px">)</span><span style="font-size:16px;font-family:宋体">，又称为</span><span style="font-size:16px">DI</span><span style="font-size:16px;font-family:宋体">（依赖注入），值的依赖注入和自动装配；</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">AOP</span><span style="font-size:16px;font-family:宋体">（面向切面编程），例如前置通知、后置通知；</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">持久层的封装和事务管理，包括对</span><span style="font-size:16px">JDBC</span><span style="font-size:16px;font-family:宋体">的使用加以封装以及对各种</span><span style="font-size:16px">O/R</span><span style="font-size:16px;font-family:宋体">映射工具的整合；</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">首先要理解这几个术语，什么是</span><span style="font-size:16px">IoC</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">DI</span><span style="font-size:16px;font-family:宋体">？</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; IoC</span><span style="font-size:16px;font-family:宋体">又称为</span><span style="font-size:16px">DI</span><span style="font-size:16px;font-family:宋体">，因为实质是一样的。比如在</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类的某个方法中新建了一个</span><span style="font-size:16px">B</span><span style="font-size:16px;font-family:宋体">类的实例，并调用</span><span style="font-size:16px">B</span><span style="font-size:16px;font-family:宋体">类的方法，则称</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类依赖于</span><span style="font-size:16px">B</span><span style="font-size:16px;font-family:宋体">类，当</span><span style="font-size:16px">B</span><span style="font-size:16px;font-family:宋体">类中的方法修改时，</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类中的调用代码也需要修改。如果要让两者之间低耦合度，可以将在</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类中生成</span><span style="font-size:16px">B</span><span style="font-size:16px;font-family:宋体">类的实例的工作由第三方来完成，比如</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">Bean</span><span style="font-size:16px;font-family:宋体">容器。</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">通过配置文件，生成</span><span style="font-size:16px">B</span><span style="font-size:16px;font-family:宋体">类的实例，然后再注入到</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类中，这样</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类就可以使用了，因此称为依赖注入，然而本来这种信赖关系是</span><span style="font-size:16px">A</span><span style="font-size:16px;font-family:宋体">类来建立的，现在却由</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">bean</span><span style="font-size:16px;font-family:宋体">来管理了，因此又称为控制反转。</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">例如有</span><span style="font-size:16px">Person</span><span style="font-size:16px;font-family:宋体">接口和</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">类，使用</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">类时我们可以每次都</span><span style="font-size:16px">new</span><span style="font-size:16px;font-family:宋体">一个</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">，或者我们把</span><span style="font-size:16px">new Student()</span><span style="font-size:16px;font-family:宋体">放到工厂类中，调用工厂类的方法</span><span style="font-size:16px">Factory.getStudent()</span><span style="font-size:16px;font-family:宋体">如果修改了</span><span style="font-size:16px">Person</span><span style="font-size:16px;font-family:宋体">接口中的方法，那就得修改</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">类的方法，、工厂类</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">每次调用</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">类时都要继承</span><span style="font-size:16px">Person</span><span style="font-size:16px;font-family:宋体">接口，</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><strong><span style="font-size:21px;font-family:宋体">六、Spring + Struts 2 + Hibernate整合开发</span></strong></p><p><span style="font-size:16px">1.</span><span style="font-size:16px;font-family:宋体">搭建</span><span style="font-size:16px">S2SH</span><span style="font-size:16px;font-family:宋体">环境</span></p><p><span style="font-size:16px;font-family:宋体">首先</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.</span><span style="font-size:16px;font-family:宋体">把</span><span style="font-size:16px">Struts 2</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">5</span><span style="font-size:16px;font-family:宋体">个核心</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件加入到</span><span style="font-size:16px">WEB-INF/lib</span><span style="font-size:16px;font-family:宋体">目录下，分别是</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; commons-logging-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; freemarker-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ognl-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struts2-core-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; xwork-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span><span style="font-size:16px;font-family:宋体">（有可能是</span><span style="font-size:16px">xwork-core-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span><span style="font-size:16px;font-family:宋体">）</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">另外，再加入</span><span style="font-size:16px">Struts 2</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">插件，如下</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; struts2-spring-plugin-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">.jar</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2.</span><span style="font-size:16px;font-family:宋体">把</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">的核心</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件加入到</span><span style="font-size:16px">WEB-INF /lib</span><span style="font-size:16px;font-family:宋体">目录下，只有一个</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; spring.jar</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. </span><span style="font-size:16px;font-family:宋体">把</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">的核心</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件加入到</span><span style="font-size:16px">WEB-INF /lib</span><span style="font-size:16px;font-family:宋体">目录下，只有一个</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; hibernate3.jar</span><span style="font-size:16px;font-family:宋体">（</span><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">是版本号）</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4.</span><span style="font-size:16px;font-family:宋体">数据库驱动</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件，如果是用</span><span style="font-size:16px">MySQL</span><span style="font-size:16px;font-family:宋体">数据库，则为</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mysql-connector-java-</span><span style="font-size:16px;font-family:宋体">版本号</span><span style="font-size:16px">-bin.jar</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5. </span><span style="font-size:16px;font-family:宋体">其他，根据需要，加入其他</span><span style="font-size:16px">jar</span><span style="font-size:16px;font-family:宋体">文件</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">其次</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">配置</span><span style="font-size:16px">WEB-INF /web.xml</span><span style="font-size:16px;font-family:宋体">文件，使</span><span style="font-size: 16px">Struts 2</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">Spring</span><span style="font-size:16px;font-family:宋体">生效</span></p><p><span style="font-size:16px;font-family:宋体">配置文件，示例如下</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;?</span><span style="font-family:Consolas;color:#3F7F7F">xml</span><span style="font-family:Consolas"> <span style="color:#7F007F">version</span>=<i><span style="color:#2A00FF">&quot;1.0&quot;</span></i> <span style="color:#7F007F">encoding</span>=<i><span style="color:#2A00FF">&quot;UTF-8&quot;</span></i><span style="color:teal">?&gt;</span></span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">web-app</span><span style="font-family:Consolas"> <span style="color:#7F007F">version</span>=<i><span style="color:#2A00FF">&quot;3.0&quot;</span></i> </span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:#7F007F">xmlns</span>=<i><span style="color:#2A00FF">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></i> </span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:#7F007F">xmlns:xsi</span>=<i><span style="color:#2A00FF">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></i> </span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;&nbsp;&nbsp; <span style="color:#7F007F">xsi:schemaLocation</span>=<i><span style="color:#2A00FF">&quot;http://java.sun.com/xml/ns/javaee </span></i></span></p><p style="line-height: normal;"><i><span style="font-family:Consolas;color:#2A00FF">&nbsp;&nbsp;&nbsp; http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span></i><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!--</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">核心</span><span style="font-family:Consolas;color:#3F5FBF">Filter FilterDispatcher --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">filter</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">核心</span><span style="font-family:Consolas;color:#3F5FBF">Filter</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">的名称</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">filter-name</span><span style="font-family:Consolas;color:teal">&gt;</span><span style="font-family: Consolas">struts2</span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">filter-name</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!--</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">定</span><span style="font-family:宋体;color:#3F5FBF">义</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">核心</span><span style="font-family:Consolas;color:#3F5FBF">Filter</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">的</span><span style="font-family:宋体;color:#3F5FBF">实现类</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">filter-class</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.apache.struts2.dispatcher.FilterDispatcher</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">filter-class</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">filter</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas">&nbsp;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">filter-mapping</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!--</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">核心</span><span style="font-family:Consolas;color:#3F5FBF">Filter</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">的名称</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">filter-name</span><span style="font-family:Consolas;color:teal">&gt;</span><span style="font-family: Consolas">struts2</span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">filter-name</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!--</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">使用</span><span style="font-family:宋体;color:#3F5FBF">该</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">核心</span><span style="font-family:Consolas;color:#3F5FBF">Filter</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">来接受所有的</span><span style="font-family:Consolas;color:#3F5FBF">Web</span><span style="font-family:宋体;color:#3F5FBF">请</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">求</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">url-pattern</span><span style="font-family:Consolas;color:teal">&gt;</span><span style="font-family: Consolas">/*</span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">url-pattern</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">filter-mapping</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:#3F5FBF">&lt;!-- </span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">初始化</span><span style="font-family:Consolas;color:#3F5FBF">Spring</span><span style="font-family:&#39;MS Mincho&#39;;color:#3F5FBF">容器</span><span style="font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">listener</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;</span><span style="font-family:Consolas;color:#3F7F7F">listener-class</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; org.springframework.web.context.ContextLoaderListener</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">listener-class</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">listener</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-family:Consolas;color:teal">&lt;/</span><span style="font-family:Consolas;color:#3F7F7F">web-app</span><span style="font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">跳转到</span><span style="font-size:16px">action</span><span style="font-size:16px;font-family:宋体">的方法：</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">result</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;redirectAction&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">param</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;actionName&quot;</span></i><span style="color:teal">&gt;</span>showpicsya<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">param</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:黑体;color:teal">&lt;/</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">result</span><span style="font-size:19px;font-family:黑体;color:teal">&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><br/></p><p><strong><span style="font-size:20px;font-family:宋体">Tomcat</span></strong><strong><span style="font-size:20px;font-family: 宋体">配置</span></strong></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">会话超时时间：</span></p><p><span style="font-size:16px">\conf\web.xml</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp; &lt;session-config&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;session-timeout&gt;-1&lt;/session-timeout&gt;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp; &lt;/session-config&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">URL</span><span style="font-size:16px;font-family:宋体">中文支持</span><span style="font-size:16px">:</span></p><p><span style="font-size:16px">\conf\server.xml</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp; &lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connectionTimeout=&quot;20000&quot;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; redirectPort=&quot;8443&quot; /&gt;</span></p><p><span style="font-size:16px;font-family:宋体">加入：<span style="color:red">URIEncoding=&quot;utf-8&quot;</span></span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><strong><span style="font-size:21px;font-family:宋体">CKFinder</span></strong><strong><span style="font-size:21px;font-family: 宋体">破解</span></strong></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">CKEditor</span><span style="font-size:16px;font-family:宋体">图片预览文字</span></p><p><span style="font-size:16px">\ckeditor\plugins\image\dialogs\image.js</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">初始化：</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:#BF5F3F">&lt;%@</span><span style="font-size:19px;font-family:黑体"> <span style="color:#3F7F7F">taglib</span> <span style="color:#7F007F">uri</span>=<i><span style="color:#2A00FF">&quot;http://ckeditor.com&quot;</span></i> <span style="color:#7F007F">prefix</span>=<i><span style="color:#2A00FF">&quot;ckeditor&quot;</span></i> <span style="color:#BF5F3F">%&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family:黑体;color:#BF5F3F">&lt;%@</span><span style="font-size:19px;font-family:黑体"> <span style="color:#3F7F7F">taglib</span> <span style="color:#7F007F">uri</span>=<i><span style="color:#2A00FF">&quot;http://ckfinder.com&quot;</span></i> <span style="color:#7F007F">prefix</span>=<i><span style="color:#2A00FF">&quot;ckfinder&quot;</span></i> <span style="color:#BF5F3F">%&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family:黑体;color:#3F5FBF">&lt;!-- 整合CKFinder和CKEditor --&gt;</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">ckfinder:setupCKEditor</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">basePath</span>=<i><span style="color:#2A00FF">&quot;/zollty/CKFinderJava/userfiles/&quot;</span></i> <span style="color:#7F007F">editor</span>=<i><span style="color:#2A00FF">&quot;editor1&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">ckeditor:replace</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">replace</span>=<i><span style="color:#2A00FF">&quot;editor1&quot;</span></i> <span style="color:#7F007F">basePath</span>=<i><span style="color:#2A00FF">&quot;/zollty/CKFinderJava/userfiles/&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">方法二：</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F;background:lightgrey;background:lightgrey">script</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;text/javascript&quot;</span></i> <span style="color:#7F007F">src</span>=<i><span style="color:#2A00FF">&quot;/zollty/ckeditor/ckeditor.js&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F;background:lightgrey;background:lightgrey">script</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">script</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;text/javascript&quot;</span></i> <span style="color:#7F007F">src</span>=<i><span style="color:#2A00FF">&quot;/zollty/ckfinder/ckfinder.js&quot;</span></i><span style="color:teal">&gt;&lt;/</span><span style="color:#3F7F7F">script</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:#3F5FBF">&lt;!-- 整合CKFinder和CKEditor --&gt;</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:teal">&lt;</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F">script</span><span style="font-size:19px;font-family:黑体"> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;text/javascript&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><strong><span style="font-size:19px;font-family:黑体;color:#7F0055;background:white;background:white">var </span></strong><span style="font-size: 19px;font-family: 黑体;background: white">editor = CKEDITOR.replace( &#39;editor1&#39;,</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体;background: white">&nbsp;&nbsp; {</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体;background: white">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; toolbar : &#39;Basic&#39;</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体;background: white">&nbsp;&nbsp; });</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: 黑体;background: white">&nbsp;&nbsp; CKFinder.SetupCKEditor( editor, &#39;/zollty/CKFinderJava/userfiles/&#39; );</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: 黑体;color:teal;background:white;background:white">&lt;/</span><span style="font-size:19px;font-family:黑体;color:#3F7F7F;background:white;background:white">script</span><span style="font-size:19px;font-family:黑体;color:teal;background:white;background:white">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:16px">DateUtil.DateToString(user.getBirthday(),&quot;yyyy-MM-dd&quot;);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:16px">import java.text.DateFormat;</span></p><p style="line-height: normal;"><span style="font-size:16px">import java.text.SimpleDateFormat;</span></p><p style="line-height: normal;"><span style="font-size:16px">import java.util.Date;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:16px">public class DateUtil {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static Date StringToDate(String dateString,String formatString){</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DateFormat fm = new SimpleDateFormat(formatString);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Date date = null;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; date = fm.parse(dateString);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (java.text.ParseException e) {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // TODO Auto-generated catch block</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //e.printStackTrace();</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } // Thu Jan 18 00:00:00 CST 2007</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return date;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (Exception e) {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // TODO: handle exception</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public static String DateToString(Date date,String formatString){</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; try {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DateFormat fm = new SimpleDateFormat(formatString);</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String str = new String();</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; str = fm.format(date);&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return str;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } catch (Exception e) {</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // TODO: handle exception</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return null;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size:16px">}</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><br/></p><p><strong><span style="font-size:20px;font-family:宋体">JSP</span></strong><strong><span style="font-size:20px;font-family: 宋体">国际化</span></strong></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">src</span><span style="font-size:16px;font-family:宋体">目录下建立</span><span style="font-size:16px">ApplicationResources.properties</span><span style="font-size:16px;font-family:宋体">文件，内容如下：</span></p><p><span style="font-size: 19px;font-family: Consolas">title=</span><span style="font-size:19px;font-family:Consolas;color:#2A00FF">\u7528\u6237\u6CE8\u518C</span></p><p><span style="font-size: 19px;font-family: Consolas">welcome=</span><span style="font-size:19px;font-family:Consolas;color:#2A00FF">\u6B22\u8FCE\u767B\u5F55\uFF01</span></p><p><span style="font-size:16px;font-family:宋体">再建一些形如</span><span style="font-size:16px">ApplicationResources_cn.properties</span><span style="font-size:16px;font-family:宋体">的文件</span><span style="font-size:16px">,cn</span><span style="font-size:16px;font-family:宋体">代表中国，例如</span><span style="font-size:16px">de</span><span style="font-size:16px;font-family:宋体">则代表德国</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">jsp</span><span style="font-size:16px;font-family:宋体">中引入：</span></p><p><span style="font-size:16px">&lt;%@ taglib prefix=&quot;fmt&quot; uri=&quot;http://java.sun.com/jsp/jstl/fmt&quot; %&gt;</span></p><p><span style="font-size:16px;font-family:宋体">再设置：</span></p><p><span style="font-size:16px">&lt;fmt:setBundle basename=&quot;ApplicationResources&quot; scope=&quot;session&quot;/&gt;</span></p><p><span style="font-size:16px;font-family:宋体">就可实现本地化了，例如打印上面文件中的</span><span style="font-size:16px">title</span><span style="font-size:16px;font-family:宋体">的内容：</span></p><p><span style="font-size:16px">&lt;fmt:message key=&quot;title&quot;&gt;&lt;/fmt:message&gt;</span></p><p><span style="font-size:16px;font-family:宋体">改变浏览器的语言环境即可显示不同国家的效果。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><strong><span style="font-size:20px;font-family:宋体">JDBC</span></strong><strong><span style="font-size:20px;font-family: 宋体">用配置文件连接数据库</span></strong></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">配置文件为：</span><span style="font-size:16px">src/db.properties</span><span style="font-size:16px;font-family:宋体">，其内容如下</span></p><p><span style="font-size: 14px;font-family: Consolas">driver_class=</span><span style="font-size: 14px;font-family:Consolas;color:#2A00FF">com.mysql.jdbc.Driver</span></p><p><span style="font-size: 14px;font-family: Consolas">url=</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">jdbc\:mysql\://localhost\:3306/user</span></p><p><span style="font-size: 14px;font-family: Consolas">username=</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">root</span></p><p><span style="font-size: 14px;font-family: Consolas">password=</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">a123456</span></p><p>&nbsp;</p><p><span style="font-size:16px;font-family:宋体">下面是连接数据库的程序：</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">static</span></strong><span style="font-size: 14px;font-family: Consolas"> Connection getConnection(){</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Connection connection = </span><strong><span style="font-size:14px;font-family: Consolas;color:#7F0055">null</span></strong><span style="font-size: 14px;font-family: Consolas">;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">try</span></strong><span style="font-size: 14px;font-family: Consolas">{</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Properties properties = <i>getProperties</i>();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">driver_class</span></i><span style="font-size: 14px;font-family: Consolas"> = properties.getProperty(</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">&quot;driver_class&quot;</span><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">url</span></i><span style="font-size: 14px;font-family: Consolas"> = properties.getProperty(</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">&quot;url&quot;</span><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">username</span></i><span style="font-size: 14px;font-family: Consolas"> = properties.getProperty(</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">&quot;username&quot;</span><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">password</span></i><span style="font-size: 14px;font-family: Consolas"> = properties.getProperty(</span><span style="font-size:14px;font-family:Consolas;color:#2A00FF">&quot;password&quot;</span><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Class.<i>forName</i>(</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">driver_class</span></i><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; connection = DriverManager.<i>getConnection</i>(</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">url</span></i><span style="font-size: 14px;font-family: Consolas">,</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">username</span></i><span style="font-size: 14px;font-family: Consolas">,</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">password</span></i><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">catch</span></strong><span style="font-size: 14px;font-family: Consolas"> (Exception e) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 14px;font-family: Consolas"> connection;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">static</span></strong><span style="font-size: 14px;font-family: Consolas"> Properties getProperties(){</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Properties properties = </span><strong><span style="font-size:14px;font-family: Consolas;color:#7F0055">new</span></strong><span style="font-size: 14px;font-family: Consolas"> Properties();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">try</span></strong><span style="font-size: 14px;font-family: Consolas"> {</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FileInputStream fileInputStream = </span><strong><span style="font-size:12px;font-family: Consolas;color:#7F0055">new</span></strong><span style="font-size: 12px;font-family: Consolas"> FileInputStream(</span><span style="font-size:12px;font-family:Consolas;color:#2A00FF">&quot;src/db.properties&quot;</span><span style="font-size: 12px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; properties.load(fileInputStream);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String driver_class = properties.getProperty(</span><span style="font-size: 14px;font-family:Consolas;color:#2A00FF">&quot;driver_class&quot;</span><span style="font-size: 14px;font-family: Consolas">);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">out</span></i><span style="font-size: 14px;font-family: Consolas">.println(driver_class);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">catch</span></strong><span style="font-size: 14px;font-family: Consolas"> (FileNotFoundException e) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">catch</span></strong><span style="font-size: 14px;font-family: Consolas"> (IOException e) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.printStackTrace();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 14px;font-family: Consolas"> properties;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size:14px;font-family:宋体">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">static</span></strong> <strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">void</span></strong><span style="font-size: 14px;font-family: Consolas"> closeConn(Connection conn) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">try</span></strong><span style="font-size: 14px;font-family: Consolas"> {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 14px;font-family: Consolas">(conn!=</span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">null</span></strong><span style="font-size: 14px;font-family: Consolas">)</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.close();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">catch</span></strong><span style="font-size: 14px;font-family: Consolas"> (Exception e) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; e.<span style="background:lightgrey;background:lightgrey">printStackTrace</span>();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp; &nbsp;</span></p><p><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">的配置之</span><span style="font-size:16px">Configuration</span><span style="font-size:16px;font-family:宋体">对象和</span><span style="font-size:16px">SessionFactory</span><span style="font-size:16px;font-family:宋体">对象：</span></p><p><span style="font-size:16px;font-family:宋体">通常写在</span><span style="font-size:16px">HibernateSessionFactory.java</span><span style="font-size:16px;font-family:宋体">中：</span></p><p style="line-height: normal;"><span style="font-size:16px">private static org.hibernate.cfg.Configuration configuration = new Configuration();</span></p><p style="line-height: normal;"><span style="font-size:16px">private static org.hibernate.SessionFactory sessionFactory;</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:16px">private static String configFile = &quot;/hibernate.cfg.xml;</span></p><p style="line-height: normal;"><span style="font-size:16px">configuration.configure(configFile);</span></p><p style="line-height: normal;"><span style="font-size:16px">sessionFactory = configuration.buildSessionFactory();</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">创建</span><span style="font-size:16px">Session:</span></p><p style="text-indent: 32px; line-height: normal;"><span style="font-size:16px">Session session1 = sessionFactory.openSession() ; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp; &nbsp; &nbsp; //&nbsp; Session session2 = sessionFactory.getCurrentSession() ;</span></p><p><span style="font-size:16px;font-family:宋体">官方的写法</span><span style="font-size:16px">:</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">static</span></strong><span style="font-size: 14px;font-family: Consolas"> Session getSession() </span><strong><span style="font-size:14px;font-family: Consolas;color:#7F0055">throws</span></strong><span style="font-size: 14px;font-family: Consolas"> HibernateException {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session session = (Session) </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0;background:lightgrey;background:lightgrey">threadLocal</span></i><span style="font-size: 14px;font-family: Consolas">.get();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 14px;font-family: Consolas"> (session == </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">null</span></strong><span style="font-size: 14px;font-family: Consolas"> || !session.isOpen()) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">if</span></strong><span style="font-size: 14px;font-family: Consolas"> (</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">sessionFactory</span></i><span style="font-size: 14px;font-family: Consolas"> == </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">null</span></strong><span style="font-size: 14px;font-family: Consolas">) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>rebuildSessionFactory</i>();</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session = (</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">sessionFactory</span></i><span style="font-size: 14px;font-family: Consolas"> != </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">null</span></strong><span style="font-size: 14px;font-family: Consolas">) ? </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">sessionFactory</span></i><span style="font-size: 14px;font-family: Consolas">.openSession()</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; : </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">null</span></strong><span style="font-size: 14px;font-family: Consolas">;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0;background:lightgrey;background:lightgrey">threadLocal</span></i><span style="font-size: 14px;font-family: Consolas">.set(session);</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">return</span></strong><span style="font-size: 14px;font-family: Consolas"> session;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Transaction</span><span style="font-size:16px;font-family:宋体">的用法：</span></p><p style="text-indent: 0px; "><span style="font-size: 16px; text-indent: 48px;"><span style="font-family:宋体">&nbsp; </span></span><span style="font-size: 16px; line-height: normal; text-indent: 48px;">Transaction trans = session1.beginTransaction();</span></p><p style="text-indent: 0px; "><span style="font-size: 16px; line-height: normal; text-indent: 48px;">&nbsp; &nbsp; &nbsp; &nbsp;trans.begin();</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trans.commit();</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">遇到异常：</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; trans.rollback();</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">持久化状态：</span></p><p style="text-indent: 48px; line-height: normal;"><span style="font-size:16px">session1.save(obj);</span><span style="font-size:16px;font-family:宋体">可使对象由临时状态，转换成持久化状态。</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session1.delete();</span><span style="font-size:16px;font-family:宋体">同上相反，把对象欢迎成临时状态</span></p><p style="text-indent: 48px; line-height: normal;"><span style="font-size:16px">session1.close();</span><span style="font-size:16px;font-family:宋体">可使持久化状态称为游离状态。</span></p><p style="line-height: normal;"><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session1.update();</span><span style="font-size:16px;font-family:宋体">同上相反，可使游离状态变成持久化状态。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><strong><span style="font-size:21px;font-family:宋体">Hibernate</span></strong><strong><span style="font-size:21px;font-family: 宋体">缓存</span></strong></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">一级缓存是</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">类的缓存，是自动缓存的，无需配置。</span></p><p><span style="font-size:16px;font-family:宋体">对于一级缓存：</span></p><p style="margin-left:48px"><span style="font-size:16px;font-family:宋体">（</span><span style="font-size:16px">1</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">save</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">update</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">saveOrupdate</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">load</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">get</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">list</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">iterate</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">lock</span><span style="font-size:16px;font-family:宋体">方法都会向缓存中存对象</span><span style="font-size:16px">. </span></p><p style="margin-left:48px"><span style="font-size:16px;font-family:宋体">（</span><span style="font-size:16px">2</span><span style="font-size:16px;font-family:宋体">）可以从缓存中读数据的只有：</span><span style="font-size:16px"> get</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">load</span><span style="font-size:16px;font-family:宋体">、</span><span style="font-size:16px">iterate </span></p><p style="margin-left:48px"><span style="font-size:16px;font-family:宋体">（</span><span style="font-size:16px">3</span><span style="font-size:16px;font-family:宋体">）</span><span style="font-size:16px">Query</span><span style="font-size:16px;font-family:宋体">对象默认情况下不读缓存，如果要使其支持缓存（也就是</span><span style="font-size:16px">new</span><span style="font-size:16px;font-family:宋体">两个相同的</span><span style="font-size:16px">Query</span><span style="font-size:16px;font-family:宋体">时，第二次不再去执行</span><span style="font-size:16px">sql</span><span style="font-size:16px;font-family:宋体">语句），则要通过语法：</span><span style="font-size:16px"> </span></p><p><span style="font-size:16px">query.setCacheable(true)</span><span style="font-size:16px;font-family:宋体">；（并且要在</span><span style="font-size:16px">hibernate.cfg.xml</span><span style="font-size:16px;font-family: 宋体">中配置：</span></p><p><span style="font-size:16px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:16px;font-family:Consolas;color:#3F7F7F;background:lightgrey;background:lightgrey">property</span><span style="font-size:16px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;hibernate.cache.use_query_cache&quot;</span></i><span style="color:teal">&gt;</span>true<span style="color:teal">&lt;/</span><span style="color:#3F7F7F;background:lightgrey;background:lightgrey">property</span><span style="color:teal">&gt;</span></span><span style="font-size:16px;font-family:宋体">）</span></p><p><span style="font-size:16px">PS</span><span style="font-size:16px;font-family:宋体">：</span><span style="font-size:16px">list</span><span style="font-size:16px;font-family:宋体">方法好像有点怪，其存入缓存中的数据无法</span><span style="font-size:16px">clear</span><span style="font-size:16px;font-family:宋体">？</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">注意事项：</span></p><p style="text-indent:48px"><span style="font-size:16px">1.Session </span><span style="font-size:16px;font-family:宋体">级别的缓存，它同</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">邦定。它的生命周期和</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">相同。</span><span style="font-size:16px">Session</span><span style="font-size:16px;font-family:宋体">消毁，它也同时消毁；管理一级缓存，一级缓存无法取消，用两个方法管理，</span><span style="font-size:16px">clear(),evict()</span></p><p style="text-indent:48px"><span style="font-size:16px">2.</span><span style="font-size:16px;font-family:宋体">两个</span><span style="font-size:16px">session </span><span style="font-size:16px;font-family:宋体">不能共享一级缓存，因它会伴随</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">的生命周期的创建和消毁；</span></p><p style="text-indent:48px"><span style="font-size:16px">3.Session</span><span style="font-size:16px;font-family:宋体">缓存是实体级别的缓存</span> <span style="font-size:16px;font-family:宋体">，就是只有在查询对象级别的时候才使用</span> <span style="font-size:16px;font-family:宋体">，如果使用</span><span style="font-size:16px">HQL</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">SQL</span><span style="font-size:16px;font-family:宋体">是查询属性级别</span> <span style="font-size:16px;font-family:宋体">的，是不使用一级缓存的！切记！！！！</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">查询单个对象的两种方法：</span></p><p style="text-indent: 48px"><span style="font-size: 14px;font-family: Consolas">User <span style="text-decoration:underline;">user1</span> = (User) session.load(User.</span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">class</span></strong><span style="font-size: 14px;font-family: Consolas">, 1);</span></p><p style="text-indent:48px"><span style="font-size: 14px;font-family: Consolas">User <span style="text-decoration:underline;">user2</span> = (User) session.<span style="background:lightgrey;background:lightgrey">get</span>(User.</span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">class</span></strong><span style="font-size: 14px;font-family: Consolas">, 53);</span></p><p><span style="font-size:16px;font-family:宋体">前一种</span><span style="font-size:16px">load</span><span style="font-size:16px;font-family:宋体">的时候不会执行</span><span style="font-size:16px">sql</span><span style="font-size:16px;font-family:宋体">语句，</span><span style="font-size:16px">user1</span><span style="font-size:16px;font-family:宋体">是空对象，只有用到</span><span style="font-size:16px">user1</span><span style="font-size:16px;font-family:宋体">时才会去查询，第二种</span><span style="font-size:16px">get</span><span style="font-size:16px;font-family:宋体">方法，就是直接查询，把结果赋值给</span><span style="font-size:16px">user2</span><span style="font-size:16px;font-family:宋体">。两种方式都会一级缓存。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">查询多个对象时，有两种方法：</span></p><p><span style="font-size:16px;font-family:宋体">第一种（</span><span style="font-size:16px">List</span><span style="font-size:16px;font-family:宋体">方法）：</span></p><p style="text-indent: 0px; "><span style="text-indent: 48px; font-size: 16px; line-height: 28.7999992370605px;"><span style="font-family:宋体">&nbsp; &nbsp;&nbsp;</span></span><span style="line-height: normal; text-indent: 48px; font-size: 14px; font-family: Consolas;">List&lt;User&gt; list = <span style="text-decoration:underline;">query.list()</span>;</span><a style="line-height: normal; text-indent: 48px; background-color: rgb(199, 237, 204);" name="OLE_LINK4"></a><a style="line-height: normal; text-indent: 48px; background-color: rgb(199, 237, 204);" name="OLE_LINK3"></a><span style="line-height: normal; text-indent: 48px; font-size: 14px; font-family: Consolas; color: rgb(63, 127, 95);">//</span><span style="line-height: normal; text-indent: 48px; font-size: 14px; font-family: 宋体; color: rgb(63, 127, 95);">第</span><span style="line-height: normal; text-indent: 48px; font-size: 14px; font-family: &#39;MS Mincho&#39;; color: rgb(63, 127, 95);">一次</span><span style="line-height: normal; text-indent: 48px; font-size: 14px; font-family: 宋体; color: rgb(63, 127, 95);">查询</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list = <span style="text-decoration:underline;">query.list()</span>; </span><span style="font-size:14px;font-family:Consolas;color:#3F7F5F">//</span><span style="font-size:14px;font-family:宋体;color:#3F7F5F">还</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">会去</span><span style="font-size:14px;font-family:宋体;color:#3F7F5F">查询</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">一次，但是将</span><span style="font-size:14px;font-family:宋体;color:#3F7F5F">结</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">果全部</span><span style="font-size:14px;font-family:宋体;color:#3F7F5F">缓</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">存到</span><span style="font-size:14px;font-family: Consolas;color:#3F7F5F">list</span><span style="font-size:14px;font-family: &#39;MS Mincho&#39;;color:#3F7F5F">中</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">for</span></strong><span style="font-size: 14px;font-family: Consolas"> (User user : list) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">out</span></i><span style="font-size: 14px;font-family: Consolas">.<span style="background:lightgrey;background:lightgrey">println</span>(user);</span> <span style="font-size:14px;font-family: Consolas;color:#3F7F5F">//</span><span style="font-size:14px;font-family: 宋体;color:#3F7F5F">直接从缓存中取</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size:16px;font-family:宋体">第二种（</span><span style="font-size:16px">Iterate</span><span style="font-size:16px;font-family:宋体">方法）</span></p><p style="text-indent: 0px; line-height: normal;"><span style="text-indent: 48px; font-size: 16px; line-height: 28.7999992370605px;"><span style="font-family:宋体">&nbsp; &nbsp;&nbsp;</span></span><span style="text-indent: 48px; text-decoration: underline; font-size: 14px; font-family: Consolas;">Iterator</span><span style="text-indent: 48px; font-size: 14px; font-family: Consolas;"> list = query.iterate(); </span><span style="text-indent: 48px; font-size: 14px; font-family: Consolas; color: rgb(63, 127, 95);">//</span><span style="text-indent: 48px; font-size: 14px; font-family: &#39;MS Mincho&#39;; color: rgb(63, 127, 95);">只</span><span style="text-indent: 48px; font-size: 14px; font-family: 宋体; color: rgb(63, 127, 95);">查询</span><span style="text-indent: 48px; font-size: 14px; font-family: Consolas; color: rgb(63, 127, 95);">id</span><span style="text-indent: 48px; font-size: 14px; font-family: &#39;MS Mincho&#39;; color: rgb(63, 127, 95);">，而不是把所有</span><span style="text-indent: 48px; font-size: 14px; font-family: 宋体; color: rgb(63, 127, 95);">值</span><span style="text-indent: 48px; font-size: 14px; font-family: &#39;MS Mincho&#39;; color: rgb(63, 127, 95);">都</span><span style="text-indent: 48px; font-size: 14px; font-family: 宋体; color: rgb(63, 127, 95);">查</span><span style="text-indent: 48px; font-size: 14px; font-family: &#39;MS Mincho&#39;; color: rgb(63, 127, 95);">出</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; list = query.iterate(); </span><span style="font-size:14px;font-family: Consolas;color:#3F7F5F">//</span><span style="font-size:14px;font-family: 宋体;color:#3F7F5F">还</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">会去</span><span style="font-size:14px;font-family:宋体;color:#3F7F5F">查询</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">一次</span><span style="font-size:14px;font-family: Consolas;color:#3F7F5F">id</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:14px;font-family:Consolas;color:#7F0055">while</span></strong><span style="font-size: 14px;font-family: Consolas"> (list.hasNext()) {</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; System.</span><i><span style="font-size:14px;font-family:Consolas;color:#0000C0">out</span></i><span style="font-size: 14px;font-family: Consolas">.println(list.next()); </span><span style="font-size:14px;font-family:Consolas;color:#3F7F5F">//</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">每次都要用</span><span style="font-size:14px;font-family:Consolas;color:#3F7F5F">sql</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">去</span><span style="font-size:14px;font-family:宋体;color:#3F7F5F">查询</span><span style="font-size:14px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">指定</span><span style="font-size:14px;font-family: Consolas;color:#3F7F5F">id</span><span style="font-size:14px;font-family: &#39;MS Mincho&#39;;color:#3F7F5F">的</span><span style="font-size: 14px;font-family:宋体;color:#3F7F5F">记录</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">可以看出，其实</span><span style="font-size:16px">iterate</span><span style="font-size:16px;font-family:宋体">的效率很低，但是</span><span style="font-size:16px">list</span><span style="font-size:16px;font-family:宋体">占用内存较大。所以一般用</span><span style="font-size:16px">list</span><span style="font-size:16px;font-family:宋体">，并且数据量大时一定要配合用分页查询（否则不能用</span><span style="font-size:16px">list</span><span style="font-size:16px;font-family:宋体">）。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">另外注意，在增删改时涉及到事务</span><span style="font-size:16px">(Transaction)</span><span style="font-size:16px;font-family:宋体">，当事务没有</span><span style="font-size:16px">commit</span><span style="font-size:16px;font-family:宋体">时，所有的增删改的数据都是存在代理那里的，实际上这也是一种缓存。例如要</span><span style="font-size:16px">save</span><span style="font-size:16px;font-family:宋体">一千万个对象，那么肯定会塞满缓存，一般是每</span><span style="font-size:16px">save</span><span style="font-size:16px;font-family:宋体">二十个对象就</span><span style="font-size:16px">flush+clear</span><span style="font-size:16px;font-family:宋体">，然后再继续。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><br/></p><p><span style="font-size:16px;font-family:宋体">二级缓存是</span><span style="font-size:16px">sessionFactory</span><span style="font-size: 16px;font-family:宋体">下的缓存，各个</span><span style="font-size:16px">session</span><span style="font-size:16px;font-family:宋体">都共享缓存，需要配置插件。一般用</span><span style="font-size:16px">hibernate</span><span style="font-size:16px;font-family:宋体">自带的这个</span><span style="font-size: 16px">ehcache</span><span style="font-size:16px;font-family:宋体">，需要引入下面这个包：</span></p><p><span style="font-size:16px">ehcache-1.2.3.jar</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">首先在</span><a name="OLE_LINK5"></a><span style="font-size:16px">hibernate.cfg.xml</span><span style="font-size:16px;font-family:宋体">中配置：</span></p><p style="margin-left: 13px; line-height: normal;"><span style="font-size: 14px;"><span style="font-family: Consolas; color: teal;">&lt;</span><span style="font-family: Consolas; color: rgb(63, 127, 127); background: rgb(211, 211, 211);">property</span><span style="font-family: Consolas;"> <span style="color: rgb(127, 0, 127);">name</span>=<i><span style="color: rgb(42, 0, 255);">&quot;hibernate.cache.provider_class&quot;</span></i><span style="color: teal;">&gt;</span>org.hibernate.cache.EhCacheProvider<span style="color: teal;">&lt;/</span><span style="color: rgb(63, 127, 127); background: rgb(211, 211, 211);">property</span><span style="color: teal;">&gt;</span></span></span></p><p style="margin-left: 13px; line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; font-family: Consolas; color: teal;">&lt;</span><span style="font-size: 12px; font-family: Consolas; color: rgb(63, 127, 127);">property</span><span style="font-size: 12px; font-family: Consolas;"> <span style="font-size: 14px; color: rgb(127, 0, 127);">name</span>=<i><span style="font-size: 14px; color: rgb(42, 0, 255);">&quot;hibernate.cache.use_second_level_cache&quot;</span></i><span style="font-size: 14px; color: teal;">&gt;</span>true<span style="font-size: 14px; color: teal;">&lt;/</span><span style="font-size: 14px; color: rgb(63, 127, 127);">property</span><span style="font-size: 14px; color: teal;">&gt;</span></span></span></p><p style="margin-left: 13px; line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; font-family: Consolas; color: teal;">&lt;</span><span style="font-size: 12px; font-family: Consolas; color: rgb(63, 127, 127);">property</span><span style="font-size: 12px; font-family: Consolas;"> <span style="font-size: 14px; color: rgb(127, 0, 127);">name</span>=<i><span style="font-size: 14px; color: rgb(42, 0, 255);">&quot;hibernate.cache.use_query_cache&quot;</span></i><span style="font-size: 14px; color: teal;">&gt;</span>true<span style="font-size: 14px; color: teal;">&lt;/</span><span style="font-size: 14px; color: rgb(63, 127, 127);">property</span><span style="font-size: 14px; color: teal;">&gt;</span></span></span></p><p style="margin-left: 13px; line-height: normal;"><span style="font-size: 14px;"><span style="font-size: 12px; font-family: Consolas; color: teal;">&lt;</span><span style="font-size: 12px; font-family: Consolas; color: rgb(63, 127, 127);">property</span><span style="font-size: 12px; font-family: Consolas;"> <span style="font-size: 14px; color: rgb(127, 0, 127);">name</span>=<i><span style="font-size: 14px; color: rgb(42, 0, 255);">&quot;current_session_context_class&quot;</span></i><span style="font-size: 14px; color: teal;">&gt;</span>thread<span style="font-size: 14px; color: teal;">&lt;/</span><span style="font-size: 14px; color: rgb(63, 127, 127);">property</span><span style="font-size: 14px; color: teal;">&gt;</span></span></span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">在</span><span style="font-size:16px">src</span><span style="font-size:16px;font-family:宋体">目录下新建</span><span style="font-size:16px">ehcache.xml</span><span style="font-size:16px;font-family:宋体">，这个是可选的，在这个文件中可以自定义</span><span style="font-size:16px">cache</span><span style="font-size:16px;font-family:宋体">的参数，例如下面的文件中自定义了一个</span><span style="font-size:16px">name</span><span style="font-size:16px;font-family:宋体">为</span><span style="font-size:16px">userCache</span><span style="font-size:16px;font-family:宋体">的配置：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:teal">&lt;?</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">xml</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">version</span>=<i><span style="color:#2A00FF">&quot;1.0&quot;</span></i> <span style="color:#7F007F">encoding</span>=<i><span style="color:#2A00FF">&quot;UTF-8&quot;</span></i><span style="color:teal">?&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">ehcache</span><span style="font-size:14px;font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">diskStore</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">path</span>=<i><span style="color:#2A00FF">&quot;java.io.tmdir&quot;</span></i><span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">defaultCache</span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">maxElementsInMemory</span>=<i><span style="color:#2A00FF">&quot;10000&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">eternal</span>=<i><span style="color:#2A00FF">&quot;false&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">overflowToDisk</span>=<i><span style="color:#2A00FF">&quot;true&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">timeToIdleSeconds</span>=<i><span style="color:#2A00FF">&quot;300&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">timeToLiveSeconds</span>=<i><span style="color:#2A00FF">&quot;600&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">diskPersistent</span>=<i><span style="color:#2A00FF">&quot;false&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">memoryStoreEvictionPolicy</span>=<i><span style="color:#2A00FF">&quot;LRU&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">cache</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;userCache&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">maxElementsInMemory</span>=<i><span style="color:#2A00FF">&quot;5000&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">eternal</span>=<i><span style="color:#2A00FF">&quot;false&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">overflowToDisk</span>=<i><span style="color:#2A00FF">&quot;true&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">timeToIdleSeconds</span>=<i><span style="color:#2A00FF">&quot;300&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">timeToLiveSeconds</span>=<i><span style="color:#2A00FF">&quot;600&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">diskPersistent</span>=<i><span style="color:#2A00FF">&quot;false&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: #7F007F">memoryStoreEvictionPolicy</span>=<i><span style="color:#2A00FF">&quot;LRU&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:teal">&lt;/</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">ehcache</span><span style="font-size:14px;font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">可以为每个</span><span style="font-size:16px">entity</span><span style="font-size:16px;font-family:宋体">配置二级缓存：</span></p><p><span style="font-size:16px;font-family:宋体">比如在</span><span style="font-size:16px">User.hbm.xml</span><span style="font-size: 16px;font-family:宋体">中，做如下设置：</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><span style="font-size:14px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">class</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;User&quot;</span></i> <span style="color:#7F007F">table</span>=<i><span style="color:#2A00FF">&quot;t_user&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="font-size: 14px;font-family:Consolas;color:#3F5FBF">&nbsp;&lt;cache usage=&quot;nonstrict-read-write&quot; region=&quot;userCache&quot;/&gt;</span></p><p style="line-height: normal;"><span style="font-size:14px;font-family: Consolas;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:14px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">id</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;id&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;java.lang.Integer&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:14px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">column</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;id&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:14px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">generator</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;sequence&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; </span><span style="font-size: 14px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">param</span><span style="font-size:14px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;sequence&quot;</span></i><span style="color:teal">&gt;</span>SEQ_ID_ALL<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">param</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:14px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">generator</span><span style="font-size:14px;font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-size: 14px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:14px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:14px;font-family:Consolas;color:#3F7F7F">id</span><span style="font-size:14px;font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">那个</span><span style="font-size:16px">cache</span><span style="font-size:16px;font-family:宋体">标签即给</span><span style="font-size:16px">User</span><span style="font-size:16px;font-family:宋体">设置缓存，必须放在首位（紧跟</span><span style="font-size:16px">class</span><span style="font-size:16px;font-family:宋体">标签）</span><span style="font-size:16px">,</span><span style="font-size:16px;font-family:宋体">其属性</span><span style="font-size:16px">region</span><span style="font-size:16px;font-family:宋体">指定了缓存的配置，这里其值是</span><span style="font-size:16px">userCache</span><span style="font-size:16px;font-family:宋体">，对应</span><span style="font-size:16px">ehcache</span><span style="font-size:16px;font-family:宋体">中的配置。也可以在</span><span style="font-size:16px">hibernate.cfg.xml</span><span style="font-size:16px;font-family: 宋体">中配置：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">class-cache</span><span style="font-size:16px;font-family:Consolas"> <span style="color:#7F007F">usage</span>=<i><span style="color:#2A00FF">&quot;nonstrict-read-write&quot;</span></i> </span><span style="font-size:16px;font-family:Consolas;color:#7F007F">region</span><span style="font-size: 16px;font-family: Consolas">=</span><i><span style="font-size:16px;font-family:Consolas;color:#2A00FF">&quot;</span></i><i><span style="font-size:16px;font-family:Consolas;color:#2A00FF">userCache</span></i><i><span style="font-size: 16px;font-family:Consolas;color:#2A00FF">&quot;</span></i><span style="font-size:16px;font-family:Consolas"> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;com.travelsky.hibc.entity.User&quot;</span></i><span style="color:teal">/&gt;</span></span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">对于以上配置中的</span><span style="font-size:16px">usage</span><span style="font-size:16px;font-family:宋体">，有</span><span style="font-size:16px">nonstrict-read-write</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">read-write</span><span style="font-size:16px;font-family:宋体">，</span><span style="font-size:16px">read-only</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">transactional</span><span style="font-size:16px;font-family:宋体">四种，关于这四种事务隔离级别的描述如下：</span></p><p><span style="font-size:16px;font-family:宋体">　　事务型：仅仅在托管环境中适用。它提供了</span><span style="font-size:16px">Repeatable Read</span><span style="font-size:16px;font-family:宋体">事务隔离级别。对于经常被读但很少修改的数据，可以采用这种隔离类型，因为它可以防止脏读和不可重复读这类的并发问题。</span></p><p><span style="font-size:16px">&nbsp;</span><span style="font-size:16px;font-family:宋体">　　读写型：提供了</span><span style="font-size:16px">Read Committed</span><span style="font-size:16px;font-family:宋体">事务隔离级别。仅仅在非集群的环境中适用。对于经常被读但很少修改的数据，可以采用这种隔离类型，因为它可以防止脏读这类的并发问题。</span></p><p><span style="font-size:16px">&nbsp;</span><span style="font-size:16px;font-family:宋体">　　非严格读写型：不保证缓存与数据库中数据的一致性。如果存在两个事务同时访问缓存中相同数据的可能，必须为该数据配置一个很短的数据过期时间，从而尽量避免脏读。对于极少被修改，并且允许偶尔脏读的数据，可以采用这种并发访问策略。</span></p><p><span style="font-size:16px">&nbsp;</span><span style="font-size:16px;font-family:宋体">　　只读型：对于从来不会修改的数据，如参考数据，可以使用这种并发访问策略。</span></p><p><span style="font-size:16px">&nbsp;</span><span style="font-size:16px;font-family:宋体">　　事务型并发访问策略是事务隔离级别最高，只读型的隔离级别最低。事务隔离级别越高，并发性能就越低。（一般用“非严格读写型”甚至“只读型”）</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">使用方法（调用</span><span style="font-size:16px">Query</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">setCacheable(true)</span><span style="font-size:16px;font-family:宋体">方法），例如：</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp; </span><strong><span style="font-size:12px;font-family:Consolas;color:#7F0055">public</span></strong> <strong><span style="font-size:12px;font-family:Consolas;color:#7F0055">void</span></strong><span style="font-size: 12px;font-family: Consolas"> QueryCache() {</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session session1 = HibernateSessionFactory.<i>getSession</i>();</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="text-decoration:underline;">List</span> <span style="text-decoration:underline;">list2</span> = session1.createQuery(</span><span style="font-size:12px;font-family:Consolas;color:#2A00FF">&quot;from User&quot;</span><span style="font-size: 12px;font-family: Consolas">).setCacheable(</span><strong><span style="font-size:12px;font-family:Consolas;color:#7F0055">true</span></strong><span style="font-size: 12px;font-family: Consolas">).list();</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; session1.close();</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Session <span style="background:yellow;background:yellow">session2</span> = HibernateSessionFactory.<i>getSession</i>();</span></p><p style="line-height: normal;"><span style="font-size:12px;font-family: Consolas;color:#3F7F5F">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; User user2 = (User) session2.load(User.class, 22); //</span><span style="font-size:12px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">不会</span><span style="font-size:12px;font-family:宋体;color:#3F7F5F">查询</span><span style="font-size:12px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">，直接用</span><span style="font-size:12px;font-family: Consolas;color:#3F7F5F">session1</span><span style="font-size:12px;font-family: &#39;MS Mincho&#39;;color:#3F7F5F">的</span><span style="font-size: 12px;font-family:宋体;color:#3F7F5F">缓</span><span style="font-size:12px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">存</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="text-decoration:underline;">List</span> <span style="text-decoration:underline;">list3</span> = <span style="background:lightgrey;background:lightgrey">session2</span>.createQuery(</span><span style="font-size:12px;font-family:Consolas;color:#2A00FF">&quot;from User&quot;</span><span style="font-size: 12px;font-family: Consolas">).setCacheable(</span><strong><span style="font-size:12px;font-family:Consolas;color:#7F0055">true</span></strong><span style="font-size: 12px;font-family: Consolas">).list(); </span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="background:lightgrey;background:lightgrey">session2</span>.close();</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:12px;font-family:Consolas;color:#3F7F5F">//</span><span style="font-size:12px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">只</span><span style="font-size:12px;font-family:宋体;color:#3F7F5F">查询</span><span style="font-size:12px;font-family:&#39;MS Mincho&#39;;color:#3F7F5F">一遍</span></p><p style="line-height: normal;"><span style="font-size: 12px;font-family: Consolas">&nbsp;&nbsp;&nbsp; }</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">在配置中的</span><span style="font-size:16px">region</span><span style="font-size:16px;font-family:宋体">属性可以不写，可以到程序中再指定：</span></p><p style="text-indent: 48px; line-height: normal;"><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">List </span><span style="font-size:16px;font-family:Consolas;color:#7F007F">list2</span><span style="font-size:16px;font-family:Consolas;color:#3F7F7F"> = </span><span style="font-size:16px;font-family:Consolas;color:#7F007F">session1</span><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">.createQuery(</span><i><span style="font-size:16px;font-family:Consolas;color:#2A00FF">&quot;from User&quot;</span></i><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">)</span></p><p style="margin-left: 48px; text-indent: 48px; line-height: normal;"><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">.setCacheable(</span><i><span style="font-size:16px;font-family:Consolas;color:#2A00FF">true</span></i><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">).setCacheRegion(</span><i><span style="font-size:16px;font-family:Consolas;color:#2A00FF">&quot;userCache&quot;</span></i><span style="font-size:16px;font-family:Consolas;color:#3F7F7F">).list();</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><strong><span style="font-size:21px;font-family:宋体">Hibernate</span></strong><strong><span style="font-size:21px;font-family: 宋体">锁，悲观锁（Pessimistic），乐观锁（Optimistic）</span></strong></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">悲观锁：本次事务提交之前（事务提交时会释放事务过程中的锁），外界无法修改这些记录。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">其实现方法是转换成数据库的锁来实现的，例如：</span></p><p style="text-indent:48px"><span style="font-size:16px">select * from account where name=&#39;zollty&#39; for update</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">的加锁模式有多种，我们常用的是：</span></p><p style="text-indent:48px"><span style="font-size:16px">LockMode.UPGRADE</span><span style="font-size:16px;font-family:宋体">：利用数据库的</span><span style="font-size:16px">for update</span><span style="font-size:16px;font-family:宋体">子句加锁。</span></p><p style="text-indent:48px"><span style="font-size:16px">LockMode.UPGRADE_NOWAIT</span><span style="font-size:16px;font-family:宋体">：</span><span style="font-size:16px">Oracle</span><span style="font-size:16px;font-family:宋体">的特定实现，利用</span><span style="font-size:16px">Oracle</span><span style="font-size:16px;font-family:宋体">的</span><span style="font-size:16px">for update nowait</span><span style="font-size:16px;font-family:宋体">子句实现加锁。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">加锁一般通过以下方法实现：</span></p><p style="margin-left: 53px; line-height: normal;"><span style="font-size:16px">Criteria.setLockMode</span></p><p style="margin-left: 53px; line-height: normal;"><span style="font-size:16px">Query.setLockMode</span></p><p style="margin-left: 53px; line-height: normal;"><span style="font-size:16px">Session.lock</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">悲观锁的实现（</span><span style="font-size:16px">for update</span><span style="font-size:16px;font-family:宋体">）：</span></p><p><span style="font-size:16px;color:#3F7F5F">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">也就是在执行数据库</span><span style="font-size:16px;color:#3F7F5F">select</span><span style="font-size:16px;font-family:宋体;color:#3F7F5F">语句时跟上</span><span style="font-size:16px;color:#3F7F5F">for update</span></p><p><span style="font-size: 16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; query.setLockMode(</span><span style="font-size:16px;color:#2A00FF">&quot;user&quot;</span><span style="font-size: 16px">, LockMode.</span><i><span style="font-size:16px;color:#0000C0">UPGRADE</span></i><span style="font-size: 16px">);</span></p><p><span style="font-size: 16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;color:#3F5FBF">/** </span></p><p><span style="font-size:14px;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * </span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">当有</span><span style="font-size:14px;color:#3F5FBF">LOCK</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">冲突时会提示错误并结束</span><span style="font-size:14px;color:#3F5FBF">STATEMENT</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">而不是在那里等待</span><span style="font-size:14px;color:#3F5FBF">(</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">比如</span><span style="font-size:14px;color:#3F5FBF">:</span><span style="font-size: 14px;font-family:宋体;color:#3F5FBF">要查的行已经被其它事务锁了</span><span style="font-size:14px;color:#3F5FBF">,</span></p><p><span style="font-size:14px;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * </span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">当前的锁事务与之冲突</span><span style="font-size:14px;color:#3F5FBF">,</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">加上</span><span style="font-size:14px;color:#3F5FBF">nowait,</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">当前的事务会结束会提示错误并立即结束</span><span style="font-size:14px;color:#3F5FBF"> STATEMENT</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">而不再等待</span><span style="font-size:14px;color:#3F5FBF">).</span></p><p><span style="font-size:14px;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * </span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">关于</span><span style="font-size:14px;color:#3F5FBF">NOWAIT(</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">如果一定要用</span><span style="font-size:14px;color:#3F5FBF">FOR UPDATE</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">，我更建议加上</span><span style="font-size:14px;color:#3F5FBF">NOWAIT)</span></p><p><span style="font-size:14px;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * </span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">如果加了</span><span style="font-size:14px;color:#3F5FBF">for update</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">后</span> <span style="font-size:14px;font-family:宋体;color:#3F5FBF">该语句用来锁定特定的行（如果有</span><span style="font-size:14px;color:#3F5FBF">where</span><span style="font-size:14px;font-family: 宋体;color:#3F5FBF">子句，就是满足</span><span style="font-size:14px;color:#3F5FBF">where</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">条件的那些行）。</span></p><p><span style="font-size:14px;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; * </span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">当这些行被锁定后，其他会话可以选择这些行，但不能更改或删除这些行，直到该语句的事务被</span><span style="font-size:14px;color:#3F5FBF">commit</span><span style="font-size:14px;font-family: 宋体;color:#3F5FBF">语句或</span><span style="font-size:14px;color:#3F5FBF">rollback</span><span style="font-size:14px;font-family:宋体;color:#3F5FBF">语句结束为止。</span></p><p><span style="font-size:16px;color:#3F5FBF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; */</span></p><p><span style="font-size:16px;font-family:宋体">乐观锁的实现（</span><span style="font-size:16px">Version</span><span style="font-size:16px;font-family:宋体">）：</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">class</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;xx&quot;</span></i> <span style="color:#7F007F">table</span>=<i><span style="color:#2A00FF">&quot;t_user&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#7F007F">dynamic-update</span>=<i><span style="color:#2A00FF">&quot;true&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#7F007F">dynamic-insert</span>=<i><span style="color:#2A00FF">&quot;true&quot;</span></i></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family:Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#7F007F">optimistic-lock</span>=<i><span style="color:#2A00FF">&quot;version&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="margin-left: 48px; text-indent: 28px; line-height: normal;"><span style="font-size:19px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">id</span><span style="font-size: 19px;font-family:Consolas;color:teal">&gt;</span><span style="font-size: 19px;font-family: Consolas">...</span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">id</span><span style="font-size:19px;font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:#3F5FBF">&lt;!-- version</span><span style="font-size:19px;font-family:&#39;MS Mincho&#39;;color:#3F5FBF">必</span><span style="font-size:19px;font-family:宋体;color:#3F5FBF">须紧</span><span style="font-size:19px;font-family:&#39;MS Mincho&#39;;color:#3F5FBF">跟</span><span style="font-size:19px;font-family:Consolas;color:#3F5FBF">id</span><span style="font-size:19px;font-family:&#39;MS Mincho&#39;;color:#3F5FBF">之后</span><span style="font-size:19px;font-family:Consolas;color:#3F5FBF"> --&gt;</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">version</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;version&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;java.lang.Integer&quot;</span></i><span style="color:teal">/&gt;</span></span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">&nbsp;</span></p><p><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">实体配置高级篇：</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">sequence</span><span style="font-size:16px;font-family:宋体">的写法</span></p><p style="margin-left: 48px; text-indent: 19px; line-height: normal;"><span style="font-size:19px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">id</span><span style="font-size: 19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;id&quot;</span></i> <span style="color:#7F007F">type</span>=<i><span style="color:#2A00FF">&quot;java.lang.Integer&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">column</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;ID&quot;</span></i> <span style="color:#7F007F">precision</span>=<i><span style="color:#2A00FF">&quot;22&quot;</span></i> <span style="color:#7F007F">scale</span>=<i><span style="color:#2A00FF">&quot;0&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">generator</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;sequence&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size: 19px;font-family:Consolas;color:#3F7F7F">param</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;sequence&quot;</span></i><span style="color:teal">&gt;</span>SEQ_DEPT_ID<span style="color:teal">&lt;/</span><span style="color:#3F7F7F">param</span><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">generator</span><span style="font-size:19px;font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">id</span><span style="font-size:19px;font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">员工和部门的关系配置：</span></p><p style="text-indent:48px"><span style="font-size:16px;font-family:宋体">员工</span><span style="font-size:16px">deptInfo</span><span style="font-size:16px;font-family:宋体">对象属性：</span></p><p><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:19px;font-family:Consolas;color:#7F0055">private</span></strong><span style="font-size: 19px;font-family: Consolas"> DeptInfo </span><span style="font-size:19px;font-family:Consolas;color:#0000C0">deptInfo</span><span style="font-size: 19px;font-family: Consolas">;</span></p><p><span style="font-size:16px;font-family:宋体">对应：</span></p><p style="line-height: normal;"><span style="font-size:19px;font-family: Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">many-to-one</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;deptInfo&quot;</span></i> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;DeptInfo&quot;</span></i> <span style="color:#7F007F">fetch</span>=<i><span style="color:#2A00FF">&quot;select&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">column</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;DEPT_ID&quot;</span></i> <span style="color:#7F007F">precision</span>=<i><span style="color:#2A00FF">&quot;22&quot;</span></i> <span style="color:#7F007F">scale</span>=<i><span style="color:#2A00FF">&quot;0&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size:19px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:19px;font-family: Consolas;color:#3F7F7F">many-to-one</span><span style="font-size: 19px;font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">而部门中员工是以</span><span style="font-size:16px">set</span><span style="font-size:16px;font-family:宋体">来存放的：</span></p><p><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp; </span><strong><span style="font-size:19px;font-family:Consolas;color:#7F0055">private</span></strong><span style="font-size: 19px;font-family: Consolas"> Set&lt;EmpInfo&gt; </span><span style="font-size:19px;font-family: Consolas;color:#0000C0">empInfos</span><span style="font-size: 19px;font-family: Consolas"> = </span><strong><span style="font-size:19px;font-family:Consolas;color:#7F0055">new</span></strong><span style="font-size: 19px;font-family: Consolas"> HashSet&lt;EmpInfo&gt;(0);</span></p><p><span style="font-size:16px;font-family:宋体">对应：</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">set</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;empInfos&quot; </span></i><span style="color:#7F007F">inverse</span>=<i><span style="color:#2A00FF">&quot;true&quot;</span></i><span style="color:teal">&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">key</span><span style="font-size:19px;font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">column</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">name</span>=<i><span style="color:#2A00FF">&quot;DEPT_ID&quot;</span></i> <span style="color:#7F007F">precision</span>=<i><span style="color:#2A00FF">&quot;22&quot;</span></i> <span style="color:#7F007F">scale</span>=<i><span style="color:#2A00FF">&quot;0&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">key</span><span style="font-size:19px;font-family:Consolas;color:teal">&gt;</span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">one-to-many</span><span style="font-size:19px;font-family:Consolas"> <span style="color:#7F007F">class</span>=<i><span style="color:#2A00FF">&quot;EmpInfo&quot;</span></i> <span style="color:teal">/&gt;</span></span></p><p style="line-height: normal;"><span style="font-size: 19px;font-family: Consolas">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:19px;font-family:Consolas;color:teal">&lt;/</span><span style="font-size:19px;font-family:Consolas;color:#3F7F7F">set</span><span style="font-size:19px;font-family:Consolas;color:teal">&gt;</span></p><p><span style="font-size:16px;font-family:宋体">这个</span><span style="font-size:16px">inverse</span><span style="font-size:16px;font-family:宋体">是做什么的？答：通常放在一对多的一方并设置为</span><span style="font-size:16px">true</span><span style="font-size:16px;font-family:宋体">，代表“主外键的关系由对方来维护”，打个比方：在一个公司中，是老板认识所有的员工容易，还是所有员工认识老板容易？</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">员工配置里面是</span><span style="font-size:16px">&lt;many-to-one&gt;</span><span style="font-size:16px;font-family:宋体">多个员工对应一个部门</span></p><p><span style="font-size:16px;font-family:宋体">而部门配置里面是</span><span style="font-size:16px">&lt;one-to-many&gt;</span><span style="font-size:16px;font-family:宋体">是一个部门对应多个员工。这个标签有一个</span><span style="font-size:16px">class</span><span style="font-size:16px;font-family:宋体">属性放对方的类名。</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px">&nbsp;</span></p><p><span style="font-size:16px;font-family:宋体">关于</span><span style="font-size:16px">inverse</span><span style="font-size:16px;font-family:宋体">的详细解释：</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">设</span><span style="font-size:16px">STUDENT</span><span style="font-size:16px;font-family:宋体">表中存在一个名为</span><span style="font-size:16px">CLASS_ID</span><span style="font-size:16px;font-family:宋体">的字段，它和</span><span style="font-size:16px">CLASS</span><span style="font-size:16px;font-family:宋体">表中的</span><span style="font-size:16px">ID</span><span style="font-size:16px;font-family:宋体">字段是主外键关系。那个</span><span style="font-size:16px">inverse</span><span style="font-size:16px;font-family:宋体">属性就是用来规定是由谁（</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">或</span><span style="font-size:16px">Class</span><span style="font-size:16px;font-family:宋体">）来维护这个主外键关系的。</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; inverse</span><span style="font-size:16px;font-family:宋体">的默认值为</span><span style="font-size:16px">false</span><span style="font-size:16px;font-family:宋体">。</span></p><p style="text-indent:48px"><span style="font-size:16px;font-family:宋体">在处理逻辑代码中，如下：</span></p><p><span style="font-size:16px">Class c1 = new Class();</span></p><p><span style="font-size:16px">c1.setName(&quot;</span><span style="font-size:16px;font-family:宋体">一班</span><span style="font-size:16px">&quot;);</span></p><p><span style="font-size:16px">Student s1 = new Student();</span></p><p><span style="font-size:16px">Student s2 = new Student();</span></p><p><span style="font-size:16px">s1.setName(&quot;Jason&quot;);</span></p><p><span style="font-size:16px">s2.setName(&quot;Tom&quot;);</span></p><p><span style="font-size:16px">c1.getStudents().add(s1);</span></p><p><span style="font-size:16px">c2.getStudents().add(s2);</span></p><p><span style="font-size:16px">s1.setClass(c1);</span></p><p><span style="font-size:16px">s2.setClass(c1);&nbsp;&nbsp; //</span><span style="font-size:16px;font-family:宋体">注释</span><span style="font-size:16px">1</span></p><p><span style="font-size:16px">session.save(c1);</span></p><p><span style="font-size:16px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:16px;font-family:宋体">上面的代码会使</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">执行五条</span><span style="font-size: 16px">SQL</span><span style="font-size:16px;font-family:宋体">语句，其中前三条是</span><span style="font-size:16px">insert</span><span style="font-size:16px;font-family:宋体">插入语句，后两条是</span><span style="font-size:16px">update</span><span style="font-size:16px;font-family:宋体">更新语句。插入就不用说了，那么为什么还要有更新语句呢？这是因为</span><span style="font-size:16px">Class</span><span style="font-size:16px;font-family:宋体">类映射文件的</span><span style="font-size:16px">&lt;set&gt;</span><span style="font-size:16px;font-family:宋体">元素中指定了</span><span style="font-size:16px">inverse=&quot;false&quot;</span><span style="font-size:16px;font-family:宋体">，这就告之</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">：</span><span style="font-size:16px">STUDENT</span><span style="font-size:16px;font-family:宋体">表与</span><span style="font-size:16px">CLASS</span><span style="font-size:16px;font-family:宋体">表的主外键关系是由</span><span style="font-size:16px">Class</span><span style="font-size:16px;font-family:宋体">类来维护的。当执行</span><span style="font-size:16px">save</span><span style="font-size:16px;font-family:宋体">后，执行了三条</span><span style="font-size:16px">insert</span><span style="font-size:16px;font-family:宋体">语句，这三条语句中的后两条是插入到</span><span style="font-size:16px">STUDENT</span><span style="font-size:16px;font-family:宋体">表的，它们的</span><span style="font-size:16px">CLASS_ID</span><span style="font-size:16px;font-family:宋体">字段是通过</span><span style="font-size:16px">s1.getClass().getID()</span><span style="font-size:16px;font-family:宋体">取出的，假如我将上面“注释</span><span style="font-size:16px">1”</span><span style="font-size:16px;font-family:宋体">处修改为</span><span style="font-size:16px">s2.setClass(c2);</span><span style="font-size: 16px;font-family:宋体">（</span><span style="font-size:16px">c2</span><span style="font-size:16px;font-family:宋体">是另一个</span><span style="font-size:16px">Class</span><span style="font-size:16px;font-family:宋体">对象，可能是持久化对象），这样，主外键关系不就乱了吗。为了保证主外键关系，</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">在这种情况下会再执行两条</span><span style="font-size:16px">update</span><span style="font-size:16px;font-family:宋体">语句来更改</span><span style="font-size:16px">STUDENT</span><span style="font-size:16px;font-family:宋体">表中两个新插入记录的</span><span style="font-size:16px">CLASS_ID</span><span style="font-size:16px;font-family:宋体">字段，当然，这时</span><span style="font-size: 16px">CLASS_ID</span><span style="font-size:16px;font-family:宋体">字段的取值是从</span><span style="font-size:16px">c1</span><span style="font-size:16px;font-family:宋体">对象中直接取得，而不再是</span><span style="font-size:16px">s1.getClass().getID()</span><span style="font-size:16px;font-family:宋体">方式了。</span></p><p style="text-indent:48px"><span style="font-size:16px;font-family:宋体">如果我们将</span><span style="font-size:16px">Class</span><span style="font-size:16px;font-family:宋体">类映射文件的</span><span style="font-size:16px">&lt;set&gt;</span><span style="font-size:16px;font-family:宋体">元素中的</span><span style="font-size: 16px">inverse</span><span style="font-size:16px;font-family:宋体">属性修改为</span><span style="font-size:16px">true</span><span style="font-size:16px;font-family:宋体">，这就是告诉</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">：</span><span style="font-size:16px">Class</span><span style="font-size:16px;font-family:宋体">类不维护主外键关系了，这个任务就交给了</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">类。于是，我们再执行上面的代码，</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">就会只执行三条</span><span style="font-size:16px">insert</span><span style="font-size:16px;font-family:宋体">语句，而不会执行任何</span><span style="font-size:16px">update</span><span style="font-size:16px;font-family:宋体">语句。因为</span><span style="font-size:16px">Hibernate</span><span style="font-size:16px;font-family:宋体">会通过</span><span style="font-size:16px">Student</span><span style="font-size:16px;font-family:宋体">类的</span><span style="font-size:16px">s1.getClass().getID()</span><span style="font-size:16px;font-family:宋体">和</span><span style="font-size:16px">s2.getClass().getID()</span><span style="font-size:16px;font-family: 宋体">来确定</span><span style="font-size:16px">CLASS_ID</span><span style="font-size:16px;font-family:宋体">字段的值。</span></p><p style="text-indent:48px"><span style="font-size:16px;font-family:宋体">故，为了节省数据库资源，省却不必要的</span><span style="font-size:16px">update</span><span style="font-size:16px;font-family:宋体">语句，我们一般建议在一对多双向关联关系中，将一方的</span><span style="font-size: 16px">inverse</span><span style="font-size:16px;font-family:宋体">属性设置为</span><span style="font-size:16px">true</span><span style="font-size:16px;font-family:宋体">，即将主外键的关系交由多方来维护。</span></p><p style="text-indent: 48px;"><span style="font-size:16px;font-family:宋体">打个比方：在一个公司中，是老板认识所有的员工容易，还是所有员工认识老板容易？</span></p><p style="text-indent: 48px;"><span style="font-size:16px;font-family:宋体"><br/></span></p>
