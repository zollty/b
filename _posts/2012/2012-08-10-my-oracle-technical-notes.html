---
layout: ue
title: 我的Oracle技术笔记
category: 数据库技术_综合
tags: Oracle
keywords: "Oracle"
---

<p><br/></p><p><strong><span style="font-size: 20px; ">ORACLE添加数据库连接的方法</span></strong></p><p>在：{安装目录}\db_1\NETWORK\ADMIN下面</p><p>打开<strong>tnsnames.ora</strong>文件</p><p>添加类似于下面的字符串：</p><p style="line-height: normal; "><span style="font-size: 16px; "></span></p><pre class="brush:plain;toolbar:false">rdtest&nbsp;=
&nbsp;(DESCRIPTION&nbsp;=
&nbsp;&nbsp;(ADDRESS_LIST&nbsp;=
&nbsp;&nbsp;&nbsp;(ADDRESS&nbsp;=&nbsp;(PROTOCOL=TCP)(HOST=11.6.31.120)(PORT=1422))
&nbsp;&nbsp;)
&nbsp;&nbsp;(CONNECT_DATA&nbsp;=
&nbsp;&nbsp;&nbsp;(SID=utf10gt1)(SERVER=DEDICATED)
&nbsp;&nbsp;)
&nbsp;)
WEBCB&nbsp;=
&nbsp;&nbsp;(DESCRIPTION&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;(ADDRESS_LIST&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ADDRESS&nbsp;=&nbsp;(PROTOCOL&nbsp;=&nbsp;TCP)(HOST=11.6.14.115)(PORT=1422))
&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;&nbsp;&nbsp;(CONNECT_DATA&nbsp;=
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SERVICE_NAME=cab2b)
&nbsp;&nbsp;&nbsp;(SERVER=DEDICATED)
&nbsp;&nbsp;&nbsp;&nbsp;)
&nbsp;&nbsp;)</pre><p><span style="font-size: 16px; "></span>上面就添加了rdtest和WEBCB两个连接。</p><p><br/></p><p><br/></p><p><strong><span style="font-size: 20px; ">Oracle回收站功能，彻底删除表（purge recyclebin）</span></strong></p><p>一、清除方法如下：<br/></p><p>1、<strong>purge table</strong> origenal_tableName;</p><p>&nbsp; &nbsp; &nbsp; <strong>purge index</strong> origenal_indexName;</p><p>2、show recyclebin;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; purge <strong>recyclebin</strong>;</p><p><br/></p><p>二、查询垃圾信息：</p><p>select * from <strong>user_recyclebin</strong>;</p><p>&nbsp;</p><p>三、删除表结构</p><div><p><strong>drop</strong> table t_order_info</p><p>删除table<strong>不进入recycle</strong>的方法：</p><p><strong>drop table</strong> tableName <strong>purge</strong>;</p></div><div>删除表结构，并且<strong>级联删除外键</strong></div><div><strong>drop</strong> table t_order_info <strong>cascade</strong> <strong>constraints</strong>;</div><p><br/></p><p><strong>flashback</strong> table t to <strong>before drop</strong>;</p><p><br/></p><div><strong>快速彻底的清空表</strong>：（相比delete而言，要高效）</div><div><strong>truncate table</strong> order_info;</div><div><br/></div><div><br/></div><div>分享一下，如果你的数据库满了，清数据没效果，那就<strong>回收一下表空间</strong>吧！</div><div><span style="background-color: rgb(238, 236, 225);">alter table &lt;tablename&gt; enable row movement;</span></div><div><span style="background-color: rgb(238, 236, 225);">alter table &lt;tablename&gt; <strong>shrink</strong> <strong>space</strong>;</span></div><div><br/></div><p><br/></p><div>Oracle提供两者<span style="font-size: 20px;"><strong>分页查询</strong></span>的方式，格式如下：</div><div>方式一：<span style="background-color: rgb(238, 236, 225);">Select * from (select *,rownum rn from (select * from table_name) where rownum &lt;= 40) t where t.rn &gt; 20</span>;</div><div>方式二：select * from (select * ,rownum rn from (select * from table_name) ) t where t.rn between 20 and 40;</div><div><p>这两种方式中<strong>第一种的效率比第二种的效率高</strong>，因为oracle有自带CBO基于成本的优化器，可以将第二层的查询查询条件推到内层查询条件中去，已提高内层查询的执行效率。</p><p>A=select rownum rn from (select * from user) where rownum&lt;=40</p></div><div>select * from (A) t where t.rn&gt;20;</div><p>可以理解为：</p><p>从自己表的副本中查询rownum&lt;40的数据，并保存到视图A中，</p><p>并把rownum映射成rn（目的是在新视图A中使用一个与rownum不重名的字段）</p><p>然后在A表中查找rn&gt;20的数据。</p><p><br/></p><div><p><strong>在数据库中建立表，并将相应查询返回的数据插入至新建表中</strong>。但查询相关表的索引、主键等不会复制到新建表中！</p><div>语法</div><div>CREATE table table_name as select query</div></div><div>示例：</div><div>备份整个订单表（表结果及数据）到order_back表</div><div>CREATE TABLE order_back as select * from order;</div><p><br/></p><p><strong><span style="font-size: 20px;">查看Oracle连接的session</span></strong><br/></p><p>select OSUSER,MACHINE,COMMAND,TERMINAL,ACTION,MODULE,LOGON_TIME from <strong>sys.v_$session</strong> where username=&#39;HUOLP&#39;</p><p><br/></p><p><span style="font-size: 20px;"><strong>常用Oracle语句</strong></span></p><p><br/></p><p>select name from <strong>v$tablespace</strong>;</p><p><br/></p><p>select SEGMENT_NAME from <strong>dba_segments</strong> where TABLESPACE_NAME=&#39;ZOLLTY_IDX1&#39; GROUP BY SEGMENT_NAME;</p><p><strong>DROP TABLESPACE</strong> ZOLLTY_DAT <strong>INCLUDING CONTENTS AND DATAFILES</strong>;</p><p><br/></p><strong>create table</strong> admin_user(id number(9) not null primary key,name varchar2(20) not null);<p><br/></p><p><strong>rename</strong> admin_user to myuser;</p><p><br/></p><div>comment on table order is ‘订单表’;</div><p><br/></p><p>增加列</p><div>alter table DCM_RULE add RULESCOPE VARCHAR2(18);</div><div><br/></div><div>修改列</div><div>alter table DCM_RULE modify RULETYPE varchar2(18);</div><div><br/></div><div>删除列</div><div>alter table EMP drop column user_name</div><p><br/></p><p><strong>alter table</strong> admin_user modify name varchar2(30);</p><div>alter table user rename to new_table_name;</div><div>alter table order add create_date;</div><div>alter table report_task modify serviceid varchar2(30);</div><p><br/></p><p><strong>grand</strong> insert on t_order_info to zollty;</p><p><strong>revoke</strong> all on t_order_info from zollty;</p><p><br/></p><p><strong>create sequence</strong> T_ORDER-INFO_SEQ</p><p>minvalue 1000</p><p>maxvalue 9999</p><p>start with 1001</p><p>increment by 1</p><p>cache 20</p><p>cycle;</p><p><br/></p><p>number(10,2) ---2位小数点</p><p>number(1) &nbsp; &nbsp;---</p><p>number &nbsp;---长度1~38</p><p>date</p><p>getTimeStamp</p><p><br/></p><p><strong>to_date</strong>(&#39;2012-8-21&#39;,&#39;yyyy-MM-dd&#39;)</p><p><br/></p><p>yyyy-MM-dd HH:mm:ss--HH代表24小时制,hh代表12小时制</p><p>Oracle里面写作<strong>yyyy-MM-dd hh24:mm:ss</strong></p><p><br/></p><p>clob大对象形式存放（指针形式）</p><p>blob寸二进制对象，声音、图片</p><p><br/></p><p>==============</p><p>substr(a,i,length)</p><p>concat(a,b,c..)</p><p>init(a)首字母大写</p><p>to_date</p><p>to_char</p><p>length(a)</p><p><br/></p><p>nvl(a)空值函数</p><p>--nvl(name,&#39;admin&#39;)--如果为空则返回admin</p><p>upper、lower(a)</p><p><br/></p><p>round(a,i)</p><p>sum(a)</p><p><br/></p><p>to_date</p><p>to_char</p><p>=====================</p><p><br/></p>
