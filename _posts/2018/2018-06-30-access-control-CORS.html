---
layout: ue
title: HTTP访问控制（CORS）
category: 计算机网络技术
tags: CORS
keywords: "HTTP,CORS"
---

<p style="white-space: normal;"><span style="font-size: 18px;"><br/></span></p><p>简单总结如下：</p><p>1、对于简单请求，浏览器不会做同源限制。</p><p>2、对于非简单请求，浏览器AJAX会先发起 OPTIONS预检请求，并在请求头中添加Origin头信息，如下所示：</p><pre class="brush:js;toolbar:false">OPTIONS&nbsp;/test&nbsp;HTTP/1.1
Origin:&nbsp;http://www.examples.com
Access-Control-Request-Method:&nbsp;DELETE
Access-Control-Request-Headers:&nbsp;X-Custom-Header
Host:&nbsp;www.examples.com</pre><p>后端服务器根据这些头信息，可以判断是否允许非同源的访问，如果后端服务器允许，返回类似如下信息：</p><pre class="brush:js;toolbar:false">Access-Control-Allow-Origin:&nbsp;http://www.examples.com
Access-Control-Allow-Methods:&nbsp;GET,&nbsp;POST,&nbsp;PUT,&nbsp;DELETE&nbsp;//真实请求允许的方法
Access-Control-Allow-Headers:&nbsp;X-Custom-Header&nbsp;//服务器允许使用的字段
Access-Control-Allow-Credentials:&nbsp;true&nbsp;//是否允许用户发送、处理&nbsp;cookie
Access-Control-Max-Age:&nbsp;1728000&nbsp;//有效期，单位为秒。有效期内，不会重复发送预检请求</pre><p><span style="font-size: 18px;"></span>当预检请求通过后，浏览器会发送真实请求到服务器。<br/></p><p style="white-space: normal;"><br/></p><p style="white-space: normal;"><span style="font-size: 18px;">参考资料1：</span></p><p style="white-space: normal;"><span style="font-size: 18px;">转载自：</span><a href="https://blog.csdn.net/switch513/article/details/54612411" target="_self">https://blog.csdn.net/switch513/article/details/54612411</a></p><p style="white-space: normal;"><span style="font-size: 18px;">请阅读原文。此处转载只做备份目的。</span></p><p style="white-space: normal;"><span style="font-size: 18px;"><br/></span></p><p style="white-space: normal;"><span style="font-size: 18px;"></span></p><h2 style="outline: 0px; padding: 0px; margin: 8px 0px 16px; font-size: 24px; color: rgb(79, 79, 79); font-weight: 700; line-height: 32px; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">1. CORS 简介</h2><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">同源策略（same origin policy）是浏览器安全的基石。在同源策略的限制下，非同源的网站之间不能发送 ajax 请求的。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">为了解决这个问题，w3c 提出了跨源资源共享，即 CORS(<a href="https://www.w3.org/TR/cors/" target="_blank" style="outline: 0px; color: rgb(103, 149, 181); cursor: pointer; word-break: break-all;">Cross-Origin Resource Sharing</a>)。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">CORS 做到了两点：</p><ol style="list-style-type: none;" class=" list-paddingleft-2"><li><p>不破坏即有规则</p></li><li><p>服务器实现了 CORS 接口，就可以跨源通信</p></li></ol><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">基于这两点，CORS 将请求分为两类：简单请求和非简单请求。</p><h3 style="outline: 0px; padding: 0px; margin: 8px 0px 16px; font-size: 22px; color: rgb(79, 79, 79); font-weight: 700; line-height: 30px; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);"><a style="outline: 0px; color: rgb(78, 161, 219); cursor: pointer; word-break: break-all;"></a>1.1 简单请求</h3><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">可以先看下 CORS 出现前的情况：跨源时能够通过 script 或者 image 标签触发 GET 请求或通过表单发送一条 POST 请求，但这两种请求 HTTP 头信息中都不能包含任何自定义字段。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">简单请求对应该规则，因此对简单请求的定义为：</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">请求方法是&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">HEAD</code>、<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">GET</code>&nbsp;或&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">POST</code>&nbsp;且 HTTP 头信息不超过以下几个字段：<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Accept</code>、<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Accept-Language</code>、<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Content-Language</code>、<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Last-Event-ID</code>、<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Content-Type</code>（只限于&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">application/x-www-form-urlencoded</code>、<code class="hljs haskell" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;"><span class="hljs-title" style="outline: 0px; color: rgb(97, 174, 238); word-break: break-all;">multipart</span>/form-<span class="hljs-typedef" style="outline: 0px; word-break: break-all;"><span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">data</span></span></code>、<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">text/plain</code>）。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">比如有一个简单请求：</p><pre class="hljs" style="outline: 0px; padding: 8px; margin-bottom: 24px; position: relative; color: rgb(0, 0, 0); background: rgb(40, 44, 52); white-space: pre-wrap; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px;"><code class="hljs bash" style="outline: 0px; display: block; overflow-x: auto; padding: 8px; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; font-size: 14px; line-height: 22px; white-space: pre; word-wrap: normal; font-family: Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; word-break: break-all;"><ol class="hljs-ln list-paddingleft-2" style="list-style-type: none;"><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">GET /<span class="hljs-built_in" style="outline: 0px; color: rgb(230, 192, 123); word-break: break-all;">test</span> HTTP/1.1</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Accept: <span class="hljs-emphasis" style="outline: 0px; font-style: italic; word-break: break-all;">*/*</span></div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Accept-Encoding: gzip, deflate, sdch, br</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Origin: http://www.examples.com</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Host: www.examples.com</div></div></li></ol></code></pre><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">对于这样的简单请求，CORS 的策略是请求时，**在头信息中添加一个 Origin 字段**，服务器收到请求后，根据该字段判断是否允许该请求。</p><ol style="list-style-type: none;" class=" list-paddingleft-2"><li><p>如果允许，则在 HTTP 头信息中添加&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Allow-Origin</code>&nbsp;字段，并返回正确的结果</p></li><li><p>如果不允许，则不在头信息中添加&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Allow-Origin</code>&nbsp;字段。</p></li></ol><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">浏览器先于用户得到返回结果，根据有无&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Allow-Origin</code>&nbsp;字段来决定是否拦截该返回结果。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">对于 CORS 出现前的一些服务，CORS 对他们的影响分两种情况：</p><ol style="list-style-type: none;" class=" list-paddingleft-2"><li><p>script 或者 image 触发的 GET 请求不包含 Origin 头，所以不受到 CORS 的限制，依旧可用。</p></li><li><p>如果是 ajax 请求，HTTP 头信息中会包含 Origin 字段，由于服务器没有做任何配置，所以返回结果不会包含&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Allow-Origin</code>，因此返回结果会被浏览器拦截，接口依旧不可以被 ajax 跨源访问。</p></li></ol><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">可以看出，CORS 的出现，没有对”旧的“服务造成任何影响。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">另外，除了提到的&nbsp;<code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Allow-Origin</code>&nbsp;还有几个字段用于描述 CORS 返回结果：</p><ol style="list-style-type: none;" class=" list-paddingleft-2"><li><p>Access-Control-Allow-Credentials: 可选，用户是否可以发送、处理 cookie。</p></li><li><p>Access-Control-Expose-Headers：可选，可以让用户拿到的字段。有几个字段无论设置与否都可以拿到的，包括：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。</p></li></ol><h3 style="outline: 0px; padding: 0px; margin: 8px 0px 16px; font-size: 22px; color: rgb(79, 79, 79); font-weight: 700; line-height: 30px; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);"><a style="outline: 0px; color: rgb(78, 161, 219); cursor: pointer; word-break: break-all;"></a>1.2 非简单请求</h3><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">除了简单请求之外的请求，就是非简单请求。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">对于非简单请求的跨源请求，**浏览器会在真实请求发出前**，增加一次 OPTION 请求，称为预检请求（preflight request）。预检请求将真实请求的信息，包括请求方法、自定义头字段、源信息添加到 HTTP 头信息字段中，询问服务器是否允许这样的操作。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">比如对于&nbsp;<code class="hljs sql" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;"><span class="hljs-operator" style="outline: 0px; word-break: break-all;"><span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">DELETE</span></span></code>&nbsp;请求：</p><pre class="hljs" style="outline: 0px; padding: 8px; margin-bottom: 24px; position: relative; color: rgb(0, 0, 0); background: rgb(40, 44, 52); white-space: pre-wrap; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px;"><code class="hljs sql" style="outline: 0px; display: block; overflow-x: auto; padding: 8px; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; font-size: 14px; line-height: 22px; white-space: pre; word-wrap: normal; font-family: Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; word-break: break-all;"><ol class="hljs-ln list-paddingleft-2" style="list-style-type: none;"><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">OPTIONS /test HTTP/1.1</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Origin: http://www.examples.com</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Access-Control-Request-Method: <span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">DELETE</span></div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;"><span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Access</span>-Control-Request-Headers: X-Custom-Header</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Host: www.examples.com</div></div></li></ol></code></pre><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">与 CORS 相关的字段有：</p><ol style="list-style-type: none;" class=" list-paddingleft-2"><li><p><code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Request-Method</code>: 真实请求使用的 HTTP 方法。</p></li><li><p><code class="hljs" style="outline: 0px; display: block; overflow-x: auto; padding: 0.5em; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; word-break: break-all;">Access-Control-Request-Headers</code>: 真实请求中包含的自定义头字段。</p></li></ol><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">服务器收到请求时，需要分别对 Origin、Access-Control-Request-Method、Access-Control-Request-Headers 进行验证，验证通过后，会在返回 Http 头信息中添加</p><pre class="hljs" style="outline: 0px; padding: 8px; margin-bottom: 24px; position: relative; color: rgb(0, 0, 0); background: rgb(40, 44, 52); white-space: pre-wrap; font-family: Consolas, Inconsolata, Courier, monospace; font-size: 14px; line-height: 22px;"><code class="hljs sql" style="outline: 0px; display: block; overflow-x: auto; padding: 8px; color: rgb(171, 178, 191); background: rgb(40, 44, 52); border-radius: 4px; font-size: 14px; line-height: 22px; white-space: pre; word-wrap: normal; font-family: Consolas, Inconsolata, Courier, monospace, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, sans-serif; word-break: break-all;"><ol class="hljs-ln list-paddingleft-2" style="list-style-type: none;"><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Access-Control-Allow-Origin: http://www.examples.com</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;">Access-Control-Allow-Methods: GET, POST, PUT, <span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">DELETE</span></div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;"><span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Access</span>-Control-<span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Allow</span>-Headers: X-Custom-Header</div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;"><span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Access</span>-Control-<span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Allow</span>-Credentials: <span class="hljs-literal" style="outline: 0px; color: rgb(86, 182, 194); word-break: break-all;">true</span></div></div></li><li><div class="hljs-ln-code" style="outline: 0px; padding: 0px; margin: 0px 0px 0px 8px; word-break: break-all; float: left; height: 22px;"><div class="hljs-ln-line" style="outline: 0px; padding: 0px; margin: 0px; word-break: break-all;"><span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Access</span>-Control-<span class="hljs-keyword" style="outline: 0px; color: rgb(198, 120, 221); word-break: break-all;">Max</span>-Age: <span class="hljs-number" style="outline: 0px; color: rgb(209, 154, 102); word-break: break-all;">1728000</span></div></div></li></ol></code></pre><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">他们的含义分别是：</p><ol style="list-style-type: none;" class=" list-paddingleft-2"><li><p>Access-Control-Allow-Methods: 真实请求允许的方法</p></li><li><p>Access-Control-Allow-Headers: 服务器允许使用的字段</p></li><li><p>Access-Control-Allow-Credentials: 是否允许用户发送、处理 cookie</p></li><li><p>Access-Control-Max-Age: 预检请求的有效期，单位为秒。有效期内，不会重复发送预检请求</p></li></ol><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">当预检请求通过后，浏览器会发送真实请求到服务器。这就实现了跨源请求。</p><p style="outline: 0px; padding: 0px; margin-bottom: 16px; font-size: 16px; color: rgb(79, 79, 79); line-height: 26px; text-align: justify; word-break: break-all; font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; white-space: normal; background-color: rgb(255, 255, 255);">了解完 CORS，接下来我们来搭建简单的 Spring MVC 服务，并进一步了解 Spring MVC 如何配置 CORS。</p><p style="white-space: normal;"><span style="font-size: 18px;"><br/></span></p><p style="white-space: normal;"><span style="font-size: 18px;"><br/></span></p><p><br/></p><p><span style="font-size: 18px;">参考资料2：</span></p><p><span style="font-size: 18px;">转载自：</span><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS" style="font-size: 18px; text-decoration: underline;"><span style="font-size: 18px;">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS</span></a> </p><p><span style="font-size: 18px;">请阅读原文。此处转载只做备份目的。</span></p><p><br/></p><p>当一个资源从与该资源本身所在的服务器不同的域或端口请求一个资源时，资源会发起一个<strong style=";padding: 0px;border: 0px">跨域 HTTP 请求</strong>。&nbsp;比如，站点&nbsp;http://domain-a.com&nbsp;的某 HTML 页面通过&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/Img#Attributes" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">&lt;img&gt; 的 src&nbsp;</a>请求&nbsp;http://domain-b.com/image.jpg。网络上的许多页面都会加载来自不同域的CSS样式表，图像和脚本等资源。&nbsp;</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">出于安全原因，浏览器限制从脚本内发起的跨源HTTP请求。 例如，XMLHttpRequest和Fetch API遵循同源策略。 这意味着使用这些API的Web应用程序只能从加载应用程序的同一个域请求HTTP资源，除非使用CORS头文件。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">&nbsp;&nbsp;（译者注：<span style="text-decoration:line-through;">这段描述跨域不准确，</span>跨域并<span style="text-decoration:line-through;">非</span>不一定是浏览器限制了发起跨站请求，<span style="text-decoration:line-through;">而</span>也可能是跨站请求可以正常发起，但是返回结果被浏览器拦截了。最好的例子是 CSRF 跨站攻击原理，请求是发送到了后端服务器无论是否跨域！注意：有些浏览器不允许从 HTTPS 的域跨域访问 HTTP，比如 &nbsp;Chrome 和 Firefox，这些浏览器在请求还未发出的时候就会拦截请求，这是一个特例。）</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><img src="{{site.assets_url}}img/20180831/1535691307096091909.png" alt=""/></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">跨域资源共享（&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS" title="CORS: CORS&nbsp;(Cross-Origin Resource Sharing) is a system, consisting of transmitting HTTP headers, that&nbsp;determines&nbsp;whether to block or fulfill requests for restricted resources on a web page from another domain outside the domain from which the resource originated." style="color: inherit;padding: 0px;border-width: 0px 0px 1px;border-top-style: initial;border-right-style: initial;border-bottom-style: dashed;border-left-style: initial;border-top-color: initial;border-right-color: initial;border-bottom-color: rgb(170, 170, 170);border-left-color: initial;border-image: initial;cursor: help">CORS</a>&nbsp;）机制允许&nbsp;Web 应用服务器进行跨域访问控制，从而使跨域数据传输得以安全进行。浏览器支持在 API 容器中（例如&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" title="XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code></a>&nbsp;或&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Fetch</a>&nbsp;）使用 CORS，以降低跨域 HTTP 请求所带来的风险。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">这篇文章适用于网站管理员、后端和前端开发者。CORS 需要客户端和服务器同时支持。目前，所有浏览器都支持该机制。 对于服务端的支持，开发者可以阅读补充材料&nbsp;<a href="https://developer.mozilla.org/En/Server-Side_Access_Control" title="En/Server-Side Access Control" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">cross-origin sharing from a server perspective (with PHP code snippets)</a>&nbsp;。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">跨域资源共享标准（&nbsp;<a href="http://www.w3.org/TR/cors/" class="external external-icon" title="http://www.w3.org/TR/cors/" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">cross-origin sharing standard</a>&nbsp;）允许在下列场景中使用跨域&nbsp;HTTP 请求：</p><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p>前文提到的由&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" title="XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code></a>&nbsp;或&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Fetch</a>&nbsp;发起的跨域 HTTP 请求。</p></li><li><p>Web 字体 (CSS 中通过<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">&nbsp;@font-face&nbsp;</code>使用跨域字体资源),&nbsp;<a href="http://www.webfonts.info/wiki/index.php?title=%40font-face_support_in_Firefox" class="external external-icon" title="http://www.webfonts.info/wiki/index.php?title=@font-face_support_in_Firefox" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">因此，网站就可以发布 TrueType 字体资源，并只允许已授权网站进行跨站调用</a>。</p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebGL_API/Tutorial/Using_textures_in_WebGL" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">WebGL 贴图</a></p></li><li><p>使用&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/drawImage" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">drawImage</a></code>&nbsp;将 Images/video 画面绘制到 canvas</p></li><li><p>样式表（使用&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSSOM_View" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">CSSOM</a>）</p></li><li><p>Scripts (未处理的异常)</p></li></ul><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">本文概述了跨域资源共享机制及其所涉及的 HTTP 首部字段。</p><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E6%A6%82%E8%BF%B0" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>概述</h2><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">跨域资源共享标准新增了一组&nbsp;HTTP 首部字段，允许服务器声明哪些源站有权限访问哪些资源。另外，规范要求，对那些可能对服务器数据产生副作用的 HTTP 请求方法（特别是&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET" title="HTTP GET&nbsp;方法请求指定的资源。使用 GET 的请求应该只用于获取数据。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">GET</code></a>&nbsp;以外的 HTTP 请求，或者搭配某些 MIME 类型的&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST" title="HTTP POST&nbsp;方法&nbsp;发送数据给服务器. 请求主体的类型由 Content-Type 首部指定. 一个&nbsp;POST&nbsp;请求通常是通过&nbsp;HTML 表单发送, 并返回服务器的修改结果. 在这种情况下, content type 是通过在 &lt;form&gt; 元素中设置正确的&nbsp;enctype 属性, 或是在&nbsp;&lt;input&gt;和&lt;button&gt;元素中设置&nbsp;formenctype 属性来选择的:" style="color: rgb(63, 135, 166); margin: 0px; padding: 0px; border: 0px;"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">POST</code></a>&nbsp;请求），浏览器必须首先使用&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/OPTIONS" title="HTTP 的&nbsp;OPTIONS 方法&nbsp;用于获取目的资源所支持的通信选项。客户端可以对特定的 URL 使用 OPTIONS 方法，也可以对整站（通过将 URL 设置为“*”）使用该方法。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">OPTIONS</code></a>&nbsp;方法发起一个预检请求（preflight request），从而获知服务端是否允许该跨域请求。服务器确认允许之后，才发起实际的&nbsp;HTTP 请求。在预检请求的返回中，服务器端也可以通知客户端，是否需要携带身份凭证（包括&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Cookies" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Cookies&nbsp;</a>和 HTTP 认证相关数据）。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">接下来的内容将讨论相关场景，并剖析该机制所涉及的&nbsp;HTTP 首部字段。</p><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E8%8B%A5%E5%B9%B2%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E5%9C%BA%E6%99%AF" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>若干访问控制场景</h2><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">这里，我们使用三个场景来解释跨域资源共享机制的工作原理。这些例子都使用&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" title="XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code></a>&nbsp;对象。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">本文中的 JavaScript 代码片段都可以从&nbsp;<a href="http://arunranga.com/examples/access-control/" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">http://arunranga.com/examples/access-control/</a>&nbsp;获得。另外，使用支持跨域&nbsp;&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" title="XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code></a>&nbsp;的浏览器访问该地址，可以看到代码的实际运行结果。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">关于服务端对跨域资源共享的支持的讨论，请参见这篇文章：&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Server-Side_Access_Control" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Server-Side_Access_Control (CORS)</a>。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E7%AE%80%E5%8D%95%E8%AF%B7%E6%B1%82" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">简单请求</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">某些请求不会触发&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Preflighted_requests" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">CORS 预检请求</a>。本文称这样的请求为“简单请求”，请注意，该术语并不属于&nbsp;<a href="https://fetch.spec.whatwg.org/" title="Fetch" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Fetch</a>&nbsp;（其中定义了 CORS）规范。若请求满足所有下述条件，则该请求可视为“简单请求”：</p><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p>使用下列方法之一：</p></li><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/GET" title="HTTP GET&nbsp;方法请求指定的资源。使用 GET 的请求应该只用于获取数据。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">GET</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/HEAD" title="HTTP HEAD&nbsp;方法&nbsp;请求资源的首部信息, 并且这些首部与 HTTP GET 方法请求时返回的一致. 该请求方法的一个使用场景是在下载一个大文件前先获取其大小再决定是否要下载, 以此可以节约带宽资源." style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">HEAD</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/POST" title="HTTP POST&nbsp;方法&nbsp;发送数据给服务器. 请求主体的类型由 Content-Type 首部指定. 一个&nbsp;POST&nbsp;请求通常是通过&nbsp;HTML 表单发送, 并返回服务器的修改结果. 在这种情况下, content type 是通过在 &lt;form&gt; 元素中设置正确的&nbsp;enctype 属性, 或是在&nbsp;&lt;input&gt;和&lt;button&gt;元素中设置&nbsp;formenctype 属性来选择的:" style="color: rgb(63, 135, 166); margin: 0px; padding: 0px; border: 0px;"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">POST</code></a></p></li></ul><li><p><span style=";padding: 0px;border: 0px">Fetch 规范定义了</span><a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">对 CORS 安全的首部字段集合</a>，不得人为设置该集合之外的其他首部字段。该集合为：</p></li><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept" title="Accept 请求头用来告知客户端可以处理的内容类型，这种内容类型用MIME类型来表示。借助内容协商机制, 服务器可以从诸多备选项中选择一项进行应用，并使用 Content-Type 应答头通知客户端它的选择。浏览器会基于请求的上下文来为这个请求头设置合适的值，比如获取一个CSS层叠样式表时值与获取图片、视频或脚本文件时的值是不同的。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Accept</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept-Language" title="Accept-Language请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。借助内容协商机制，服务器可以从诸多备选项中选择一项进行应用， 并使用Content-Language 应答头通知客户端它的选择。浏览器会基于其用户界面语言来为这个请求头设置合适的值，即便是用户可以进行修改，但是这种情况极少发生 (and is frown upon as it leads to fingerprinting)。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Accept-Language</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Language" title="Content-Language 是一个 entity header （实体消息首部），用来说明访问者希望采用的语言或语言组合，这样的话用户就可以根据自己偏好的语言来定制不同的内容。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Content-Language</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type" title="Content-Type 实体头部用于指示资源的MIME类型&nbsp;media type&nbsp;。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Content-Type</code></a>&nbsp;（需要注意额外的限制）</p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#dpr" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">DPR</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#downlink" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Downlink</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#save-data" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Save-Data</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#viewport-width" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Viewport-Width</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#width" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Width</a></code></p></li></ul><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type" title="Content-Type 实体头部用于指示资源的MIME类型&nbsp;media type&nbsp;。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Content-Type</code></a>&nbsp;的值仅限于下列三者之一：</p></li><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">text/plain</code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">multipart/form-data</code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">application/x-www-form-urlencoded</code></p></li></ul><li><p>请求中的任意<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequestUpload" title="此页面仍未被本地化, 期待您的翻译!" style="color: rgb(153, 0, 0);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequestUpload</code></a>&nbsp;对象均没有注册任何事件监听器；<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequestUpload" title="此页面仍未被本地化, 期待您的翻译!" style="color: rgb(153, 0, 0);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequestUpload</code></a>&nbsp;对象可以使用&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest/upload" title="XMLHttpRequest.upload方法返回一个&nbsp;XMLHttpRequestUpload对象，用来表示上传的进度。这个对象是不透明的，但是作为一个XMLHttpRequestEventTarget，可以通过对其绑定事件来追踪它的进度。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest.upload</code></a>&nbsp;属性访问。</p></li><li><p>请求中没有使用&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ReadableStream" title="Fetch API&nbsp;的&nbsp;ReadableStream&nbsp;接口标识了一个可读的二进制数据流" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">ReadableStream</code></a>&nbsp;对象。</p></li></ul><p><strong style=";padding: 0px;border: 0px">注意:</strong>&nbsp;这些跨域请求与浏览器发出的其他跨域请求并无二致。如果服务器未返回正确的响应首部，则请求方不会收到任何数据。因此，那些不允许跨域请求的网站无需为这一新的 HTTP 访问控制特性担心。<strong style=";padding: 0px;border: 0px">注意:</strong>&nbsp;WebKit Nightly 和 Safari Technology Preview 为<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept" title="Accept 请求头用来告知客户端可以处理的内容类型，这种内容类型用MIME类型来表示。借助内容协商机制, 服务器可以从诸多备选项中选择一项进行应用，并使用 Content-Type 应答头通知客户端它的选择。浏览器会基于请求的上下文来为这个请求头设置合适的值，比如获取一个CSS层叠样式表时值与获取图片、视频或脚本文件时的值是不同的。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word;font-size: 1rem">Accept</code></a>,&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept-Language" title="Accept-Language请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。借助内容协商机制，服务器可以从诸多备选项中选择一项进行应用， 并使用Content-Language 应答头通知客户端它的选择。浏览器会基于其用户界面语言来为这个请求头设置合适的值，即便是用户可以进行修改，但是这种情况极少发生 (and is frown upon as it leads to fingerprinting)。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word;font-size: 1rem">Accept-Language</code></a>, 和&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Language" title="Content-Language 是一个 entity header （实体消息首部），用来说明访问者希望采用的语言或语言组合，这样的话用户就可以根据自己偏好的语言来定制不同的内容。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word;font-size: 1rem">Content-Language</code></a>&nbsp;首部字段的值添加了额外的限制。如果这些首部字段的值是“非标准”的，WebKit/Safari 就不会将这些请求视为“简单请求”。WebKit/Safari 并没有在文档中列出哪些值是“非标准”的，不过我们可以在这里找到相关讨论：<a href="https://bugs.webkit.org/show_bug.cgi?id=165178" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Require preflight for non-standard CORS-safelisted request headers Accept, Accept-Language, and Content-Language</a>,&nbsp;<a href="https://bugs.webkit.org/show_bug.cgi?id=165566" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Allow commas in Accept, Accept-Language, and Content-Language request headers for simple CORS</a>, and&nbsp;<a href="https://bugs.webkit.org/show_bug.cgi?id=166363" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Switch to a blacklist model for restricted Accept headers in simple CORS requests</a>。其它浏览器并不支持这些额外的限制，因为它们不属于规范的一部分。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">比如说，假如站点 http://foo.example 的网页应用想要访问 http://bar.other 的资源。http://foo.example 的网页中可能包含类似于下面的&nbsp;JavaScript 代码：</p><pre class="brush:js;toolbar:false">var&nbsp;invocation&nbsp;=&nbsp;new&nbsp;XMLHttpRequest();
var&nbsp;url&nbsp;=&nbsp;&#39;http://bar.other/resources/public-data/&#39;;

function&nbsp;callOtherDomain()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(invocation)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.open(&#39;GET&#39;,&nbsp;url,&nbsp;true);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.onreadystatechange&nbsp;=&nbsp;handler;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.send();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><span style=";padding: 0px;border: 0px">客户端和服务器之间使用 CORS 首部字段来处理跨域权限：</span></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><img src="{{site.assets_url}}img/20180831/1535691309198035146.png" alt=""/></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">分别检视请求报文和响应报文：</p><pre class="brush:plain;toolbar:false">GET&nbsp;/resources/public-data/&nbsp;HTTP/1.1
Host:&nbsp;bar.other
User-Agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;U;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10.5;&nbsp;en-US;&nbsp;rv:1.9.1b3pre)&nbsp;Gecko/20081130&nbsp;Minefield/3.1b3pre
Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language:&nbsp;en-us,en;q=0.5
Accept-Encoding:&nbsp;gzip,deflate
Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection:&nbsp;keep-alive
Referer:&nbsp;http://foo.example/examples/access-control/simpleXSInvocation.html
Origin:&nbsp;http://foo.example


HTTP/1.1&nbsp;200&nbsp;OK
Date:&nbsp;Mon,&nbsp;01&nbsp;Dec&nbsp;2008&nbsp;00:23:53&nbsp;GMT
Server:&nbsp;Apache/2.0.61&nbsp;
Access-Control-Allow-Origin:&nbsp;*
Keep-Alive:&nbsp;timeout=2,&nbsp;max=100
Connection:&nbsp;Keep-Alive
Transfer-Encoding:&nbsp;chunked
Content-Type:&nbsp;application/xml

[XML&nbsp;Data]</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">第 1~10 行是请求首部。第10行 的请求首部字段&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Origin" title="请求首部字段&nbsp;Origin&nbsp;指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。该首部用于 CORS 请求或者 POST 请求。除了不包含路径信息，该字段与 Referer 首部字段相似。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Origin</code></a>&nbsp;表明该请求来源于&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">http://foo.exmaple</code>。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">第 13~22 行是来自于&nbsp;http://bar.other 的服务端响应。响应中携带了响应首部字段&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" title="如需允许所有资源都可以访问您的资源，您可以如此设置：" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin</code></a>（第 16 行）。使用&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Origin" title="请求首部字段&nbsp;Origin&nbsp;指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。该首部用于 CORS 请求或者 POST 请求。除了不包含路径信息，该字段与 Referer 首部字段相似。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Origin</code></a>&nbsp;和&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" title="如需允许所有资源都可以访问您的资源，您可以如此设置：" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin</code></a>&nbsp;就能完成最简单的访问控制。本例中，服务端返回的&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin: *</code>&nbsp;表明，该资源可以被<strong style=";padding: 0px;border: 0px">任意</strong>外域访问。如果服务端仅允许来自 http://foo.example 的访问，该首部字段的内容如下：</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin: http://foo.example</code></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">现在，除了 http://foo.example，其它外域均不能访问该资源（该策略由请求首部中的&nbsp;ORIGIN 字段定义，见第10行）。<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin</code>&nbsp;应当为 * 或者包含由 Origin 首部字段所指明的域名。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E9%A2%84%E6%A3%80%E8%AF%B7%E6%B1%82" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">预检请求</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">与前述简单请求不同，“需预检的请求”要求必须首先使用&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/OPTIONS" title="HTTP 的&nbsp;OPTIONS 方法&nbsp;用于获取目的资源所支持的通信选项。客户端可以对特定的 URL 使用 OPTIONS 方法，也可以对整站（通过将 URL 设置为“*”）使用该方法。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">OPTIONS</code></a>&nbsp;&nbsp; 方法发起一个预检请求到服务器，以获知服务器是否允许该实际请求。&quot;预检请求“的使用，可以避免跨域请求对服务器的用户数据产生未预期的影响。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">当请求满足下述任一条件时，即应首先发送预检请求：</p><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p>使用了下面任一&nbsp;HTTP&nbsp;方法：</p></li><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/PUT" title="请求方法 PUT &nbsp;用于新增资源或者使用请求中的有效负载替换目标资源的表现形式。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">PUT</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/DELETE" title="HTTP DELETE 请求方法用于删除指定的资源。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">DELETE</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/CONNECT" title="在 HTTP 协议中，CONNECT&nbsp;方法可以开启一个客户端与所请求资源之间的双向沟通的通道。它可以用来创建隧道（tunnel）。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">CONNECT</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/OPTIONS" title="HTTP 的&nbsp;OPTIONS 方法&nbsp;用于获取目的资源所支持的通信选项。客户端可以对特定的 URL 使用 OPTIONS 方法，也可以对整站（通过将 URL 设置为“*”）使用该方法。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">OPTIONS</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/TRACE" title="HTTP TRACE 方法 实现沿通向目标资源的路径的消息环回（loop-back）测试 ，提供了一种实用的 debug 机制。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">TRACE</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Methods/PATCH" title="在HTTP协议中，请求方法&nbsp;PATCH &nbsp;用于对资源进行部分修改。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">PATCH</code></a></p></li></ul><li><p>人为设置了<a href="https://fetch.spec.whatwg.org/#cors-safelisted-request-header" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">对 CORS 安全的首部字段集合</a>之外的其他首部字段。该集合为：</p></li><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept" title="Accept 请求头用来告知客户端可以处理的内容类型，这种内容类型用MIME类型来表示。借助内容协商机制, 服务器可以从诸多备选项中选择一项进行应用，并使用 Content-Type 应答头通知客户端它的选择。浏览器会基于请求的上下文来为这个请求头设置合适的值，比如获取一个CSS层叠样式表时值与获取图片、视频或脚本文件时的值是不同的。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Accept</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept-Language" title="Accept-Language请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。借助内容协商机制，服务器可以从诸多备选项中选择一项进行应用， 并使用Content-Language 应答头通知客户端它的选择。浏览器会基于其用户界面语言来为这个请求头设置合适的值，即便是用户可以进行修改，但是这种情况极少发生 (and is frown upon as it leads to fingerprinting)。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Accept-Language</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Language" title="Content-Language 是一个 entity header （实体消息首部），用来说明访问者希望采用的语言或语言组合，这样的话用户就可以根据自己偏好的语言来定制不同的内容。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Content-Language</code></a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type" title="Content-Type 实体头部用于指示资源的MIME类型&nbsp;media type&nbsp;。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Content-Type</code></a>&nbsp;(but note the additional requirements below)</p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#dpr" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">DPR</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#downlink" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Downlink</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#save-data" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Save-Data</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#viewport-width" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Viewport-Width</a></code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="http://httpwg.org/http-extensions/client-hints.html#width" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Width</a></code></p></li></ul><li><p>&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Type" title="Content-Type 实体头部用于指示资源的MIME类型&nbsp;media type&nbsp;。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Content-Type</code></a>&nbsp;的值不属于下列之一:</p></li><ul style="list-style-type: square;" class=" list-paddingleft-2"><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">application/x-www-form-urlencoded</code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">multipart/form-data</code></p></li><li><p><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">text/plain</code></p></li></ul><li><p>请求中的<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequestUpload" title="此页面仍未被本地化, 期待您的翻译!" style="color: rgb(153, 0, 0);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequestUpload</code></a>&nbsp;对象注册了任意多个事件监听器。</p></li><li><p>请求中使用了<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ReadableStream" title="Fetch API&nbsp;的&nbsp;ReadableStream&nbsp;接口标识了一个可读的二进制数据流" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">ReadableStream</code></a>对象。</p></li></ul><p style="margin-bottom: 0px;padding: 0px;border: 0px;max-width: 42rem"><span style=";padding: 0px;border: 0px;font-weight: 700">注意:</span>&nbsp;WebKit Nightly 和 Safari Technology Preview 为<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept" title="Accept 请求头用来告知客户端可以处理的内容类型，这种内容类型用MIME类型来表示。借助内容协商机制, 服务器可以从诸多备选项中选择一项进行应用，并使用 Content-Type 应答头通知客户端它的选择。浏览器会基于请求的上下文来为这个请求头设置合适的值，比如获取一个CSS层叠样式表时值与获取图片、视频或脚本文件时的值是不同的。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word;font-size: 1rem">Accept</code></a>,&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Accept-Language" title="Accept-Language请求头允许客户端声明它可以理解的自然语言，以及优先选择的区域方言。借助内容协商机制，服务器可以从诸多备选项中选择一项进行应用， 并使用Content-Language 应答头通知客户端它的选择。浏览器会基于其用户界面语言来为这个请求头设置合适的值，即便是用户可以进行修改，但是这种情况极少发生 (and is frown upon as it leads to fingerprinting)。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word;font-size: 1rem">Accept-Language</code></a>, 和&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Content-Language" title="Content-Language 是一个 entity header （实体消息首部），用来说明访问者希望采用的语言或语言组合，这样的话用户就可以根据自己偏好的语言来定制不同的内容。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word;font-size: 1rem">Content-Language</code></a>&nbsp;首部字段的值添加了额外的限制。如果这些首部字段的值是“非标准”的，WebKit/Safari 就不会将这些请求视为“简单请求”。WebKit/Safari 并没有在文档中列出哪些值是“非标准”的，不过我们可以在这里找到相关讨论：<a href="https://bugs.webkit.org/show_bug.cgi?id=165178" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Require preflight for non-standard CORS-safelisted request headers Accept, Accept-Language, and Content-Language</a>,&nbsp;<a href="https://bugs.webkit.org/show_bug.cgi?id=165566" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Allow commas in Accept, Accept-Language, and Content-Language request headers for simple CORS</a>, and&nbsp;<a href="https://bugs.webkit.org/show_bug.cgi?id=166363" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Switch to a blacklist model for restricted Accept headers in simple CORS requests</a>。其它浏览器并不支持这些额外的限制，因为它们不属于规范的一部分。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">如下是一个需要执行预检请求的 HTTP 请求：</p><pre class="brush:js;toolbar:false">var&nbsp;invocation&nbsp;=&nbsp;new&nbsp;XMLHttpRequest();
var&nbsp;url&nbsp;=&nbsp;&#39;http://bar.other/resources/post-here/&#39;;
var&nbsp;body&nbsp;=&nbsp;&#39;&lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;&lt;person&gt;&lt;name&gt;Arun&lt;/name&gt;&lt;/person&gt;&#39;;

function&nbsp;callOtherDomain()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(invocation)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.open(&#39;POST&#39;,&nbsp;url,&nbsp;true);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.setRequestHeader(&#39;X-PINGOTHER&#39;,&nbsp;&#39;pingpong&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.setRequestHeader(&#39;Content-Type&#39;,&nbsp;&#39;application/xml&#39;);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.onreadystatechange&nbsp;=&nbsp;handler;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.send(body);
&nbsp;&nbsp;&nbsp;&nbsp;}
}......</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">上面的代码使用&nbsp;POST 请求发送一个 XML 文档，该请求包含了一个自定义的请求首部字段（X-PINGOTHER: pingpong）。另外，该请求的 Content-Type 为&nbsp;application/xml。因此，该请求需要首先发起“预检请求”。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><img src="{{site.assets_url}}img/20180831/1535691310065005417.png" alt=""/></p><pre class="brush:plain;toolbar:false">&nbsp;1.OPTIONS&nbsp;/resources/post-here/&nbsp;HTTP/1.1
&nbsp;2.Host:&nbsp;bar.other
&nbsp;3.User-Agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;U;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10.5;&nbsp;en-US;&nbsp;rv:1.9.1b3pre)&nbsp;Gecko/20081130&nbsp;Minefield/3.1b3pre
&nbsp;4.Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
&nbsp;5.Accept-Language:&nbsp;en-us,en;q=0.5
&nbsp;6.Accept-Encoding:&nbsp;gzip,deflate
&nbsp;7.Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7
&nbsp;8.Connection:&nbsp;keep-alive
&nbsp;9.Origin:&nbsp;http://foo.example
10.Access-Control-Request-Method:&nbsp;POST
11.Access-Control-Request-Headers:&nbsp;X-PINGOTHER,&nbsp;Content-Type
12.
13.
14.HTTP/1.1&nbsp;200&nbsp;OK
15.Date:&nbsp;Mon,&nbsp;01&nbsp;Dec&nbsp;2008&nbsp;01:15:39&nbsp;GMT
16.Server:&nbsp;Apache/2.0.61&nbsp;(Unix)
17.Access-Control-Allow-Origin:&nbsp;http://foo.example
18.Access-Control-Allow-Methods:&nbsp;POST,&nbsp;GET,&nbsp;OPTIONS
19.Access-Control-Allow-Headers:&nbsp;X-PINGOTHER,&nbsp;Content-Type
20.Access-Control-Max-Age:&nbsp;86400
21.Vary:&nbsp;Accept-Encoding,&nbsp;Origin
22.Content-Encoding:&nbsp;gzip
23.Content-Length:&nbsp;0
24.Keep-Alive:&nbsp;timeout=2,&nbsp;max=100
25.Connection:&nbsp;Keep-Alive
26.Content-Type:&nbsp;text/plain</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">预检请求完成之后，发送实际请求：</p><pre class="brush:plain;toolbar:false">POST&nbsp;/resources/post-here/&nbsp;HTTP/1.1
Host:&nbsp;bar.other
User-Agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;U;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10.5;&nbsp;en-US;&nbsp;rv:1.9.1b3pre)&nbsp;Gecko/20081130&nbsp;Minefield/3.1b3pre
Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language:&nbsp;en-us,en;q=0.5
Accept-Encoding:&nbsp;gzip,deflate
Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection:&nbsp;keep-alive
X-PINGOTHER:&nbsp;pingpong
Content-Type:&nbsp;text/xml;&nbsp;charset=UTF-8
Referer:&nbsp;http://foo.example/examples/preflightInvocation.html
Content-Length:&nbsp;55
Origin:&nbsp;http://foo.example
Pragma:&nbsp;no-cache
Cache-Control:&nbsp;no-cache

&lt;?xml&nbsp;version=&quot;1.0&quot;?&gt;&lt;person&gt;&lt;name&gt;Arun&lt;/name&gt;&lt;/person&gt;


HTTP/1.1&nbsp;200&nbsp;OK
Date:&nbsp;Mon,&nbsp;01&nbsp;Dec&nbsp;2008&nbsp;01:15:40&nbsp;GMT
Server:&nbsp;Apache/2.0.61&nbsp;(Unix)
Access-Control-Allow-Origin:&nbsp;http://foo.example
Vary:&nbsp;Accept-Encoding,&nbsp;Origin
Content-Encoding:&nbsp;gzip
Content-Length:&nbsp;235
Keep-Alive:&nbsp;timeout=2,&nbsp;max=99
Connection:&nbsp;Keep-Alive
Content-Type:&nbsp;text/plain

[Some&nbsp;GZIP&#39;d&nbsp;payload]</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">浏览器检测到，从 JavaScript 中发起的请求需要被预检。从上面的报文中，我们看到，第&nbsp;1~12&nbsp;行发送了一个使用&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">OPTIONS&nbsp;方法的“</code>预检请求<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">”。</code>&nbsp;OPTIONS 是 HTTP/1.1 协议中定义的方法，用以从服务器获取更多信息。该方法不会对服务器资源产生影响。 预检请求中同时携带了下面两个首部字段：</p><pre class="brush:plain;toolbar:false">Access-Control-Request-Method:&nbsp;POST
Access-Control-Request-Headers:&nbsp;X-PINGOTHER,&nbsp;Content-Type</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">首部字段 Access-Control-Request-Method 告知服务器，实际请求将使用 POST 方法。<span style="font-family:Open Sans, Arial, sans-serif">首部字段&nbsp;</span></code><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Request-Headers 告知服务器，实际请求将携带两个自定义请求首部字段：<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">X-PINGOTHER 与 Content-Type。服务器据此决定，该实际请求是否被允许。</code></code></code></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">第14~26&nbsp;行为预检请求的响应，表明服务器将接受后续的实际请求。重点看第 17~20 行：</p><pre class="brush:plain;toolbar:false">Access-Control-Allow-Origin:&nbsp;http://foo.example
Access-Control-Allow-Methods:&nbsp;POST,&nbsp;GET,&nbsp;OPTIONS
Access-Control-Allow-Headers:&nbsp;X-PINGOTHER,&nbsp;Content-Type
Access-Control-Max-Age:&nbsp;86400</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><span style="font-family:Open Sans, Arial, sans-serif">首部字段</span><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><span style="font-family:Open Sans, Arial, sans-serif">&nbsp;</span>Access-Control-Allow-Methods&nbsp;</code>表明服务器允许客户端使用<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">&nbsp;</code><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">POST,</code>&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">GET&nbsp;</code>和&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">OPTIONS</code>&nbsp;方法发起请求。该字段与&nbsp;<a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.7" class="external external-icon" title="http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.7" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">HTTP/1.1 Allow: response header</a>&nbsp;类似，但仅限于在需要访问控制的场景中使用。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">首部字段&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Headers&nbsp;</code>表明服务器允许请求中携带字段&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">X-PINGOTHER</code></code>与<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">&nbsp;Content-Type</code></code>。<span style="font-family:Open Sans, Arial, sans-serif">与</span><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><span style="font-family:Open Sans, Arial, sans-serif">&nbsp;</span></code></code><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Methods&nbsp;</code>一样，<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Headers</code></code>&nbsp;的值为逗号分割的列表。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">最后，首部字段&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Max-Age</code>&nbsp;表明该响应的有效时间为 86400 秒，也就是 24 小时。在有效时间内，浏览器无须为同一请求再次发起预检请求。请注意，浏览器自身维护了一个最大有效时间，如果该首部字段的值超过了最大有效时间，将不会生效。</p><h4 style="line-height: 1.2;margin: 30px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.375rem;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)">预检请求与重定向</h4><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">大多数浏览器不支持针对于预检请求的重定向。如果一个预检请求发生了重定向，浏览器将报告错误：</p><blockquote style="padding: 20px 0px;border-width: 3px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(131, 208, 242);border-image: initial;max-width: 42rem;font-size: 1.25rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;white-space: normal;background-color: rgb(255, 255, 255)"><p style="padding: 0px;border: 0px;max-width: 42rem">The request was redirected to &#39;https://example.com/foo&#39;, which is disallowed for cross-origin requests that require preflight</p></blockquote><blockquote style="padding: 20px 0px;border-width: 3px 0px;border-top-style: solid;border-right-style: solid;border-bottom-style: solid;border-color: rgb(131, 208, 242);border-image: initial;max-width: 42rem;font-size: 1.25rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;white-space: normal;background-color: rgb(255, 255, 255)"><p style="padding: 0px;border: 0px;max-width: 42rem">Request requires preflight, which is disallowed to follow cross-origin redirect</p></blockquote><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">CORS 最初要求该行为，不过<a href="https://github.com/whatwg/fetch/commit/0d9a4db8bc02251cc9e391543bb3c1322fb882f2" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">在后续的修订中废弃了这一要求</a>。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">在浏览器的实现跟上规范之前，有两种方式规避上述报错行为：</p><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p>在服务端去掉对预检请求的重定向；</p></li><li><p>将实际请求变成一个简单请求。</p></li></ul><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">如果上面两种方式难以做到，我们仍有其他办法：</p><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p>发出一个简单请求（使用 &nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/url" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Response.url</a>&nbsp;或&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">XHR.responseURL</a>）以判断真正的预检请求会返回什么地址。</p></li><li><p>发出另一个请求（真正的请求），使用在上一步通过<a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/url" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Response.url</a>&nbsp;或&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/responseURL" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">XMLHttpRequest.responseURL</a>获得的URL。</p></li></ul><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">不过，如果请求是由于存在&nbsp;Authorization 字段而引发了预检请求，则这一方法将无法使用。这种情况只能由服务端进行更改。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E9%99%84%E5%B8%A6%E8%BA%AB%E4%BB%BD%E5%87%AD%E8%AF%81%E7%9A%84%E8%AF%B7%E6%B1%82" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">附带身份凭证的请求</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Fetch</a>&nbsp;与&nbsp;CORS 的一个有趣的特性是，可以基于 &nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">HTTP cookies</a>&nbsp;和 HTTP 认证信息发送身份凭证。一般而言，对于跨域&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" title="XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code></a>&nbsp;或&nbsp;<a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Fetch</a>&nbsp;请求，浏览器<strong style=";padding: 0px;border: 0px">不会</strong>发送身份凭证信息。如果要发送凭证信息，需要设置&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="https://developer.mozilla.org/en/DOM/XMLHttpRequest" title="En/XMLHttpRequest" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">XMLHttpRequest</a>&nbsp;</code>的某个特殊标志位。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">本例中，http://foo.example 的某脚本向&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">http://bar.other 发起一个GET 请求，并设置&nbsp;Cookies：</code></code></p><pre class="brush:js;toolbar:false">var&nbsp;invocation&nbsp;=&nbsp;new&nbsp;XMLHttpRequest();
var&nbsp;url&nbsp;=&nbsp;&#39;http://bar.other/resources/credentialed-content/&#39;;

function&nbsp;callOtherDomain()&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(invocation)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.open(&#39;GET&#39;,&nbsp;url,&nbsp;true);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.withCredentials&nbsp;=&nbsp;true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.onreadystatechange&nbsp;=&nbsp;handler;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;invocation.send();
&nbsp;&nbsp;&nbsp;&nbsp;}
}</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">第 7&nbsp;行将&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word"><a href="https://developer.mozilla.org/en/DOM/XMLHttpRequest" title="En/XMLHttpRequest" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">XMLHttpRequest</a>&nbsp;</code>的&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">withCredentials 标志设置为 true，</code>从而向服务器发送&nbsp;Cookies。因为这是一个简单&nbsp;GET 请求，所以浏览器不会对其发起“预检请求”。但是，如果服务器端的响应中未携带&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Credentials: true&nbsp;，浏览器将不会把响应内容返回给请求的发送者。</code></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><img src="{{site.assets_url}}img/20180831/1535691311050008295.png" alt=""/></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">客户端与服务器端交互示例如下：</p><pre class="brush:plain;toolbar:false">GET&nbsp;/resources/access-control-with-credentials/&nbsp;HTTP/1.1
Host:&nbsp;bar.other
User-Agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;)&nbsp;Gecko/20081130&nbsp;Minefield/3.1b3pre
Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language:&nbsp;en-us,en;q=0.5
Accept-Encoding:&nbsp;gzip,deflate
Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection:&nbsp;keep-alive
Referer:&nbsp;http://foo.example/examples/credential.html
Origin:&nbsp;http://foo.example
Cookie:&nbsp;pageAccess=2


HTTP/1.1&nbsp;200&nbsp;OK
Date:&nbsp;Mon,&nbsp;01&nbsp;Dec&nbsp;2008&nbsp;01:34:52&nbsp;GMT
Server:&nbsp;Apache/2.0.61&nbsp;(Unix)&nbsp;PHP/4.4.7&nbsp;mod_ssl/2.0.61&nbsp;OpenSSL/0.9.7e
X-Powered-By:&nbsp;PHP/5.2.6
Access-Control-Allow-Origin:&nbsp;http://foo.example
Access-Control-Allow-Credentials:&nbsp;true
Cache-Control:&nbsp;no-cache
Pragma:&nbsp;no-cache
Set-Cookie:&nbsp;pageAccess=3;&nbsp;expires=Wed,&nbsp;31-Dec-2008&nbsp;01:34:53&nbsp;GMT
Vary:&nbsp;Accept-Encoding,&nbsp;Origin
Content-Encoding:&nbsp;gzip
Content-Length:&nbsp;106
Keep-Alive:&nbsp;timeout=2,&nbsp;max=100
Connection:&nbsp;Keep-Alive
Content-Type:&nbsp;text/plain


[text/plain&nbsp;payload]</pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">即使第 11 行指定了 Cookie 的相关信息，但是，如果 bar.other 的响应中缺失&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" title="Access-Control-Allow-Credentials&nbsp;响应头表示是否可以将对请求的响应暴露给页面。返回true则可以，其他值均不可以。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Credentials</code></a><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">: true（</code>第 19 行），则响应内容不会返回给请求的发起者。</p><h4 style="line-height: 1.2;margin: 30px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.375rem;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)">附带身份凭证的请求与通配符</h4><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">对于附带身份凭证的请求，服务器不得设置&nbsp;<code style=";padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin 的值为“*”。</code></p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><code style=";padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">这是因为请求的首部中携带了 Cookie 信息，如果&nbsp;Access-Control-Allow-Origin 的值为“*”，请求将会失败。而将&nbsp;Access-Control-Allow-Origin 的值设置为&nbsp;</code>http://foo.example，则请求将成功执行。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">另外，响应首部中也携带了 Set-Cookie 字段，尝试对 Cookie 进行修改。如果操作失败，将会抛出异常。</p><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#HTTP_%E5%93%8D%E5%BA%94%E9%A6%96%E9%83%A8%E5%AD%97%E6%AE%B5" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>HTTP 响应首部字段</h2><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">本节列出了规范所定义的响应首部字段。上一小节中，我们已经看到了这些首部字段在实际场景中是如何工作的。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Origin" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Allow-Origin</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">响应首部中可以携带一个&nbsp;<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Origin" title="如需允许所有资源都可以访问您的资源，您可以如此设置：" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Origin</code></a><code style=";padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">&nbsp;字段，其语法如下:</code></p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Allow-Origin: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>origin</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span> | *<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">其中，origin 参数的值指定了允许访问该资源的外域&nbsp;URI。对于不需要携带身份凭证的请求，服务器可以指定该字段的值为通配符，表示允许来自所有域的请求。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">例如，下面的字段值将允许来自&nbsp;http://mozilla.com 的请求：</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Allow-Origin: http://mozilla.com<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">如果服务端指定了具体的域名而非“*”，那么响应首部中的 Vary 字段的值必须包含 Origin。这将告诉客户端：服务器对不同的源站返回不同的内容。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Expose-Headers" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Expose-Headers</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">译者注：在跨域访问时，XMLHttpRequest对象的getResponseHeader()方法只能拿到一些最基本的响应头，Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma，如果要访问其他头，则需要服务器设置本响应头。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Expose-Headers" title="响应首部&nbsp;Access-Control-Expose-Headers 列出了哪些首部可以作为响应的一部分暴露给外部。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Expose-Headers</code></a>&nbsp;头让服务器把允许浏览器访问的头放入白名单，例如：</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Expose-Headers: X-My-Custom-Header, X-Another-Custom-Header<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">这样浏览器就能够通过getResponseHeader访问<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">X-My-Custom-Header</code>和&nbsp;<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">X-Another-Custom-Header</code>&nbsp;响应头了<code style=";padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">。</code></p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Max-Age" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Max-Age</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Max-Age" title="The Access-Control-Max-Age&nbsp;这个响应首部表示 preflight request &nbsp;（预检请求）的返回结果（即&nbsp;Access-Control-Allow-Methods 和Access-Control-Allow-Headers 提供的信息）&nbsp;可以被缓存多久。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Max-Age</code></a>&nbsp;头指定了preflight请求的结果能够被缓存多久，请参考本文在前面提到的preflight例子。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Max-Age: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>delta-seconds</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span><span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">delta-seconds</code>&nbsp;参数表示preflight请求的结果在多少秒内有效。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Credentials" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Allow-Credentials</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials" title="Access-Control-Allow-Credentials&nbsp;响应头表示是否可以将对请求的响应暴露给页面。返回true则可以，其他值均不可以。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Credentials</code></a>&nbsp;头指定了当浏览器的<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">credentials</code>设置为true时是否允许浏览器读取response的内容。当用在对preflight预检测请求的响应中时，它指定了实际的请求是否可以使用<code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">credentials</code>。请注意：简单 GET 请求不会被预检；如果对此类请求的响应中不包含该字段，这个响应将被忽略掉，并且浏览器也不会将相应内容返回给网页。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Allow-Credentials: true<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">上文已经讨论了<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Requests_with_credentials" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">附带身份凭证的请求</a>。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Methods" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Allow-Methods</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Methods" title="响应首部 Access-Control-Allow-Methods 在对 preflight request.（预检请求）的应答中明确了客户端所要访问的资源允许使用的方法或方法列表。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Methods</code></a>&nbsp;首部字段用于预检请求的响应。其指明了实际请求所允许使用的&nbsp;HTTP 方法。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Allow-Methods: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>method</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span>[, <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>method</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span>]*<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">相关示例见<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS$edit#Preflighted_requests" style="color: rgb(153, 0, 0);padding: 0px;border: 0px">这里</a>。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Headers" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Allow-Headers</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Allow-Headers" title="响应首部&nbsp;Access-Control-Allow-Headers 用于 preflight request （预检请求）中，列出了将会在正式请求的 Access-Control-Expose-Headers 字段中出现的首部信息。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Allow-Headers</code></a>&nbsp;首部字段用于预检请求的响应。其指明了实际请求中允许携带的首部字段。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Allow-Headers: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>field-name</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span>[, <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>field-name</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span>]*<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#HTTP_%E8%AF%B7%E6%B1%82%E9%A6%96%E9%83%A8%E5%AD%97%E6%AE%B5" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>HTTP 请求首部字段</h2><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">本节列出了可用于发起跨域请求的首部字段。请注意，这些首部字段无须手动设置。&nbsp;当开发者使用&nbsp;XMLHttpRequest 对象发起跨域请求时，它们已经被设置就绪。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Origin" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Origin</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Origin" title="请求首部字段&nbsp;Origin&nbsp;指示了请求来自于哪个站点。该字段仅指示服务器名称，并不包含任何路径信息。该首部用于 CORS 请求或者 POST 请求。除了不包含路径信息，该字段与 Referer 首部字段相似。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Origin</code></a>&nbsp;首部字段表明预检请求或实际请求的源站。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Origin: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>origin</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span><span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">origin 参数的值为源站&nbsp;URI。它不包含任何路径信息，只是服务器名称。</p><p><strong style=";padding: 0px;border: 0px">Note:</strong>&nbsp;有时候将该字段的值设置为空字符串是有用的，例如，当源站是一个 data URL 时。</p><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">注意，不管是否为跨域请求，ORIGIN 字段总是被发送。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Request-Method" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Request-Method</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Method" title="The compatibility table in this page is generated from structured data. If you&#39;d like to contribute to the data, please check out https://github.com/mdn/browser-compat-data and send us a pull request." style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Request-Method</code></a>&nbsp;首部字段用于预检请求。其作用是，将实际请求所使用的 HTTP 方法告诉服务器。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Request-Method: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>method</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span><span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">相关示例见<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Preflighted_requests" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">这里</a>。</p><h3 style="line-height: 1.25;margin-right: 0px;margin-bottom: 20px;margin-left: 0px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.5rem;background-color: rgb(255, 255, 255);color: rgb(51, 51, 51);-webkit-box-decoration-break: clone;white-space: normal"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#Access-Control-Request-Headers" style="color: inherit;margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a><span style=";padding: 0px 4px 0px 40px;border: 0px;background-color: rgb(51, 51, 51);color: rgb(255, 255, 255);line-height: 1.25;-webkit-box-decoration-break: clone">Access-Control-Request-Headers</span></h3><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Access-Control-Request-Headers" title="请求首部&nbsp;&nbsp;Access-Control-Request-Headers&nbsp;出现于 preflight request （预检请求）中，用于通知服务器在真正的请求中会采用哪些请求首部。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">Access-Control-Request-Headers</code></a>&nbsp;首部字段用于预检请求。其作用是，将实际请求所携带的首部字段告诉服务器。</p><pre class="line-numbers  language-html" style="margin-bottom: 20px;padding: 15px 15px 15px 3.8em;border-top-width: 0px;border-color: rgb(63, 135, 166);border-bottom-width: 0px;font-size: medium;background: rgb(238, 238, 238);position: relative;font-family: consolas, monaco, &#39;Andale Mono&#39;, monospace;line-height: 1.5;hyphens: none;width: 853.375px;max-width: 100%;text-shadow: none;word-wrap: normal;counter-reset: linenumber 0;border-right-width: 0px !important;border-left-width: 5px !important;direction: ltr !important"><code class=" language-html" style=";border: 0px;font-weight: inherit;border-radius: 2px;font-family: Consolas, Monaco, &#39;Andale Mono&#39;, &#39;Ubuntu Mono&#39;, monospace;word-wrap: normal;color: rgb(51, 51, 51);text-shadow: none;direction: ltr;white-space: pre;word-spacing: normal;line-height: 1.5;hyphens: none;position: relative">Access-Control-Request-Headers: <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>field-name</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span>[, <span class="token tag" style=";padding: 0px;border: 0px;color: rgb(153, 0, 85)"><span class="token tag" style="padding: 0px;"><span class="token punctuation" style=";padding: 0px;border: 0px;color: rgb(153, 153, 153)">&lt;</span>field-name</span><span class="token punctuation" style="padding: 0px; color: rgb(153, 153, 153);">&gt;</span></span>]*<span style=";padding: 0px;border-width: 0px 1px 0px 0px;border-top-style: initial;border-right-style: solid;border-bottom-style: initial;border-left-style: initial;border-top-color: initial;border-right-color: rgb(153, 153, 153);border-bottom-color: initial;border-left-color: initial;border-image: initial;display: block;position: absolute;pointer-events: none;top: 0px;font-size: 16px;left: -3.8em;width: 3em;letter-spacing: -1px;user-select: none"></span></code></pre><p style="margin-bottom: 24px;padding: 0px;border: 0px;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)">相关示例见<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">这里</a>。</p><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E8%A7%84%E8%8C%83" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>规范</h2><table width="853"><tbody style=";padding: 0px;border: 0px"><tr style=";padding: 0px;border: 0px" class="firstRow"><th style="font-style: inherit;padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220);font-weight: inherit">Specification</th><th style="font-style: inherit;padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220);font-weight: inherit">Status</th><th style="font-style: inherit;padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220);font-weight: inherit">Comment</th></tr><tr style=";padding: 0px;border: 0px"><td style=";padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220)"><a href="https://fetch.spec.whatwg.org/#cors-protocol" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Fetch<br/><small>CORS</small></a></td><td style=";padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220)"><span style=";padding: 0px;border: 0px;color: rgb(0, 83, 159)">Living Standard</span></td><td style=";padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220)">New definition; supplants CORS specification.</td></tr><tr style=";padding: 0px;border: 0px"><td style=";padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220)"><a class="external external-icon" title="Unknown" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Unknown</a></td><td style=";padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220)"><span style=";padding: 0px;border: 0px">Unknown</span></td><td style=";padding: 6px 8px;border-top-width: 0px;border-left-width: 0px;border-color: rgb(224, 224, 220)">Initial definition.</td></tr></tbody></table><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>浏览器兼容性</h2><p style="margin-bottom: 20px;padding: 10px 10px 10px 30px;border-width: 0px 0px 0px 5px;border-top-style: initial;border-right-style: initial;border-bottom-style: initial;border-left-style: solid;border-color: rgb(230, 100, 101);border-image: initial;max-width: 42rem;overflow: hidden;clear: none;background: rgb(255, 231, 232);font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.125rem;color: rgb(51, 51, 51);white-space: normal"><strong style=";padding: 0px;border: 0px"><a href="https://github.com/mdn/browser-compat-data" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">We&#39;re converting our compatibility data into a machine-readable JSON format</a></strong>. This compatibility table still uses the old format, because we haven&#39;t yet converted the data it contains.&nbsp;<strong style=";padding: 0px;border: 0px"><a href="https://developer.mozilla.org/zh-CN/docs/MDN/Contribute/Structures/Compatibility_tables" style="color: rgb(153, 0, 0);padding: 0px;border: 0px">Find out how you can help!</a></strong></p><p><a id="AutoCompatibilityTable" style="color: inherit;padding: 0px;border: 0px"></a></p><ul style="margin-right: auto;margin-left: auto;padding: 0px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;display: inline;position: relative;width: 150px;top: 0px;cursor: pointer" class=" list-paddingleft-2"><li><p><a style="color: rgb(0, 0, 0);padding: 2px 18px 4px;border: 0px;cursor: pointer">Desktop</a></p></li><li><p>&nbsp;</p></li><li><p><a style="color: rgb(63, 135, 166);padding: 2px 18px 4px;border: 0px;cursor: pointer">Mobile</a></p></li></ul><table width="829"><tbody style=";padding: 0px;border: 0px"><tr style=";padding: 0px;border: 0px" class="firstRow"><th style="font-style: inherit;padding: 2px 4px 8px;border-width: initial;border-style: none;border-color: initial;font-weight: inherit;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;background-position: 0px 0px;font-size: 1rem;line-height: 1">Feature</th><th style="font-style: inherit;padding: 2px 4px 8px;border-width: initial;border-style: none;border-color: initial;font-weight: inherit;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;background-position: 0px 0px;font-size: 1rem;line-height: 1">Chrome</th><th style="font-style: inherit;padding: 2px 4px 8px;border-width: initial;border-style: none;border-color: initial;font-weight: inherit;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;background-position: 0px 0px;font-size: 1rem;line-height: 1">Firefox (Gecko)</th><th style="font-style: inherit;padding: 2px 4px 8px;border-width: initial;border-style: none;border-color: initial;font-weight: inherit;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;background-position: 0px 0px;font-size: 1rem;line-height: 1">Internet Explorer</th><th style="font-style: inherit;padding: 2px 4px 8px;border-width: initial;border-style: none;border-color: initial;font-weight: inherit;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;background-position: 0px 0px;font-size: 1rem;line-height: 1">Opera</th><th style="font-style: inherit;padding: 2px 4px 8px;border-width: initial;border-style: none;border-color: initial;font-weight: inherit;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;background-position: 0px 0px;font-size: 1rem;line-height: 1">Safari</th></tr><tr style=";padding: 0px;border: 0px"><td style=";padding-right: 5px;padding-left: 5px;border-color: rgba(212, 221, 228, 0.25);font-size: 12px;vertical-align: top;word-wrap: break-word">Basic support</td><td style=";padding-right: 5px;padding-left: 5px;border-color: rgba(212, 221, 228, 0.25);font-size: 12px;vertical-align: top;word-wrap: break-word">4</td><td style=";padding-right: 5px;padding-left: 5px;border-color: rgba(212, 221, 228, 0.25);font-size: 12px;vertical-align: top;word-wrap: break-word">3.5</td><td style=";padding-right: 5px;padding-left: 5px;border-color: rgba(212, 221, 228, 0.25);font-size: 12px;vertical-align: top;word-wrap: break-word">8 (via XDomainRequest)<br/>10</td><td style=";padding-right: 5px;padding-left: 5px;border-color: rgba(212, 221, 228, 0.25);font-size: 12px;vertical-align: top;word-wrap: break-word">12</td><td style=";padding-right: 5px;padding-left: 5px;border-color: rgba(212, 221, 228, 0.25);font-size: 12px;vertical-align: top;word-wrap: break-word">4</td></tr></tbody></table><h4 style="line-height: 1.2;margin: 30px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 1.375rem;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)">注：</h4><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p>IE 10 提供了对规范的完整支持，但在较早版本（8 和 9）中，CORS 机制是借由&nbsp;XDomainRequest 对象完成的。</p></li><li><p>Firefox 3.5 引入了对&nbsp;XMLHttpRequests 和 Web 字体的跨域支持（但最初的实现并不完整，这在后续版本中得到完善）；Firefox 7 引入了对&nbsp;WebGL 贴图的跨域支持；Firefox 9 引入了对&nbsp;drawImage 的跨域支持。</p></li></ul><h2 style="line-height: 1.2;margin: 103px 0px 20px;padding: 0px;border: 0px;font-family: x-locale-heading-primary, zillaslab, Palatino, &#39;Palatino Linotype&#39;, x-locale-heading-secondary, serif;font-size: 2.5rem;position: relative;color: rgb(51, 51, 51);white-space: normal;background-color: rgb(255, 255, 255)"><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS#%E5%8F%82%E8%A7%81" style="color: rgb(63, 135, 166);margin: 0px 10px 0px 0px;padding: 0px;border: 0px;display: inline-block;background-image: url(&#39;../../img/icons/link.b2322b32d25a.svg&#39;);background-repeat: no-repeat;width: 20px;height: 20px"><span style=";padding: 0px;border: 0px;clip: rect(0px, 0px, 0px, 0px);height: 1px;overflow: hidden;width: 1px;position: absolute !important">链接到章节</span></a>参见</h2><ul style="margin-bottom: 24px;padding: 0px 0px 0px 40px;border: 0px;list-style-position: initial;list-style-image: initial;max-width: 42rem;color: rgb(51, 51, 51);font-family: &#39;Open Sans&#39;, arial, x-locale-body, sans-serif;font-size: medium;white-space: normal;background-color: rgb(255, 255, 255)" class=" list-paddingleft-2"><li><p><a href="http://arunranga.com/examples/access-control/" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Code Samples Showing <code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code> and Cross-Origin Resource Sharing</a></p></li><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Server-Side_Access_Control" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Cross-Origin&nbsp;Resource Sharing From a Server-Side Perspective (PHP, etc.)</a></p></li><li><p><a href="http://www.w3.org/TR/cors/" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Cross-Origin Resource Sharing specification</a></p></li><li><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/XMLHttpRequest" title="XMLHttpRequest 是一个 API，它为客户端提供了在客户端和服务器之间传输数据的功能。它提供了一个通过 URL 来获取数据的简单方式，并且不会使整个页面刷新。这使得网页只更新一部分页面而不会打扰到用户。XMLHttpRequest 在 AJAX 中被大量使用。" style="color: rgb(63, 135, 166);padding: 0px;border: 0px"><code style="font-style: inherit;padding: 0px 2px;border: 0px;font-weight: inherit;background-color: rgba(220, 220, 220, 0.5);border-radius: 2px;font-family: consolas, &#39;Liberation Mono&#39;, courier, monospace;word-wrap: break-word">XMLHttpRequest</code></a></p></li><li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API" style="color: rgb(63, 135, 166);padding: 0px;border: 0px">Fetch API</a></p></li><li><p><a href="http://www.kendoui.com/blogs/teamblog/posts/11-10-03/using_cors_with_all_modern_browsers.aspx" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Using CORS with All (Modern) Browsers</a></p></li><li><p><a href="http://www.html5rocks.com/en/tutorials/cors/" class="external external-icon" style="color: rgb(63, 135, 166);padding: 0px;border: 0px;white-space: pre-line">Using CORS - HTML5 Rocks</a></p></li></ul><p><br/></p>