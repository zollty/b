---
layout: ue
title: 我的GIT使用笔记
category: 技术/开发工具
tags: GIT
keywords: "GIT"
---

<p>参考资料：</p><p>Pro Git book：<span style="line-height: 1.8;"><a href="http://git-scm.com/book/zh/v1">http://git-scm.com/book/zh/v1</a></span></p><p><br/></p><div><strong><span style="font-size: 20px;">一、常用命令</span></strong></div><p><br/></p><div><span style="font-size: 18px;"><strong>提交所有代码</strong></span></div><div>git add --all</div><div>git commit -m &#39;some messages&#39;</div><div>git push origin master</div><p><br/></p><div><span style="font-size: 18px;"><strong>同步仓库到另一个分支（比如gh-pages分支）：</strong></span></div><div>git <strong>checkout gh-pages</strong> // go to the gh-pages branch <span style="color: rgb(0, 112, 192);">切换分支</span></div><div>git <strong>rebase master</strong> // <span style="color: rgb(0, 0, 0);">bring gh-pages <span style="color: rgb(0, 112, 192);">up to date</span> with master </span></div><div><strong>git pull</strong> // <span style="color: rgb(0, 112, 192);">pull</span> before push</div><div>git <strong>push origin gh-pages</strong> // <span style="color: rgb(0, 112, 192);">commit</span> the changes</div><div>git checkout master // <span style="color: rgb(0, 112, 192);">return</span> to the master branch</div><p><br/></p><p><strong><span style="font-size: 18px;">同时向多个git仓库提交代码</span></strong></p><p>1、添加一个新地址： git remote add origin_gitlab http://10.2.10.22/3rd_custom/apollo.git&nbsp;</p><p>2、往新地址推送代码：git push origin_gitlab master <br/></p><p>如果推送失败，则先pull：</p><p>git pull&nbsp;origin_gitlab&nbsp;master</p><p>如果pull失败，报错 fatal: refusing to merge unrelated histories，则加上一个参数：</p><p>git pull origin_gitlab master --allow-unrelated-histories</p><p><br/></p><p><strong><span style="font-size: 18px;">移动文件或文件夹</span></strong></p><p>移动文件：git mv file1.txt source/file1.txt</p><p>移动文件夹：</p><p>git mv src fastdfs/fastdfs-client/</p><p><br/></p><p><span style="font-size: 18px;"><strong>将改动的代码提交到一个新分支上（自动创建）</strong></span></p><p>这个方法很重要，我在master上改了很多代码，等我commit之后，觉得不能提交到master上，决定提交到另外一个分支，</p><p>于是执行下面命令：</p><p>$ git push origin branch2</p><p>结果报错：src refspec ~ does not match any</p><p>解决方案为：</p><p>$ git push origin HEAD:branch2</p><p>参见：<a href="https://stackoverflow.com/questions/26701683/src-refspec-does-not-match-any">https://stackoverflow.com/questions/26701683/src-refspec-does-not-match-any</a></p><p><br/></p><div><span style="font-size: 20px;"><strong>创建一个tag（发布一个版本）</strong></span></div><div>例如：</div><div><span style="background-color: rgb(238, 236, 225);">git tag -a v1.1.0.RELEASE -m &#39;Release version 1.1.0.RELEASE on 11/21/2014&#39;</span></div><div><span style="background-color: rgb(238, 236, 225);">git push origin&nbsp; v1.1.0.RELEASE</span></div><div>其中&nbsp; v1.1.0.RELEASE 为 tag name</div><p><br/></p><div>删除tag，重新上传</div><div>1、先删除本地tag：git tag -d v1.2.1.RELEASE</div><div>2、然后再删除远程tag：git push origin :refs/tags/v1.2.1.RELEASE</div><div>3、然后在重新执行创建tag的过程</div><p><br/></p><p><span style="font-size: 18px;"><strong>撤销未提交(push)的commit</strong></span></p><p>1、git log查看commit id，找到提前之前的id</p><p>如下所示：</p><pre class="brush:plain;toolbar:false">$&nbsp;git&nbsp;log
commit&nbsp;6aeb1823a804d5b154ebdb4a5a293b0731dd7cdb&nbsp;(HEAD&nbsp;-&gt;&nbsp;master)
Author:&nbsp;zollty&nbsp;&lt;zollty@163.com&gt;
Date:&nbsp;&nbsp;&nbsp;Wed&nbsp;Dec&nbsp;19&nbsp;11:26:08&nbsp;2018&nbsp;+0800

&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;pom

commit&nbsp;2477fb81aa5ce01f50f377f7dd6918848e2905c2&nbsp;(origin/master,&nbsp;origin/HEAD)
Author:&nbsp;zollty&nbsp;&lt;zollty@163.com&gt;
Date:&nbsp;&nbsp;&nbsp;Sun&nbsp;Apr&nbsp;15&nbsp;20:07:14&nbsp;2018&nbsp;+0800

&nbsp;&nbsp;&nbsp;&nbsp;update

commit&nbsp;ca9b0887698f5b73d5fb3ba8f07ab13214f4f4a9
Author:&nbsp;zollty&nbsp;&lt;zolltytsou@gmail.com&gt;
Date:&nbsp;&nbsp;&nbsp;Thu&nbsp;Jan&nbsp;25&nbsp;21:12:13&nbsp;2018&nbsp;+0800</pre><p>现在HEAD在第一个的位置，我们找到第二个位置的 id：2477fb81a</p><p><br/></p><p>2、git reset --hard commit-id，注意参数hard会丢弃修改的文件。</p><p>一般情况下，不要加--hard，使用&nbsp;git reset commitid 即可。</p><p><br/></p><p>git reset&nbsp; --[soft, hard, mixed(default)] 说明</p><p><br/></p><p>首先我们来看几个术语：</p><p>HEAD</p><p>这是当前分支版本顶端的别名，也就是在当前分支你最近的一个提交</p><p>Index</p><p>index也被称为staging area，是指一整套即将被下一个提交的文件集合。他也是将成为HEAD的父亲的那个commit</p><p>Working Copy</p><p>working copy代表你正在工作的那个文件集</p><p><br/></p><p>--soft 只是重置head，更改的文件不会还原，index不会重置，意味着下次commit，不需要再add；</p><p>--mixed 意味着，更改的文件不会还原，下次提交需要重新add；</p><p>--hard 意味着彻底还原，更改的文件会还原到之前的版本，更改丢失。</p><p><br/> <br/></p><div><span style="font-size: 20px;"><strong>分支管理 </strong></span></div><div>查看<span style="color: rgb(0, 112, 192);">分支列表</span>：git branch<br/></div><div>将分支<span style="color: rgb(0, 112, 192);">切换</span>到 master：git checkout master<br/></div><div>从现有分支<span style="color: rgb(0, 112, 192);">创建</span> release分支：git branch release<br/></div><div>从现有分支<span style="color: rgb(0, 112, 192);">创建</span> release分支：git checkout -b release<br/></div><div>从 master分支<span style="color: rgb(0, 112, 192);">创建</span>新的分支：git checkout -b release master<br/></div><p><br/></p><div>将release分支 <span style="color: rgb(0, 112, 192);">push到服务器</span>：git push origin release<br/></div><p><br/></p><div>将修改 <span style="color: rgb(0, 112, 192);">merge到 maser分支</span></div><div>git checkout master</div><div>git merge release</div><div><p><br/></p><p>删除 release分支</p></div><div>git branch -d release<br/></div><p><br/></p><div><span style="font-size: 18px;">git 删除远程分支 </span></div><div><span style="background-color: rgb(238, 236, 225); font-size: 16px;">一不小心把本地的临时分支push到server上去了，想要删除。</span></div><div><span style="background-color: rgb(238, 236, 225); font-size: 16px;">一开始用</span></div><div><span style="line-height: 1.5; background-color: rgb(238, 236, 225); font-size: 16px;">git branch -r -d origin/branch-name&nbsp;</span></div><div><span style="background-color: rgb(238, 236, 225); font-size: 16px;">不成功，发现只是删除的本地对该远程分支的track，正确的方法应该是这样：</span></div><div><span style="color:#0070c0;">git push origin :branch-name </span></div><div><span style="font-size: 16px; background-color: rgb(238, 236, 225);">冒号前面的空格不能少，原理是把一个空分支push到server上，相当于删除该分支。</span></div><p><br/> <br/></p><div><strong><span style="font-size: 20px;">搭建GIT博客：</span></strong> <br/> <a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html" style="font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: left; background-color: rgb(238, 236, 225); text-decoration: underline;"><span style="background-color: rgb(238, 236, 225);">http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html</span></a> <br/> <a href="http://never.doubting.me/2013/04/18/2013-04-18-setup-octopress-on-github-step-by-step/" style="font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: left; background-color: rgb(238, 236, 225); text-decoration: underline;"><span style="background-color: rgb(238, 236, 225);">http://never.doubting.me/2013/04/18/2013-04-18-setup-octopress-on-github-step-by-step/</span></a> <br/> <a href="http://ibruce.info/2013/11/22/hexo-your-blog/" style="font-family: 微软雅黑; font-size: 14px; font-style: normal; font-weight: normal; text-align: left; background-color: rgb(238, 236, 225); text-decoration: underline;"><span style="background-color: rgb(238, 236, 225);">http://ibruce.info/2013/11/22/hexo-your-blog/</span></a> <br/></div><div><div><br/><div><div><br/><div><span style="font-size: 20px;"><strong>GIT代理设置：</strong></span></div><div>&nbsp; &nbsp; 位置：~/.gitconfig，例如</div><div>&nbsp; &nbsp; C:\Users\Administrator\.gitconfig</div><br/><div>内容如下：</div><div>[user]<br/> name&nbsp;=&nbsp;zollty<br/> email&nbsp;=&nbsp;zollty@163.com<br/> [http]<br/> proxy&nbsp;=&nbsp;http://170.17.18.80:8080<br/> [https]<br/> proxy&nbsp;=&nbsp;http://170.17.18.80:8080</div><br/></div></div></div><div><p><span style="font-size: 18px;"><strong>GIT命令下&nbsp;文件中文名&nbsp;乱码问题：</strong></span></p><p>设置一下就行了：</p><p>git config --global core.quotepath false</p><p><br/></p><p><br/></p><div><strong><span style="font-size: 20px;">Linux下GIT的使用： </span></strong><br/><div><div><div>http://www.linuxidc.com/Linux/2014-03/97821.htm <br/><div><div>最好是参见官方Help文档： <br/><div>https://help.github.com/articles/set-up-git/#platform-linux</div></div>https://help.github.com/articles/caching-your-github-password-in-git/</div></div><div>https://help.github.com/search/?utf8=%E2%9C%93&amp;q=linux</div></div></div></div></div></div><p><br/> <br/></p><div><strong><span style="font-size: 20px;">分支操作：</span></strong></div><div><p style="line-height: normal;"><span style="background-color: rgb(238, 236, 225);">查看分支：git branch <br/></span></p><p style="line-height: normal;"><span style="background-color: rgb(238, 236, 225);">创建分支：git branch &nbsp;name&nbsp;</span></p><p style="line-height: normal;"><span style="background-color: rgb(238, 236, 225);">切换分支：git checkout &nbsp;name&nbsp;</span></p><p style="line-height: normal;"><span style="background-color: rgb(238, 236, 225);">创建+切换分支：git checkout -b &nbsp;name&nbsp;</span></p><p style="line-height: normal;"><span style="background-color: rgb(238, 236, 225);">合并某分支到当前分支：git merge &nbsp;name&nbsp;</span></p><p style="line-height: normal;"><span style="background-color: rgb(238, 236, 225);">删除分支：git branch -d &nbsp;name</span></p></div><p><br/></p><p><br/></p><div><strong><span style="font-size: 20px;">GIT换原某个文件到之前的版本，命令如下：</span></strong></div><div>zollty@zollty-System-Product-Name:~/0sync/0work/git/kop-resource-stat-demo$ git status<br/>位于分支 master<br/>修改： src/main/java/cn/stat/AipCall.java<br/><br/>修改尚未加入提交（使用 &quot;git add&quot; 和/或 &quot;git commit -a&quot;）<br/>zollty@zollty-System-Product-Name:~/0sync/0work/git/kop-resource-stat-demo$&nbsp;<strong><span style="color: rgb(0, 176, 80);">git log</span></strong>&nbsp;src/main/java/cn/stat/AipCall.java<br/><span style="font-size: 16px;">commit&nbsp;<span style="color: rgb(192, 0, 0);">eae91c</span>bd5322f85decfd9c3788636809dea361b2<br/>Author: zollty &lt;zollty@163.com&gt;<br/>Date: Tue Sep 6 16:08:53 2016 +0800<br/><br/>commit&nbsp;c13d4ed0289251db11a3abf375179f674a192984<br/>Author: zollty &lt;zollty@163.com&gt;<br/>Date: Tue Sep 6 14:31:37 2016 +0800<br/><br/>Initial Commit</span><br/><p>zollty@zollty-System-Product-Name:~/0sync/0work/git/kop-resource-stat-demo$&nbsp;git&nbsp;<span style="line-height: 1.8; color: rgb(0, 176, 80);">checkout</span><span style="line-height: 1.8;">&nbsp;</span><span style="line-height: 1.8; color: rgb(192, 0, 0);">eae91c</span><span style="line-height: 1.8;">&nbsp;src/main/java/cn/stat/AipCall.java</span></p></div><p><br/></p><p><br/></p><p><span style="font-size: 20px;"><strong>Git暂存命令</strong></span></p><p>当需要拉取远端文件，但又不想提交正在修改的文件时，可以使用git stash 命令将当前的工作区保存（藏匿）起来，等pull 完后再还原。</p><p>此功能类似于实现了 ‘局部拉取更新’ 。</p><p>命令如下：</p><p>git stash &nbsp;//暂存修改工作区</p><p>git pull &nbsp;//拉取远端文件</p><p>git stash pop stash@{0} &nbsp; &nbsp;//将工作区还原</p><p>注：如果还原工作区的文件与pull 下来的文件有冲突，要手动修改冲突</p><p><br/></p><p><br/></p>