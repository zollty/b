---
layout: ue
title: 我的GIT使用笔记
category: 技术/开发工具
tags: GIT
keywords: "GIT"
---

<div class="subject-title" onclick="toggleContent(this,'#knc6cn');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>GIT代理设置</p></div><div id="knc6cn" class="subject-content" style="display:none;"><p>位置：~/.gitconfig，例如：C:\Users\Administrator\.gitconfig</p><p>内容如下：</p><pre class="brush:plain;toolbar:false">[user]
name&nbsp;=&nbsp;zollty
email&nbsp;=&nbsp;zollty@163.com
[http]
proxy&nbsp;=&nbsp;http://170.17.18.80:8080
[https]
proxy&nbsp;=&nbsp;http://170.17.18.80:8080</pre><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#cey89c');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>GIT命令下 文件中文名 乱码问题</p></div><div id="cey89c" class="subject-content" style="display:none;"><p>下面命令 设置一下就行了：</p><p>git config --global core.quotepath false</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#yxx3q2');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>轻量级Clone（只拷贝最近一次的commit历史记录和指定分支）<br/></p></div><div id="yxx3q2" class="subject-content" style="display:none;"><p>例如</p><p><span style="font-weight: 700;">git clone --depth 1 --single-branch -b 5.3</span>&nbsp;https://github.com/apereo/cas-overlay-template.git&nbsp;<span style="font-weight: 700;">cas-overlay</span></p><p>5.3为分支名称。</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#kzzkqk');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>轻量级clone后，如何单独拉取一个分支？</p></div><div id="kzzkqk" class="subject-content" style="display:none;"><p>1、首先建立一个空的空白分支：git checkout --orphan xxx本地分支名</p><p>2、然后拉取远程分支：git pull origin xxx远程分支名</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#zv8c28');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>git 单独拉取某个 tag（没有clone全部，[远端的版本库太大了]）</p></div><div id="zv8c28" class="subject-content" style="display:none;"><p>&nbsp;&nbsp;&nbsp;&nbsp;假设远程tag的名字为 temporary，则可以用如下的命令</p><p><span style="color: rgb(192, 0, 0);">$ git fetch origin refs/tags/temporary:refs/heads/newbranch</span></p><p>[observe fetch happen; now you have local branch &#39;newbranch&#39;]</p><p>&nbsp;&nbsp;&nbsp;&nbsp;然后就可以 git checkout temporary了</p><p>&nbsp;&nbsp;&nbsp;&nbsp;另外，如果想<span style="font-weight: 700;">查看远程所有的分支、tags</span>，可以用如下命令：</p><p><span style="color: rgb(192, 0, 0);">$ git ls-remote</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;其他方法参见：<a href="https://www.cnblogs.com/chucklu/p/4841978.html">https://www.cnblogs.com/chucklu/p/4841978.html</a></p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#5xy5y2');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>状态问题：文件没有修改，diff也为空，但却状态却为&nbsp;modified</p></div><div id="5xy5y2" class="subject-content" style="display:none;"><p>解决方案：将modified的文件，执行一次 <span style="background-color: rgb(217, 150, 148);">git checkout xxx</span>，例如：</p><pre class="brush:bash;toolbar:false">$&nbsp;git&nbsp;status
On&nbsp;branch&nbsp;master
Your&nbsp;branch&nbsp;is&nbsp;up&nbsp;to&nbsp;date&nbsp;with&nbsp;&#39;origin/master&#39;.

Changes&nbsp;not&nbsp;staged&nbsp;for&nbsp;commit:
&nbsp;&nbsp;(use&nbsp;&quot;git&nbsp;add&nbsp;&lt;file&gt;...&quot;&nbsp;to&nbsp;update&nbsp;what&nbsp;will&nbsp;be&nbsp;committed)
&nbsp;&nbsp;(use&nbsp;&quot;git&nbsp;checkout&nbsp;--&nbsp;&lt;file&gt;...&quot;&nbsp;to&nbsp;discard&nbsp;changes&nbsp;in&nbsp;working&nbsp;directory)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/26k6ec.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/28za6a.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/2qc4vc.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/33z3vc.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/594zzk.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/767z4z.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/7yy6z5.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/884c4z.txt
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;modified:&nbsp;&nbsp;&nbsp;content/8xan8z.txt

no&nbsp;changes&nbsp;added&nbsp;to&nbsp;commit&nbsp;(use&nbsp;&quot;git&nbsp;add&quot;&nbsp;and/or&nbsp;&quot;git&nbsp;commit&nbsp;-a&quot;)

$&nbsp;git&nbsp;checkout&nbsp;content/*

$&nbsp;git&nbsp;status
On&nbsp;branch&nbsp;master
Your&nbsp;branch&nbsp;is&nbsp;up&nbsp;to&nbsp;date&nbsp;with&nbsp;&#39;origin/master&#39;.

nothing&nbsp;to&nbsp;commit,&nbsp;working&nbsp;tree&nbsp;clean</pre><p>另外，我仓库的配置 .git/config 为：</p><pre class="brush:plain;toolbar:false;">[core]
	repositoryformatversion&nbsp;=&nbsp;0
	filemode&nbsp;=&nbsp;false
	bare&nbsp;=&nbsp;false
	logallrefupdates&nbsp;=&nbsp;true
	symlinks&nbsp;=&nbsp;false
	ignorecase&nbsp;=&nbsp;true
	safecrlf&nbsp;=&nbsp;false
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;autocrlf&nbsp;=&nbsp;false
	whitespace&nbsp;=&nbsp;cr-at-eol</pre><p>注意其中的&nbsp;ignorecase, safecrlf, autocrlf, whitespace 这几个配置。</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#nkkcpc');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>git仓库，删除所有历史记录，成为一个新的干净的仓库</p></div><div id="nkkcpc" class="subject-content" style="display:none;"><p>1.切换到新的分支</p><p>&nbsp; &nbsp;git checkout --orphan latest_branch</p><p>2.缓存所有文件（除了.gitignore中声名排除的）</p><p>&nbsp; &nbsp;git add -A</p><p>3.提交跟踪过的文件（Commit the changes）</p><p>&nbsp; &nbsp;git commit -am &quot;commit message&quot;</p><p>4.删除master分支（Delete the branch）</p><p>&nbsp; &nbsp;git branch -D master</p><p>5.重命名当前分支为master（Rename the current branch to master）</p><p>&nbsp; &nbsp;git branch -m master</p><p>6.提交到远程master分支 （Finally, force update your repository）</p><p>&nbsp; &nbsp;git push -f origin master</p><p>7.另开一个文件夹，重新clone仓库，然后用clone后的 .git文件夹，替换掉原来目录下的 .git文件夹</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#6xzv56');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>同时向多个git仓库提交代码</p></div><div id="6xzv56" class="subject-content" style="display:none;"><p>1、添加一个新地址： git remote add origin_gitlab http://10.2.10.22/3rd_custom/apollo.git&nbsp;</p><p>2、往新地址推送代码：git push origin_gitlab master <br/></p><p>如果推送失败，则先pull：</p><p>git pull&nbsp;origin_gitlab&nbsp;master</p><p>如果pull失败，报错 fatal: refusing to merge unrelated histories，则加上一个参数：</p><p>git pull origin_gitlab master --allow-unrelated-histories</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#xzey6q');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>撤销未提交(push)的更改(commit) / GIT还原代码</p></div><div id="xzey6q" class="subject-content" style="display:none;"><p><span style="color: rgb(192, 0, 0);">git log +&nbsp;git checkout</span></p><p>步骤如下：</p><p>1、<span style="color: rgb(192, 0, 0);">git log查看commit id</span>，找到提前之前的id</p><p>如下所示：</p><pre class="brush:plain;toolbar:false">$&nbsp;git&nbsp;log
commit&nbsp;6aeb1823a804d5b154ebdb4a5a293b0731dd7cdb&nbsp;(HEAD&nbsp;-&gt;&nbsp;master)
Author:&nbsp;zollty&nbsp;&lt;zollty@163.com&gt;
Date:&nbsp;&nbsp;&nbsp;Wed&nbsp;Dec&nbsp;19&nbsp;11:26:08&nbsp;2018&nbsp;+0800

&nbsp;&nbsp;&nbsp;&nbsp;update&nbsp;pom

commit&nbsp;2477fb81aa5ce01f50f377f7dd6918848e2905c2&nbsp;(origin/master,&nbsp;origin/HEAD)
Author:&nbsp;zollty&nbsp;&lt;zollty@163.com&gt;
Date:&nbsp;&nbsp;&nbsp;Sun&nbsp;Apr&nbsp;15&nbsp;20:07:14&nbsp;2018&nbsp;+0800

&nbsp;&nbsp;&nbsp;&nbsp;update

commit&nbsp;ca9b0887698f5b73d5fb3ba8f07ab13214f4f4a9
Author:&nbsp;zollty&nbsp;&lt;zollty@gmail.com&gt;
Date:&nbsp;&nbsp;&nbsp;Thu&nbsp;Jan&nbsp;25&nbsp;21:12:13&nbsp;2018&nbsp;+0800</pre><p>现在HEAD在第一个的位置，我们<span style="color: rgb(192, 0, 0);">找到第二个位置的 id</span>：2477fb81a</p><p>2、<span style="color: rgb(192, 0, 0);">git reset</span> --hard commit-id，注意参数hard会丢弃修改的文件。</p><p>一般情况下，不要加--hard，使用&nbsp;git reset commit-id 即可。</p><p style='line-height: 1;'><br/></p><p>附：git reset&nbsp; --[soft, hard, mixed(default)] 说明</p><ul class=" list-paddingleft-2" style="list-style-type: disc;"><li><p>--soft 只是重置head，更改的文件不会还原，index不会重置，意味着下次commit，不需要再add；</p></li><li><p>--mixed 意味着，更改的文件不会还原，下次提交需要重新add；</p></li><li><p>--hard 意味着彻底还原，更改的文件会还原到之前的版本，更改丢失。</p></li></ul><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#7kx8xv');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>GIT还原某个文件到之前的版本&nbsp;/ GIT还原代码</p></div><div id="7kx8xv" class="subject-content" style="display:none;"><p><span style="color: rgb(192, 0, 0);">git log +&nbsp;git checkout</span></p><p>过程如下：</p><div><p>第1步，得到文件全路径：</p><pre class="brush:bash;toolbar:false">$&nbsp;git&nbsp;status
位于分支&nbsp;master
修改：&nbsp;src/main/java/cn/stat/AipCall.java</pre><p>第2步，git log + 文件全路径，得到commit id：</p><pre class="brush:bash;toolbar:false">$&nbsp;git&nbsp;log&nbsp;src/main/java/cn/stat/AipCall.java
commit&nbsp;eae91cbd5322f85decfd9c3788636809dea361b2
Author:&nbsp;zollty&nbsp;&lt;zollty@163.com&gt;
Date:&nbsp;Tue&nbsp;Sep&nbsp;6&nbsp;16:08:53&nbsp;2016&nbsp;+0800
commit&nbsp;c13d4ed0289251db11a3abf375179f674a192984
Author:&nbsp;zollty&nbsp;&lt;zollty@163.com&gt;
Date:&nbsp;Tue&nbsp;Sep&nbsp;6&nbsp;14:31:37&nbsp;2016&nbsp;+0800
Initial&nbsp;Commit</pre>第3步，git checkout commit id<pre class="brush:bash;toolbar:false">$&nbsp;git&nbsp;checkout&nbsp;eae91c&nbsp;src/main/java/cn/stat/AipCall.java</pre><p style='line-height: 1;'><br/></p></div></div><div class="subject-title" onclick="toggleContent(this,'#5zvc64');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>Git暂存命令用法</p></div><div id="5zvc64" class="subject-content" style="display:none;"><p>&nbsp;&nbsp;&nbsp;&nbsp;Git暂存命令：<span style="color: rgb(192, 0, 0);">当需要拉取远端文件，但又不想提交正在修改的文件</span>时，可以使用git stash 命令将当前的工作区保存（藏匿）起来，等pull 完后再还原。此功能类似于实现了 ‘局部拉取更新’ 。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;用法如下：</p><pre class="brush:bash;toolbar:false">git&nbsp;stash&nbsp;&nbsp;//暂存修改工作区
git&nbsp;pull&nbsp;&nbsp;//拉取远端文件
git&nbsp;stash&nbsp;pop&nbsp;stash@{0}&nbsp;&nbsp;//将工作区还原</pre><p>&nbsp;&nbsp;&nbsp;&nbsp;注：如果还原工作区的文件与pull 下来的文件有冲突，则要手动修改冲突。</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#ux7zgz');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>创建一个tag（发布一个版本）</p></div><div id="ux7zgz" class="subject-content" style="display:none;"><div style="white-space: normal;">例如：</div><div style="white-space: normal;"><pre class="brush:bash;toolbar:false" style="line-height: 1.42857;">git&nbsp;tag&nbsp;-a&nbsp;v1.1.0.RELEASE&nbsp;-m&nbsp;&#39;release&nbsp;v1.1.0&#39;
git&nbsp;push&nbsp;origin&nbsp;&nbsp;v1.1.0.RELEASE</pre>其中&nbsp; v1.1.0.RELEASE 为 tag name</div><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#6hzvaz');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>删除tag，重新上传</p></div><div id="6hzvaz" class="subject-content" style="display:none;"><div style="white-space: normal;">1）先删除本地tag：git tag -d v1.2.1.RELEASE</div><div style="white-space: normal;">2）然后再删除远程tag：git push origin :refs/tags/v1.2.1.RELEASE</div><p>3）然后在重新执行创建tag的过程</p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#2a47vc');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><div>同步仓库到另一个分支（比如gh-pages分支）</div></div><div id="2a47vc" class="subject-content" style="display:none;"><p>操作如下：</p><div style="white-space: normal;"><pre class="brush:bash;toolbar:false" style="line-height: 1.42857;">git&nbsp;checkout&nbsp;gh-pages&nbsp;//&nbsp;go&nbsp;to&nbsp;the&nbsp;gh-pages&nbsp;branch&nbsp;切换分支
git&nbsp;rebase&nbsp;master&nbsp;//&nbsp;bring&nbsp;gh-pages&nbsp;up&nbsp;to&nbsp;date&nbsp;with&nbsp;master
git&nbsp;pull&nbsp;//&nbsp;pull&nbsp;before&nbsp;push
git&nbsp;push&nbsp;origin&nbsp;gh-pages&nbsp;//&nbsp;commit&nbsp;the&nbsp;changes
git&nbsp;checkout&nbsp;master&nbsp;//&nbsp;return&nbsp;to&nbsp;the&nbsp;master&nbsp;branch</pre><p style='line-height: 1;'><br/></p></div></div><div class="subject-title" onclick="toggleContent(this,'#9cku9x');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>将改动的代码提交到一个新分支上（自动创建）</p></div><div id="9cku9x" class="subject-content" style="display:none;"><p>&nbsp;&nbsp;&nbsp;&nbsp;我在master上改了很多代码，等我commit之后，觉得不能提交到master上，决定提交到另外一个分支，</p><p>&nbsp;&nbsp;&nbsp;&nbsp;于是执行下面命令：</p><p>$ git push origin branch2</p><p>&nbsp;&nbsp;&nbsp;&nbsp;结果报错：src refspec ~ does not match any</p><p>解决方案为：</p><p>$ git push origin HEAD:branch2</p><p>参见：<a href="https://stackoverflow.com/questions/26701683/src-refspec-does-not-match-any">https://stackoverflow.com/questions/26701683/src-refspec-does-not-match-any</a></p><p style='line-height: 1;'><br/></p></div><div class="subject-title" onclick="toggleContent(this,'#7y3k2c');"><p class="subject-info">＋ (点击以下标题显示正文内容)</p><p>git 删除远程分支</p></div><div id="7y3k2c" class="subject-content" style="display:none;"><p>&nbsp;&nbsp;&nbsp;&nbsp;不小心把本地的临时分支push到server上去了，想要删除。</p><p>&nbsp;&nbsp;&nbsp;&nbsp;一开始用 git branch -r -d origin/branch-name&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;不成功，发现只是删除的本地对该远程分支的track，正确的方法应该是这样：</p><pre class="brush:bash;toolbar:false" style="line-height: 1.42857;">git&nbsp;push&nbsp;origin&nbsp;:branch-name</pre><p>&nbsp;&nbsp;&nbsp;&nbsp;冒号前面的空格不能少，<span style="color: rgb(192, 0, 0);">原理是把一个空分支push到server上</span>，相当于删除该分支。</p><p style='line-height: 1;'><br/></p></div><script type="text/javascript">var toggleContent=function(that, id){var tx="－ (点击以下标题隐藏正文内容)";if($(id).css("display")!="none"){tx="＋ (点击以下标题显示正文内容)"}$(that).children(":first").text(tx);$(id).fadeToggle(100)};</script>