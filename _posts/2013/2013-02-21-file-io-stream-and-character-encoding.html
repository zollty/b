---
layout: ue
title: Java文件IO流和字符编码
category: Java编程与JVM
tags: IO流,编码
keywords: "IO流,编码"
---

<p>注：本文是<a href="http://blog.zollty.com/b/archive/research-on-report-technology-with-large-data-volume.html" target="_self">《大数据量报表技术研究》</a>专著的一部分</p><p><br/></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">一、问题的提出</span></p><p style="margin-left: 28px; white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: Wingdings;">w<span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: &quot;Times New Roman&quot;;">&nbsp;&nbsp;</span></span><span style="font-size: 16px;">Java</span><span style="font-size: 16px; font-family: 宋体;">有哪些基础的</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">流？各有什么特点？</span></p><p style="margin-left: 28px; white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: Wingdings;">w<span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: &quot;Times New Roman&quot;;">&nbsp;&nbsp;</span></span><span style="font-size: 16px; font-family: 宋体;">如何读写文本文件？考虑效率和编码问题。</span></p><p style="margin-left: 28px; white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: Wingdings;">w<span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: &quot;Times New Roman&quot;;">&nbsp;&nbsp;</span></span><span style="font-size: 16px; font-family: 宋体;">如何读写二进制文件？考虑大文件问题和效率问题。</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">二、问题的研究</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">在</span><span style="font-size: 16px;">Java</span><span style="font-size: 16px; font-family: 宋体;">的</span><span style="font-size: 16px;">API</span><span style="font-size: 16px; font-family: 宋体;">里面，</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">流最基础的是</span><span style="font-size: 16px;">InputStream</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">OutputStream</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">Reader</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">Writer</span><span style="font-size: 16px; font-family: 宋体;">，前两种是基于字节（</span><span style="font-size: 16px;">byte</span><span style="font-size: 16px; font-family: 宋体;">）输入输出设计的，后两种是基于字符（</span><span style="font-size: 16px;">char</span><span style="font-size: 16px; font-family: 宋体;">，</span><span style="font-size: 16px;">UCS-2</span><span style="font-size: 16px; font-family: 宋体;">）输入输出设计的。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">1</span><span style="font-size: 16px; font-family: 宋体;">、编码知识</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">Java</span><span style="font-size: 16px; font-family: 宋体;">的字符（</span><span style="font-size: 16px;">char</span><span style="font-size: 16px; font-family: 宋体;">）是采用的</span><span style="font-size: 16px;">UCS-2</span><span style="font-size: 16px; font-family: 宋体;">编码方式，占</span><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">个字节。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">UCS-2</span><span style="font-size: 16px; font-family: 宋体;">：即</span><span style="font-size: 16px;">16</span><span style="font-size: 16px; font-family: 宋体;">位、</span><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">个字节的</span><span style="font-size: 16px;">Unicode</span><span style="font-size: 16px; font-family: 宋体;">编码，范围为</span><span style="font-size: 16px;">0 to 65535 (0x00-0xffff)</span><span style="font-size: 16px; font-family: 宋体;">。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">例如</span><span style="font-size: 16px;">&#39;</span><span style="font-size: 16px; font-family: 宋体;">余</span><span style="font-size: 16px;">&#39;</span><span style="font-size: 16px; font-family: 宋体;">字，它的</span><span style="font-size: 16px;">Unicode</span><span style="font-size: 16px; font-family: 宋体;">编码为</span><span style="font-size: 16px;">&quot;4f59&quot;</span><span style="font-size: 16px; font-family: 宋体;">，转换成</span><span style="font-size: 16px;">int</span><span style="font-size: 16px; font-family: 宋体;">等于</span><span style="font-size: 16px;">20313</span><span style="font-size: 16px; font-family: 宋体;">，转换成</span><span style="font-size: 16px;">byte[]</span><span style="font-size: 16px; font-family: 宋体;">为</span><span style="font-size: 16px;">{79, 89}</span><span style="font-size: 16px; font-family: 宋体;">（即</span><span style="font-size: 16px;">{0X4f, 0X59}</span><span style="font-size: 16px; font-family: 宋体;">，一个</span><span style="font-size: 16px;">char</span><span style="font-size: 16px; font-family: 宋体;">的</span><span style="font-size: 16px;">16 bite</span><span style="font-size: 16px; font-family: 宋体;">中的前</span><span style="font-size: 16px;">8</span><span style="font-size: 16px; font-family: 宋体;">个</span><span style="font-size: 16px;">bite</span><span style="font-size: 16px; font-family: 宋体;">和后</span><span style="font-size: 16px;">8</span><span style="font-size: 16px; font-family: 宋体;">个</span><span style="font-size: 16px;">bite</span><span style="font-size: 16px; font-family: 宋体;">），如果知道这种对应关系，这几者之间是可以互相转换的。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">最初的</span><span style="font-size: 16px;">Unicode</span><span style="font-size: 16px; font-family: 宋体;">编码是固定长度的，</span><span style="font-size: 16px;">16</span><span style="font-size: 16px; font-family: 宋体;">位，也就是</span><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">两个字节代表一个字符，这样一共可以表示</span><span style="font-size: 16px;">65536</span><span style="font-size: 16px; font-family: 宋体;">个字符。但是，要表示所有的字符是远远不够的。因此</span><span style="font-size: 16px;">Unicode 4.0</span><span style="font-size: 16px; font-family: 宋体;">定义了一组附加字符编码，附加字符编码采用</span><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">个</span><span style="font-size: 16px;">16</span><span style="font-size: 16px; font-family: 宋体;">位（</span><span style="font-size: 16px;">4</span><span style="font-size: 16px; font-family: 宋体;">个字节）来表示，这样最多可以定义</span><span style="font-size: 16px;">1048576</span><span style="font-size: 16px; font-family: 宋体;">（百万</span><span style="font-size: 16px;">+</span><span style="font-size: 16px; font-family: 宋体;">）个附加字符。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">Unicode</span><span style="font-size: 16px; font-family: 宋体;">只是一个编码规范，</span><span style="font-size: 16px;">Unicode</span><span style="font-size: 16px; font-family: 宋体;">的实现方式有很多种，例如</span><span style="font-size: 16px;">UTF-8</span><span style="font-size: 16px; font-family: 宋体;">，</span><span style="font-size: 16px;">GB2312</span><span style="font-size: 16px; font-family: 宋体;">，</span><span style="font-size: 16px;">UTF-16</span><span style="font-size: 16px; font-family: 宋体;">等等。实际上现在用得最多的还是</span><span style="font-size: 16px;">16</span><span style="font-size: 16px; font-family: 宋体;">位的</span><span style="font-size: 16px;">Unicode</span><span style="font-size: 16px; font-family: 宋体;">编码（</span><span style="font-size: 16px;">UCS-2</span><span style="font-size: 16px; font-family: 宋体;">），因为</span><span style="font-size: 16px;">6</span><span style="font-size: 16px; font-family: 宋体;">万多个字符已经足够包括各种语言的常用字符了（</span><span style="font-size: 16px;">GB2312</span><span style="font-size: 16px; font-family: 宋体;">有</span><span style="font-size: 16px;">6763</span><span style="font-size: 16px; font-family: 宋体;">个汉字，</span><span style="font-size: 16px;">GBK</span><span style="font-size: 16px; font-family: 宋体;">有</span><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">万多个汉字而已）。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">Java</span><span style="font-size: 16px; font-family: 宋体;">中字符串的默认编码，是在虚拟机启动时决定，通常根据语言环境和底层操作系统的</span><span style="font-size: 16px;">Charset</span><span style="font-size: 16px; font-family: 宋体;">来确定。可以用如下方法获取当前</span><span style="font-size: 16px;">JVM</span><span style="font-size: 16px; font-family: 宋体;">的默认编码：</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">java.nio.charset.Charset.defaultCharset();</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">注意，这个默认编码是在虚拟机启动时便决定了的，只初始化一次，运行中不能改变。如果想修改这个编码，可以在</span><span style="font-size: 16px;">JVM</span><span style="font-size: 16px; font-family: 宋体;">的启动参数中设置如下：</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">-Dfile.encoding=&quot;UTF-8&quot;</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">例如</span><span style="font-size: 16px;">eclipse</span><span style="font-size: 16px; font-family: 宋体;">，设置方法为：点击鼠标右键，</span><span style="font-size: 16px;">Run-&gt;RunConfigurations...</span><span style="font-size: 16px; font-family: 宋体;">，可以在</span><span style="font-size: 16px;">Arguments-&gt;VM arguments</span><span style="font-size: 16px; font-family: 宋体;">中设置，也可以在</span><span style="font-size: 16px;">Common-&gt;Encoding</span><span style="font-size: 16px; font-family: 宋体;">中设置。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">This property is used for the default encoding in Java, all readers and writers would default to using this property</span><span style="font-size: 16px; font-family: 宋体;">。即所有的</span><span style="font-size: 16px;">Readers</span><span style="font-size: 16px; font-family: 宋体;">和</span><span style="font-size: 16px;">Writers&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">默认用的都是这个编码。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="margin-left: 28px; white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: Wingdings;">w<span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: &quot;Times New Roman&quot;;">&nbsp;&nbsp;</span></span><span style="font-size: 16px; font-family: 宋体;">关于</span><span style="font-size: 16px;">UTF-8</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">UTF-16</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">GBK</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">GB2312</span><span style="font-size: 16px; font-family: 宋体;">编码的选择</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">中文字符这四种编码格式都能处理，</span><span style="font-size: 16px;">GB2312</span><span style="font-size: 16px; font-family: 宋体;">与</span><span style="font-size: 16px;">GBK</span><span style="font-size: 16px; font-family: 宋体;">编码规则类似，但是</span><span style="font-size: 16px;">GBK&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">范围更大，它能处理所有汉字字符，所以</span><span style="font-size: 16px;">&nbsp;GB2312</span><span style="font-size: 16px; font-family: 宋体;">与</span><span style="font-size: 16px;">GBK</span><span style="font-size: 16px; font-family: 宋体;">比较应该选择</span><span style="font-size: 16px;">GBK</span><span style="font-size: 16px; font-family: 宋体;">。</span><span style="font-size: 16px;">UTF-16&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">与</span><span style="font-size: 16px;">&nbsp;UTF-8&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">都是处理</span><span style="font-size: 16px;">&nbsp;Unicode&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">编码，它们的编码规则不太相同，</span><span style="font-size: 16px;">UTF-16&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">编码效率最高，字符到字节相互转换更简单，进行字符串操作也更好，但是容错性差。它适合在本地磁盘和内存之间使用，可以进行字符和字节之间快速切换，如</span><span style="font-size: 16px;">&nbsp;Java&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">的内存编码就是采用</span><span style="font-size: 16px;">&nbsp;UTF-16&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">编码。但是它不适合在网络之间传输，因为网络传输容易损坏字节流，一旦字节流损坏将很难恢复，相比较而言</span><span style="font-size: 16px;">&nbsp;UTF-8&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">更适合网络传输，对</span><span style="font-size: 16px;">&nbsp;ASCII&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">字符采用单字节存储，另外单个字符损坏也不会影响后面其它字符，在编码效率上介于</span><span style="font-size: 16px;">&nbsp;GBK&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">和</span><span style="font-size: 16px;">&nbsp;UTF-16&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">之间，所以</span><span style="font-size: 16px;">UTF-8</span><span style="font-size: 16px; font-family: 宋体;">在编码效率上和编码安全性上做了平衡，是理想的中文编码方式。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="margin-left: 28px; white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: Wingdings;">w<span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: &quot;Times New Roman&quot;;">&nbsp;&nbsp;</span></span><span style="font-size: 16px; font-family: 宋体;">乱码问题和编码的转换</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">客户用的</span><span style="font-size: 16px;">GBK</span><span style="font-size: 16px; font-family: 宋体;">编码，而我方用的</span><span style="font-size: 16px;">UTF-8</span><span style="font-size: 16px; font-family: 宋体;">，怎么办？</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">首先当然考虑设置问题，比如</span><span style="font-size: 16px;">html</span><span style="font-size: 16px; font-family: 宋体;">中、</span><span style="font-size: 16px;">tomcat</span><span style="font-size: 16px; font-family: 宋体;">的设置，</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">各种编码之间不一定兼容，所以才造成了乱码，例如在互联网上被广泛使用的默认编码</span><span style="font-size: 16px;">ISO_8859_1</span><span style="font-size: 16px; font-family: 宋体;">，它只能表示</span><span style="font-size: 16px;">256</span><span style="font-size: 16px; font-family: 宋体;">个字符（</span><span style="font-size: 16px;">0-255</span><span style="font-size: 16px; font-family: 宋体;">），如果将</span><span style="font-size: 16px;">UTF-8</span><span style="font-size: 16px; font-family: 宋体;">字符转换成</span><span style="font-size: 16px;">ISO_8859_1</span><span style="font-size: 16px; font-family: 宋体;">，势必会乱码。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">&nbsp;Writer</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">和</span><span style="font-size: 16px;">OutputStreamWriter</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">将字符写入文件，用</span><span style="font-size: 16px;">Writer</span><span style="font-size: 16px; font-family: 宋体;">，通过</span><span style="font-size: 16px;">OutputStreamWriter</span><span style="font-size: 16px; font-family: 宋体;">包装类，将字符流转换成字节流。例如：</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">Writer</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">outWrite</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">=</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;null</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">OutputStream</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">stream</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">=</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;new&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">FileOutputStream</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">file</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">outWrite</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">=</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;new&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">OutputStreamWriter</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">stream,</span>&nbsp;<span style="font-family: Verdana, sans-serif; color: red; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&quot;GBK&quot;</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">outWrite.write</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">str</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span>&nbsp;<span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">//&nbsp;</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">通过</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">OutputStreamWriter</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">将字符</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">str</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">输入到文件</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">file</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">中</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">但是，</span><span style="font-size: 16px;">Writer</span><span style="font-size: 16px; font-family: 宋体;">效率是比较低的，它每执行一个</span><span style="font-size: 16px;">write</span><span style="font-size: 16px; font-family: 宋体;">方法，都要等前一个</span><span style="font-size: 16px;">write</span><span style="font-size: 16px; font-family: 宋体;">方法的</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">写操作完成后，才能继续。由于</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">读写速度远远低于</span><span style="font-size: 16px;">CPU</span><span style="font-size: 16px; font-family: 宋体;">速度和内存读写速度，所以该方法会极大的受限于</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">。因此，我们一般用</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">代替，</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">有一个自动缓冲的机制，当缓冲区满了之后，才输出到</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">。示例如下：</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">BufferedWriter outWrite =&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">null</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">OutputStream</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">stream</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">=</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;new&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">FileOutputStream</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">file</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">OutputStreamWriter osw =&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">new&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">OutputStreamWriter</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">stream,</span>&nbsp;<span style="font-family: Verdana, sans-serif; color: red; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&quot;GBK&quot;</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">outWrite</span>&nbsp;<span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">=</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;new&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">BufferedWriter</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">osw</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">outWrite.write</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">str</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span>&nbsp;<span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">//&nbsp;</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">通过</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">BufferedWriter</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">将字符</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">str</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">输入到文件</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">file</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">中</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">outWrite.flush</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">()</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">out.close</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">()</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">的使用原则是：</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">“</span><span style="font-size: 16px;">it is advisable to wrap a BufferedWriter around any Writer whose write() operations may be costly, such as FileWriters and OutputStreamWriters.</span><span style="font-size: 16px; font-family: 宋体;">”</span><span style="font-size: 16px;">(</span><span style="font-size: 16px; font-family: 宋体;">摘自</span><span style="font-size: 16px;">Java API)</span><span style="font-size: 16px; font-family: 宋体;">。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">也就是说，只要是频繁的、大量的字符流写入，都应该使用</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">。但是，如果每次写入的字节长度是自己设置的，则用</span><span style="font-size: 16px;">Writer</span><span style="font-size: 16px; font-family: 宋体;">就可以模拟</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">的效果。例如：</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">for</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">int</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;i=</span><span style="font-family: Verdana, sans-serif; color: rgb(204, 102, 204); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">0</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;i&lt;</span><span style="font-family: Verdana, sans-serif; color: rgb(204, 102, 204); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">1000000</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;i++</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">){</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;&nbsp; writer.write</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">(</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;str&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">)</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;&nbsp;</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">//&nbsp;</span><span style="font-size: 13px; font-family: 宋体; color: rgb(64, 112, 64); background: white;">或者</span><span style="font-size: 13px; font-family: Verdana, sans-serif; color: rgb(64, 112, 64); background: white;">&nbsp;bufferedWriter.write( str )</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; color: rgb(102, 204, 102); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">}</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">如果这个</span><span style="font-size: 16px;">&nbsp;str&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">只有</span><span style="font-size: 16px;">10</span><span style="font-size: 16px; font-family: 宋体;">个字节，则用</span><span style="font-size: 16px;">Writer</span><span style="font-size: 16px; font-family: 宋体;">要进行</span><span style="font-size: 16px;">1000000</span><span style="font-size: 16px; font-family: 宋体;">次</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">操作。但是用</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">，假设缓冲大小为</span><span style="font-size: 16px;">1024</span><span style="font-size: 16px; font-family: 宋体;">，则只需要</span><span style="font-size: 16px;">&nbsp;1000000/1024&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">次</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">但是如果这个</span><span style="font-size: 16px;">&nbsp;str&nbsp;</span><span style="font-size: 16px; font-family: 宋体;">本身就有</span><span style="font-size: 16px;">2000</span><span style="font-size: 16px; font-family: 宋体;">个字节，那么用</span><span style="font-size: 16px;">Writer</span><span style="font-size: 16px; font-family: 宋体;">和</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">其实效果都差不多了。（这个原理在下文讲</span><span style="font-size: 16px;">OutputStream</span><span style="font-size: 16px; font-family: 宋体;">时会用到）</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">另外，注意到</span><span style="font-size: 16px;">OutputStreamWriter</span><span style="font-size: 16px; font-family: 宋体;">这个类，它是字符流通向字节流的桥梁。一般情形下，只要涉及到非英文字符，就需要使用</span><span style="font-size: 16px;">OutputStreamWriter</span><span style="font-size: 16px; font-family: 宋体;">进行编码转换。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">总结：一是使用</span><span style="font-size: 16px;">BufferedWriter</span><span style="font-size: 16px; font-family: 宋体;">，二是使用</span><span style="font-size: 16px;">OutputStreamWriter</span><span style="font-size: 16px; font-family: 宋体;">。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">3</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">OutputStream</span><span style="font-size: 16px; font-family: 宋体;">和</span><span style="font-size: 16px;">InputStream</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">对于字节流的读写，通常是使用</span><span style="font-size: 16px;">InputStream</span><span style="font-size: 16px; font-family: 宋体;">和</span><span style="font-size: 16px;">OutputStream</span><span style="font-size: 16px; font-family: 宋体;">。因为读写字节流的长度一般是由我们自己控制的，所以通常我们不需要用</span><span style="font-size: 16px;">BufferedOutputStream</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">BufferedInputStream</span><span style="font-size: 16px; font-family: 宋体;">，而是使用自定义的</span><span style="font-size: 16px;">buffer</span><span style="font-size: 16px; font-family: 宋体;">数组。例如，拷贝文件的方法，如下：</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">public static</span>&nbsp;<span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">long</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;copyLarge(InputStream input, OutputStream output,&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">byte</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">[] buffer)</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">throws&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">IOException {</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">long</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;count =&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(204, 102, 204); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">0</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">int&nbsp;</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">n =&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(204, 102, 204); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">0</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">while</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;(</span><span style="font-family: Verdana, sans-serif; color: rgb(204, 102, 204); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">-1</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;!= (n = input.read(buffer))) {</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; output.write(buffer,&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(204, 102, 204); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">0</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">, n);</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; count += n;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp; }</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;&nbsp;&nbsp;</span><span style="font-family: Verdana, sans-serif; color: rgb(177, 177, 0); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">return</span><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&nbsp;count;</span></p><p style="margin-top: 3px; margin-bottom: 3px; white-space: normal; background: rgb(247, 249, 250); border: none; padding: 7px;"><span style="font-family: Verdana, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">}</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">每次读取固定长度的字节，</span><span style="font-size: 16px;">buffer</span><span style="font-size: 16px; font-family: 宋体;">的长度一般是</span><span style="font-size: 16px;">512</span><span style="font-size: 16px; font-family: 宋体;">的倍数，比如</span><span style="font-size: 16px;">1024,</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">8192</span><span style="font-size: 16px; font-family: 宋体;">等，这样就能达到和</span><span style="font-size: 16px;">BufferedOutputStream</span><span style="font-size: 16px; font-family: 宋体;">、</span><span style="font-size: 16px;">BufferedInputStream</span><span style="font-size: 16px; font-family: 宋体;">一样的效果。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">4</span><span style="font-size: 16px; font-family: 宋体;">、其他更高级的</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">流</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">其他高级的</span><span style="font-size: 16px;">IO</span><span style="font-size: 16px; font-family: 宋体;">流，使用得比较少，本文不做介绍。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">只提一点：关于</span><span style="font-size: 16px;">Java</span><span style="font-size: 16px; font-family: 宋体;">的</span><span style="font-size: 16px;">nio</span><span style="font-size: 16px; font-family: 宋体;">（</span><span style="font-size: 16px;">new io</span><span style="font-size: 16px; font-family: 宋体;">），经过笔者较深入地测试，对文件流的读写效果不是很明显，有兴趣的读者可以自己去研究。</span></p><p style="white-space: normal; text-indent: 28px; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">5</span><span style="font-size: 16px; font-family: 宋体;">、补充知识点：对文件进行打包和压缩</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">网上流传有两种方式：</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">1</span><span style="font-size: 16px; font-family: 宋体;">）第一种方式，采用</span><span style="font-size: 16px;">JDK API</span><span style="font-size: 16px; font-family: 宋体;">中自带的类：</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">import java.util.zip.ZipEntry;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">import java.util.zip.ZipOutputStream;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">缺点：不支持中文文件名。压缩过程中遇到中文文件名，则文件名会乱码，解压过程中遇到中文文件名，则会报错。</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">2</span><span style="font-size: 16px; font-family: 宋体;">）第二种方式，利用</span><span style="font-size: 16px;">Apache ANT</span><span style="font-size: 16px; font-family: 宋体;">中的工具类：</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">import org.apache.tools.zip.ZipEntry;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">import org.apache.tools.zip.ZipOutputStream;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">优点：支持自定义编码，可以解决压缩的文件名的中文乱码问题。</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">缺点：这个工具类在</span><span style="font-size: 16px;">ant.jar</span><span style="font-size: 16px; font-family: 宋体;">中，使用时需要额外引入这个</span><span style="font-size: 16px;">jar</span><span style="font-size: 16px; font-family: 宋体;">文件。</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px;">&nbsp;</span></p><p style="white-space: normal; line-height: 27px;"><span style="font-size: 16px; font-family: 宋体;">我根据</span><span style="font-size: 16px;">JDK API</span><span style="font-size: 16px; font-family: 宋体;">重写了</span><span style="font-size: 16px;">ZipOutputStream</span><span style="font-size: 16px; font-family: 宋体;">相关的类，解决了编码问题，使得能支持多种字符编码方式。具体例子见附件的</span><span style="font-size: 16px;">Demo</span><span style="font-size: 16px; font-family: 宋体;">。</span></p><p style="white-space: normal; line-height: 27px;"><br/></p><p></p>