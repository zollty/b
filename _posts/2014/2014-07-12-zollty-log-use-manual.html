---
layout: ue
title: Zollty-Log使用手册
category: 程序员风采_技术人生
tags: zollty-log
keywords: "zollty-log,日志库"
---

<div style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><h1 style="border-bottom-color: rgb(221, 221, 221); border-bottom-width: 1px; border-bottom-style: solid; position: relative; padding-bottom: 0px; margin-top: 0px; margin-bottom: 15px; padding-left: 0px; padding-right: 0px; font: normal normal bold 2.5em/1.7 Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); cursor: text; padding-top: 0px; ">zollty-log</h1><p style="margin-top: 15px; margin-bottom: 15px; font: normal normal normal 15px/25px Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); ">The ZolltyLog is a simple, generic and flexible logging library for Java, which can work with other logging frameworks, like log4j.</p></div><p><br/></p><div><strong><span style="font-size: 18px; ">一、简单用法示例</span></strong></div><div style="white-space: normal; "><div class="highlight highlight-java" style="font-family: verdana; font-size: 13px; line-height: normal; background-color: rgb(255, 255, 255); font: normal normal normal 15px/25px Helvetica, arial, freesans, clean, sans-serif; color: rgb(51, 51, 51); "><pre style="font-family: Consolas, &#39;Liberation Mono&#39;, Courier, monospace; color: rgb(0, 0, 0); background-color: rgb(248, 248, 248); border-bottom-color: rgb(221, 221, 221); border-left-color: rgb(221, 221, 221); padding-bottom: 6px; line-height: 19px; margin-top: 15px; margin-bottom: 15px; padding-left: 10px; padding-right: 10px; word-wrap: normal; border-top-color: rgb(221, 221, 221); border-right-color: rgb(221, 221, 221); padding-top: 6px; border-top-left-radius: 3px 3px; border-top-right-radius: 3px 3px; border-bottom-right-radius: 3px 3px; border-bottom-left-radius: 3px 3px; ">&nbsp;&nbsp;public&nbsp;static&nbsp;final&nbsp;Logger&nbsp;LOG&nbsp;=&nbsp;LogFactory.getLogger();&nbsp;//&nbsp;Concise
&nbsp;&nbsp;LOG.error(&quot;Hello&nbsp;{},&nbsp;welcome&nbsp;to&nbsp;{}&quot;,&nbsp;&quot;GUYS&quot;,&nbsp;&quot;ZolltyLog&nbsp;Demo&quot;);&nbsp;//&nbsp;use&nbsp;placeholder
&nbsp;&nbsp;
&nbsp;&nbsp;if(&nbsp;LOG.isDebugEnabled()&nbsp;)&nbsp;{&nbsp;//&nbsp;Local&nbsp;log&nbsp;level&nbsp;control
&nbsp;&nbsp;&nbsp;&nbsp;LOG.error(e,&nbsp;&quot;Some&nbsp;additional&nbsp;tips....&quot;);
&nbsp;&nbsp;}</pre></div></div><p>&nbsp;</p><div><strong>二、基本用法说明</strong></div><p>&nbsp;</p><p>1、基本使用</p><p>&nbsp; &nbsp; 直接引入zollty-log的jar包即可用。zollty-log的日志有Trace、Debug、Info、Warm、Error等级别。如果不配置，它默认使用TRACE级别，使用Java的System.out标准输出流，在控制台来输出日志。</p><p><br/></p><p>2、简单配置</p><p>&nbsp; &nbsp; 如果想自定义日志输出级别，或者日志输出的方式，可以在zollty-log.properties文件中配置。</p><p>&nbsp; &nbsp; 在classpath中新建一个名为zollty-log.properties的文件，例如maven项目在如下地址&nbsp;</p><p>src/main/resources/<span style="color:#a80300">zollty-log.properties</span></p><div>内容如下：</div><div><div><pre class="brush:plain;toolbar:false">rootLogger=TRACE,STDOUT
appender.STDOUT.layout.className=simple
logger.org.zollty.dbk=INFO</pre>第一行是主要配置，指出日志阀门的级别和日志的实现方式。</div><div style="white-space: normal; ">1）第一个参数，TRACE代表日志的阀门值为“TRACE级别”。低于TRACE级别的日志，将不会打印。这个是全局性的日志级别。</div><p>2）第二个参数，是日志的实现方式。可以指定用何种日志程序来输出日志。比如STDOUT，它是Zollty-Log日志库自带的STDOUT标准输出，换句话说，就是用Java的System.out来输出。还有LOG4J，表示使用Log4j来输出日志（需要引入Log4j的jar包）。除了zollty-log中自带的STDOUT和LOG4J外，还支持自定义的日志实现类，比如</p><p>com.zollty.report.log.TreLog4jLogger，任何继承于org.zollty.log.LoggerSupport的日志实现类都可以（在第三节“高级用法”中会详细说明）。</p><p><br/></p><p><br/></p><div>第二行是日志实现方式的具体配置。</div><div>1）当实现方式为STDOUT时，支持的配置如下</div><div>appender.STDOUT.layout.className=simple</div><p>表示输出日志时，前缀的类名称的形式，1）类的全名（比如org.zollty.log.ConsoleAppender），2）短名称(比如ConsoleAppender)。当配置为simple时，日志输出时用类的短名称，如果不配置或者配置其他值，则用类全名。</p>&nbsp;<br/></div><div>第三行是设置特定包的日志级别。</div><div>1）格式为logger.包路径。例如，上面设置的是<strong>logger.org.zollty.dbk</strong>=<strong><span style="color: rgb(192, 0, 0); ">INFO</span></strong>，则表示对于<strong>org.zollty.dbk包，设置的日志级别为INFO级别</strong>。</div><div>这个级别比全局级别高时，才会其作用，比如说全局级别为ERROR，这个地方你设置成INFO就没任何作用，道理很简单，全局级别的优先级更高。</div><div>2）可以设置多个特定的包日志级别。</div><p>&nbsp;</p><p><strong>三、高级用法</strong></p><p><strong><span style="font-size:18px"><br/></span></strong></p><p>1、自定义Logger实现类</p><p>&nbsp;</p><p>一个简单的例子如下：</p><p><span style="font-size: 16px; "><span class="Apple-style-span" style="font-family: verdana; line-height: normal; ">public&nbsp;class&nbsp;TreLog4jLogger&nbsp;</span><span style="font-family: verdana; line-height: normal; color: rgb(168, 3, 0); ">implements</span><span class="Apple-style-span" style="font-family: verdana; line-height: normal; ">&nbsp;</span><span style="font-family: verdana; line-height: normal; color: rgb(0, 0, 255); ">org.zollty.log.Logger,&nbsp;LoggerSupport</span><span class="Apple-style-span" style="font-family: verdana; line-height: normal; ">&nbsp;{</span><br/></span></p><blockquote dir="ltr" style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><div><span style="font-size: 16px; ">private&nbsp;static&nbsp;final&nbsp;String&nbsp;FQCN&nbsp;=&nbsp;LoggerWrapper.class.getName();</span></div><div><span style="font-size: 16px; ">private&nbsp;transient&nbsp;org.apache.log4j.Logger&nbsp;logger;</span></div></blockquote><blockquote dir="ltr" style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><div><span style="font-size: 16px; ">public&nbsp;TreLog4jLogger(){</span></div><br/><div><span style="font-size: 16px; ">}</span></div></blockquote><blockquote dir="ltr" style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><div><span style="font-size: 16px; ">public&nbsp;TreLog4jLogger(String&nbsp;name)&nbsp;{</span></div><div><span style="font-size: 16px; ">&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-size: 16px; color: rgb(0, 0, 255); ">&nbsp;this.logger&nbsp;=&nbsp;org.apache.log4j.Logger.getLogger(name);</span></span></div><div><span style="font-size: 16px; ">}</span></div><div><span style="font-size: 16px; ">@Override</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">public&nbsp;org.zollty.log.Logger newInstance(String&nbsp;name)&nbsp;{</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return&nbsp;new&nbsp;TreLog4jLogger(name);</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">}</span></div></blockquote><blockquote dir="ltr" style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">@Override</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">public&nbsp;void&nbsp;info(Object&nbsp;message)&nbsp;{</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">&nbsp;&nbsp;&nbsp;&nbsp; logger.log(FQCN,&nbsp;Level.INFO,&nbsp;message,&nbsp;null);</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">}</span></div><span style="color: rgb(0, 0, 255); font-size: 16px; "><br/></span><span style="color: rgb(0, 0, 255); font-size: 16px; "></span><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">@Override</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">public&nbsp;void&nbsp;info(Throwable&nbsp;e)&nbsp;{</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">&nbsp;&nbsp;&nbsp; logger.log(FQCN,&nbsp;Level.INFO,&nbsp;Utils.ExceptionUtil.getStackTraceStr(e),&nbsp;null);</span></div><div><span style="color: rgb(0, 0, 255); font-size: 16px; ">}</span></div><br/><div><span style="font-size: 16px; ">...省略其他debug、warn方法，它们都和info方法类似。</span></div></blockquote><div style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><span style="font-size: 16px; ">}</span></div><p>&nbsp;</p><div>2、动态刷新日志工厂的阀门级别。</div><div>示例如下：动态刷新日志开关</div><div style="font-family: verdana; font-size: 13px; line-height: normal; white-space: normal; "><pre style="font-family: verdana; background-color: rgb(255, 255, 255); " class="brush:java;toolbar:false;">public&nbsp;void&nbsp;refreshMlf4jConfig(String&nbsp;configStr)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;InputStream&nbsp;in&nbsp;=&nbsp;MvcUtils.IOUtil.getInputStreamFromString(configStr,&nbsp;&quot;UTF-8&quot;);
&nbsp;&nbsp;&nbsp;&nbsp;Properties&nbsp;props&nbsp;=&nbsp;new&nbsp;Properties();
&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;props.load(in);
&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(IOException&nbsp;e)&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;NestedRuntimeException(e);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;Map&lt;String,&nbsp;String&gt;&nbsp;pmap&nbsp;=&nbsp;LogUtils.covertProperties2Map(props);
&nbsp;&nbsp;&nbsp;&nbsp;LogManager.refreshZolltyLogConfig(pmap);
}</pre></div><p>&nbsp;可以引入<a href="http://www.zollty.com/log-monitor/" target="_blank">Log-monitor</a>插件，在线查看和配置日志。</p><p><br/></p>